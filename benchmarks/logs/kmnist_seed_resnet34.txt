Using: [CudaDevice(id=0)]
################### TRAINING WITH velo ###################
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/Adam.learning_rate = 0.0003
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/FullES.recompute_samples = 100
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/GradientAccumulator.num_average = 20
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/HyperV2.param_inits = 256
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.lopt = @HyperV2()
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.num_estimators = 8
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.num_steps = 100000
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.staleness = 500
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.summary_every_n = 25
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/run_train.trainer_batch_size = 512
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__ecb1f3bb_3801_4115_9158_0ca9485eb17d/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.978, loss: 0.069 | Test acc: 0.964, loss: 0.105 | Time: 340.52s
[Epoch 2] Train acc: 0.981, loss: 0.056 | Test acc: 0.970, loss: 0.098 | Time: 82.98s
[Epoch 3] Train acc: 0.988, loss: 0.036 | Test acc: 0.978, loss: 0.076 | Time: 83.68s
[Epoch 4] Train acc: 0.988, loss: 0.038 | Test acc: 0.978, loss: 0.090 | Time: 83.95s
[Epoch 5] Train acc: 0.993, loss: 0.021 | Test acc: 0.983, loss: 0.065 | Time: 82.85s
[Epoch 6] Train acc: 0.997, loss: 0.011 | Test acc: 0.987, loss: 0.061 | Time: 71.70s
[Epoch 7] Train acc: 0.996, loss: 0.014 | Test acc: 0.986, loss: 0.066 | Time: 73.36s
[Epoch 8] Train acc: 0.996, loss: 0.013 | Test acc: 0.986, loss: 0.065 | Time: 82.69s
[Epoch 9] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.066 | Time: 83.44s
[Epoch 10] Train acc: 0.997, loss: 0.008 | Test acc: 0.986, loss: 0.064 | Time: 82.65s
[Epoch 11] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.071 | Time: 81.17s
[Epoch 12] Train acc: 0.998, loss: 0.004 | Test acc: 0.989, loss: 0.053 | Time: 67.26s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.066 | Time: 72.24s
[Epoch 14] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.057 | Time: 82.79s
[Epoch 15] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.071 | Time: 83.68s
[Epoch 16] Train acc: 0.997, loss: 0.011 | Test acc: 0.985, loss: 0.070 | Time: 83.82s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.069 | Time: 83.00s
[Epoch 18] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.063 | Time: 81.88s
[Epoch 19] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.059 | Time: 68.40s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.071 | Time: 67.75s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.069 | Time: 81.58s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.059 | Time: 83.61s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.059 | Time: 83.39s
[Epoch 24] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.057 | Time: 83.71s
[Epoch 25] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.061 | Time: 82.20s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.058 | Time: 82.26s
[Epoch 27] Train acc: 0.998, loss: 0.004 | Test acc: 0.988, loss: 0.066 | Time: 68.79s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.065 | Time: 67.31s
[Epoch 29] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.064 | Time: 77.84s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.065 | Time: 82.97s
[Epoch 31] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.074 | Time: 76.47s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.070 | Time: 81.93s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.068 | Time: 79.03s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.062 | Time: 76.90s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.056 | Time: 83.74s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.056 | Time: 74.73s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.061 | Time: 78.35s
[Epoch 38] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.066 | Time: 83.20s
[Epoch 39] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.055 | Time: 82.50s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.065 | Time: 67.81s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.064 | Time: 81.32s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.062 | Time: 83.02s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.067 | Time: 83.82s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.068 | Time: 70.51s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.989, loss: 0.064 | Time: 75.49s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.062 | Time: 82.45s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.070 | Time: 83.13s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.066 | Time: 82.92s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.068 | Time: 71.20s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.070 | Time: 72.84s
Total training time: 4276.31s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed0_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.889, loss: 0.371 | Test acc: 0.873, loss: 0.407 | Time: 14.49s
[Epoch 2] Train acc: 0.953, loss: 0.165 | Test acc: 0.933, loss: 0.212 | Time: 5.42s
[Epoch 3] Train acc: 0.975, loss: 0.096 | Test acc: 0.955, loss: 0.151 | Time: 5.68s
[Epoch 4] Train acc: 0.984, loss: 0.063 | Test acc: 0.960, loss: 0.128 | Time: 5.57s
[Epoch 5] Train acc: 0.990, loss: 0.041 | Test acc: 0.964, loss: 0.117 | Time: 5.69s
[Epoch 6] Train acc: 0.994, loss: 0.028 | Test acc: 0.965, loss: 0.115 | Time: 5.63s
[Epoch 7] Train acc: 0.997, loss: 0.019 | Test acc: 0.969, loss: 0.110 | Time: 5.72s
[Epoch 8] Train acc: 0.998, loss: 0.013 | Test acc: 0.968, loss: 0.109 | Time: 5.67s
[Epoch 9] Train acc: 0.999, loss: 0.009 | Test acc: 0.969, loss: 0.107 | Time: 5.75s
[Epoch 10] Train acc: 0.999, loss: 0.007 | Test acc: 0.971, loss: 0.105 | Time: 5.68s
[Epoch 11] Train acc: 1.000, loss: 0.005 | Test acc: 0.970, loss: 0.107 | Time: 5.76s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.970, loss: 0.108 | Time: 5.68s
[Epoch 13] Train acc: 1.000, loss: 0.004 | Test acc: 0.969, loss: 0.109 | Time: 5.73s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.970, loss: 0.109 | Time: 5.74s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.971, loss: 0.109 | Time: 5.70s
[Epoch 16] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.108 | Time: 5.72s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.971, loss: 0.108 | Time: 5.68s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.972, loss: 0.108 | Time: 5.71s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.972, loss: 0.107 | Time: 5.75s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.972, loss: 0.109 | Time: 5.72s
[Epoch 21] Train acc: 1.000, loss: 0.002 | Test acc: 0.971, loss: 0.108 | Time: 5.74s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.108 | Time: 5.68s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.108 | Time: 5.71s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.108 | Time: 5.71s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.108 | Time: 5.73s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.109 | Time: 5.69s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.108 | Time: 5.75s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.110 | Time: 5.69s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.109 | Time: 5.71s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.109 | Time: 5.71s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.109 | Time: 5.70s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.110 | Time: 5.72s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.110 | Time: 5.70s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.111 | Time: 5.74s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.110 | Time: 5.72s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.111 | Time: 5.72s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.110 | Time: 5.76s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.111 | Time: 5.72s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.111 | Time: 5.74s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.112 | Time: 5.79s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.110 | Time: 5.74s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.110 | Time: 5.74s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.110 | Time: 5.87s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.110 | Time: 5.98s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.111 | Time: 5.89s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.112 | Time: 5.93s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.111 | Time: 5.97s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.111 | Time: 5.94s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.111 | Time: 5.93s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.111 | Time: 5.92s
Total training time: 364.75s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed0_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.977, loss: 0.074 | Test acc: 0.964, loss: 0.117 | Time: 16.45s
[Epoch 2] Train acc: 0.991, loss: 0.031 | Test acc: 0.974, loss: 0.087 | Time: 6.28s
[Epoch 3] Train acc: 0.995, loss: 0.016 | Test acc: 0.976, loss: 0.084 | Time: 6.67s
[Epoch 4] Train acc: 0.999, loss: 0.005 | Test acc: 0.980, loss: 0.074 | Time: 6.60s
[Epoch 5] Train acc: 0.999, loss: 0.002 | Test acc: 0.980, loss: 0.072 | Time: 6.74s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.982, loss: 0.074 | Time: 6.80s
[Epoch 7] Train acc: 1.000, loss: 0.001 | Test acc: 0.983, loss: 0.068 | Time: 6.75s
[Epoch 8] Train acc: 1.000, loss: 0.001 | Test acc: 0.984, loss: 0.068 | Time: 6.80s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 6.76s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.067 | Time: 6.72s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.86s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.74s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.85s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.69s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.78s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.66s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.69s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.70s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.72s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.73s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.84s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.73s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.84s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.76s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.76s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.73s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.76s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 6.69s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.73s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.78s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.83s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.75s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 6.79s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 6.77s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 6.76s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 6.70s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 6.74s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.73s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 6.75s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.071 | Time: 6.75s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 6.79s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.75s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.069 | Time: 6.75s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.069 | Time: 6.77s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 6.81s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 6.73s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 6.75s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 6.86s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.071 | Time: 6.73s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 6.79s
Total training time: 415.46s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed0_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.962, loss: 0.125 | Test acc: 0.955, loss: 0.150 | Time: 20.14s
[Epoch 2] Train acc: 0.985, loss: 0.049 | Test acc: 0.976, loss: 0.070 | Time: 7.45s
[Epoch 3] Train acc: 0.981, loss: 0.069 | Test acc: 0.973, loss: 0.099 | Time: 7.94s
[Epoch 4] Train acc: 0.984, loss: 0.054 | Test acc: 0.974, loss: 0.087 | Time: 7.91s
[Epoch 5] Train acc: 0.982, loss: 0.061 | Test acc: 0.971, loss: 0.109 | Time: 8.00s
[Epoch 6] Train acc: 0.988, loss: 0.037 | Test acc: 0.981, loss: 0.086 | Time: 7.86s
[Epoch 7] Train acc: 0.990, loss: 0.032 | Test acc: 0.981, loss: 0.080 | Time: 7.97s
[Epoch 8] Train acc: 0.971, loss: 0.152 | Test acc: 0.962, loss: 0.214 | Time: 7.98s
[Epoch 9] Train acc: 0.995, loss: 0.017 | Test acc: 0.986, loss: 0.059 | Time: 8.02s
[Epoch 10] Train acc: 0.991, loss: 0.028 | Test acc: 0.981, loss: 0.067 | Time: 8.00s
[Epoch 11] Train acc: 0.997, loss: 0.011 | Test acc: 0.986, loss: 0.060 | Time: 8.00s
[Epoch 12] Train acc: 0.996, loss: 0.013 | Test acc: 0.985, loss: 0.066 | Time: 7.90s
[Epoch 13] Train acc: 0.997, loss: 0.012 | Test acc: 0.988, loss: 0.058 | Time: 7.97s
[Epoch 14] Train acc: 0.997, loss: 0.012 | Test acc: 0.988, loss: 0.057 | Time: 7.90s
[Epoch 15] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.066 | Time: 8.02s
[Epoch 16] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.069 | Time: 8.01s
[Epoch 17] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.068 | Time: 7.93s
[Epoch 18] Train acc: 0.997, loss: 0.011 | Test acc: 0.987, loss: 0.066 | Time: 7.93s
[Epoch 19] Train acc: 0.996, loss: 0.014 | Test acc: 0.984, loss: 0.079 | Time: 8.00s
[Epoch 20] Train acc: 0.990, loss: 0.142 | Test acc: 0.981, loss: 0.212 | Time: 8.00s
[Epoch 21] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.049 | Time: 8.04s
[Epoch 22] Train acc: 0.997, loss: 0.007 | Test acc: 0.988, loss: 0.068 | Time: 8.07s
[Epoch 23] Train acc: 0.999, loss: 0.006 | Test acc: 0.988, loss: 0.060 | Time: 7.99s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.062 | Time: 8.06s
[Epoch 25] Train acc: 0.996, loss: 0.019 | Test acc: 0.985, loss: 0.082 | Time: 8.07s
[Epoch 26] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.065 | Time: 8.16s
[Epoch 27] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.061 | Time: 8.06s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.056 | Time: 8.02s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.057 | Time: 8.02s
[Epoch 30] Train acc: 0.997, loss: 0.015 | Test acc: 0.987, loss: 0.071 | Time: 8.17s
[Epoch 31] Train acc: 0.997, loss: 0.014 | Test acc: 0.986, loss: 0.092 | Time: 8.15s
[Epoch 32] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.063 | Time: 8.14s
[Epoch 33] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.068 | Time: 8.02s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.055 | Time: 8.04s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.070 | Time: 8.01s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.081 | Time: 8.19s
[Epoch 37] Train acc: 0.997, loss: 0.013 | Test acc: 0.987, loss: 0.078 | Time: 8.13s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.062 | Time: 8.01s
[Epoch 39] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.061 | Time: 8.07s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.056 | Time: 8.01s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.054 | Time: 7.97s
[Epoch 42] Train acc: 0.996, loss: 0.017 | Test acc: 0.982, loss: 0.094 | Time: 8.06s
[Epoch 43] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.079 | Time: 8.03s
[Epoch 44] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.059 | Time: 7.99s
[Epoch 45] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.067 | Time: 8.07s
[Epoch 46] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.070 | Time: 8.07s
[Epoch 47] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.060 | Time: 8.05s
[Epoch 48] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.077 | Time: 8.07s
[Epoch 49] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.075 | Time: 8.01s
[Epoch 50] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.064 | Time: 8.08s
Total training time: 482.44s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed0_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.962, loss: 0.128 | Test acc: 0.956, loss: 0.145 | Time: 20.74s
[Epoch 2] Train acc: 0.974, loss: 0.090 | Test acc: 0.963, loss: 0.128 | Time: 7.25s
[Epoch 3] Train acc: 0.984, loss: 0.054 | Test acc: 0.974, loss: 0.095 | Time: 7.93s
[Epoch 4] Train acc: 0.986, loss: 0.049 | Test acc: 0.979, loss: 0.079 | Time: 7.75s
[Epoch 5] Train acc: 0.993, loss: 0.026 | Test acc: 0.985, loss: 0.059 | Time: 7.88s
[Epoch 6] Train acc: 0.989, loss: 0.041 | Test acc: 0.981, loss: 0.086 | Time: 7.72s
[Epoch 7] Train acc: 0.993, loss: 0.022 | Test acc: 0.983, loss: 0.075 | Time: 7.93s
[Epoch 8] Train acc: 0.993, loss: 0.023 | Test acc: 0.982, loss: 0.081 | Time: 7.81s
[Epoch 9] Train acc: 0.992, loss: 0.026 | Test acc: 0.982, loss: 0.069 | Time: 7.84s
[Epoch 10] Train acc: 0.996, loss: 0.015 | Test acc: 0.984, loss: 0.073 | Time: 7.78s
[Epoch 11] Train acc: 0.996, loss: 0.014 | Test acc: 0.984, loss: 0.074 | Time: 7.87s
[Epoch 12] Train acc: 0.991, loss: 0.039 | Test acc: 0.981, loss: 0.091 | Time: 7.87s
[Epoch 13] Train acc: 0.994, loss: 0.022 | Test acc: 0.983, loss: 0.070 | Time: 7.93s
[Epoch 14] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.065 | Time: 7.91s
[Epoch 15] Train acc: 0.995, loss: 0.022 | Test acc: 0.983, loss: 0.088 | Time: 7.99s
[Epoch 16] Train acc: 0.997, loss: 0.011 | Test acc: 0.985, loss: 0.070 | Time: 7.83s
[Epoch 17] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.069 | Time: 8.01s
[Epoch 18] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.063 | Time: 7.96s
[Epoch 19] Train acc: 0.992, loss: 0.042 | Test acc: 0.981, loss: 0.103 | Time: 7.98s
[Epoch 20] Train acc: 0.998, loss: 0.016 | Test acc: 0.984, loss: 0.083 | Time: 7.89s
[Epoch 21] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.066 | Time: 7.95s
[Epoch 22] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.065 | Time: 8.00s
[Epoch 23] Train acc: 0.995, loss: 0.020 | Test acc: 0.985, loss: 0.088 | Time: 8.01s
[Epoch 24] Train acc: 0.993, loss: 0.040 | Test acc: 0.983, loss: 0.091 | Time: 8.03s
[Epoch 25] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.063 | Time: 8.00s
[Epoch 26] Train acc: 0.997, loss: 0.012 | Test acc: 0.986, loss: 0.069 | Time: 8.03s
[Epoch 27] Train acc: 0.980, loss: 0.080 | Test acc: 0.969, loss: 0.137 | Time: 7.99s
[Epoch 28] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.070 | Time: 7.96s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.059 | Time: 7.95s
[Epoch 30] Train acc: 0.998, loss: 0.010 | Test acc: 0.986, loss: 0.099 | Time: 8.00s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.085 | Time: 7.95s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.066 | Time: 7.93s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.064 | Time: 7.95s
[Epoch 34] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.059 | Time: 7.99s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.066 | Time: 7.95s
[Epoch 36] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.075 | Time: 7.99s
[Epoch 37] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.092 | Time: 8.04s
[Epoch 38] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.073 | Time: 7.99s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.064 | Time: 7.96s
[Epoch 40] Train acc: 0.996, loss: 0.015 | Test acc: 0.987, loss: 0.090 | Time: 8.01s
[Epoch 41] Train acc: 0.987, loss: 0.065 | Test acc: 0.973, loss: 0.150 | Time: 8.00s
[Epoch 42] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.068 | Time: 8.00s
[Epoch 43] Train acc: 1.000, loss: 0.002 | Test acc: 0.988, loss: 0.072 | Time: 8.50s
[Epoch 44] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.092 | Time: 8.34s
[Epoch 45] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.094 | Time: 8.63s
[Epoch 46] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.074 | Time: 8.47s
[Epoch 47] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.077 | Time: 8.48s
[Epoch 48] Train acc: 0.994, loss: 0.039 | Test acc: 0.982, loss: 0.121 | Time: 8.44s
[Epoch 49] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.071 | Time: 8.64s
[Epoch 50] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.094 | Time: 8.65s
Total training time: 482.94s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed0_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/Adam.learning_rate = 0.0003
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/FullES.recompute_samples = 100
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/GradientAccumulator.num_average = 20
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/HyperV2.param_inits = 256
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.lopt = @HyperV2()
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.num_estimators = 8
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.num_steps = 100000
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.staleness = 500
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.summary_every_n = 25
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/run_train.trainer_batch_size = 512
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__30922b83_0197_412c_9ac8_eb855958ea8b/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.980, loss: 0.066 | Test acc: 0.968, loss: 0.097 | Time: 329.25s
[Epoch 2] Train acc: 0.985, loss: 0.049 | Test acc: 0.973, loss: 0.085 | Time: 68.71s
[Epoch 3] Train acc: 0.989, loss: 0.035 | Test acc: 0.980, loss: 0.081 | Time: 83.03s
[Epoch 4] Train acc: 0.993, loss: 0.021 | Test acc: 0.982, loss: 0.065 | Time: 83.85s
[Epoch 5] Train acc: 0.996, loss: 0.014 | Test acc: 0.984, loss: 0.066 | Time: 83.83s
[Epoch 6] Train acc: 0.993, loss: 0.024 | Test acc: 0.978, loss: 0.094 | Time: 77.39s
[Epoch 7] Train acc: 0.992, loss: 0.025 | Test acc: 0.981, loss: 0.089 | Time: 81.76s
[Epoch 8] Train acc: 0.996, loss: 0.011 | Test acc: 0.987, loss: 0.063 | Time: 79.44s
[Epoch 9] Train acc: 0.997, loss: 0.009 | Test acc: 0.985, loss: 0.064 | Time: 76.44s
[Epoch 10] Train acc: 0.996, loss: 0.014 | Test acc: 0.983, loss: 0.082 | Time: 83.10s
[Epoch 11] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.064 | Time: 75.86s
[Epoch 12] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.058 | Time: 81.71s
[Epoch 13] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.058 | Time: 82.34s
[Epoch 14] Train acc: 0.997, loss: 0.011 | Test acc: 0.986, loss: 0.064 | Time: 74.72s
[Epoch 15] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.067 | Time: 83.68s
[Epoch 16] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.064 | Time: 76.38s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.984, loss: 0.073 | Time: 76.33s
[Epoch 18] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.065 | Time: 84.50s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.062 | Time: 77.70s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.069 | Time: 75.23s
[Epoch 21] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.064 | Time: 83.90s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.065 | Time: 83.36s
[Epoch 23] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.063 | Time: 68.87s
[Epoch 24] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.058 | Time: 81.91s
[Epoch 25] Train acc: 0.999, loss: 0.004 | Test acc: 0.986, loss: 0.070 | Time: 84.07s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.051 | Time: 78.14s
[Epoch 27] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.056 | Time: 72.22s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.069 | Time: 84.29s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.067 | Time: 83.66s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.065 | Time: 75.55s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.058 | Time: 72.28s
[Epoch 32] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.078 | Time: 71.02s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.073 | Time: 68.18s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.986, loss: 0.079 | Time: 67.24s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.073 | Time: 70.08s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.072 | Time: 74.91s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.988, loss: 0.067 | Time: 82.16s
[Epoch 38] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.067 | Time: 84.13s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.988, loss: 0.068 | Time: 83.77s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.064 | Time: 84.22s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.062 | Time: 83.69s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.067 | Time: 82.63s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.068 | Time: 69.59s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.064 | Time: 70.80s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.989, loss: 0.074 | Time: 83.52s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.075 | Time: 83.87s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.072 | Time: 83.80s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.077 | Time: 84.22s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.076 | Time: 68.93s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.076 | Time: 73.27s
Total training time: 4243.08s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed1_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.893, loss: 0.364 | Test acc: 0.884, loss: 0.389 | Time: 14.81s
[Epoch 2] Train acc: 0.955, loss: 0.160 | Test acc: 0.940, loss: 0.203 | Time: 5.40s
[Epoch 3] Train acc: 0.975, loss: 0.094 | Test acc: 0.956, loss: 0.150 | Time: 5.82s
[Epoch 4] Train acc: 0.986, loss: 0.059 | Test acc: 0.962, loss: 0.128 | Time: 5.47s
[Epoch 5] Train acc: 0.991, loss: 0.040 | Test acc: 0.964, loss: 0.118 | Time: 5.78s
[Epoch 6] Train acc: 0.995, loss: 0.026 | Test acc: 0.968, loss: 0.111 | Time: 5.68s
[Epoch 7] Train acc: 0.998, loss: 0.017 | Test acc: 0.969, loss: 0.105 | Time: 5.74s
[Epoch 8] Train acc: 0.999, loss: 0.011 | Test acc: 0.969, loss: 0.104 | Time: 5.66s
[Epoch 9] Train acc: 1.000, loss: 0.008 | Test acc: 0.970, loss: 0.102 | Time: 5.72s
[Epoch 10] Train acc: 1.000, loss: 0.006 | Test acc: 0.971, loss: 0.102 | Time: 5.69s
[Epoch 11] Train acc: 1.000, loss: 0.004 | Test acc: 0.972, loss: 0.102 | Time: 5.69s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.973, loss: 0.101 | Time: 5.69s
[Epoch 13] Train acc: 1.000, loss: 0.003 | Test acc: 0.972, loss: 0.101 | Time: 5.68s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.972, loss: 0.102 | Time: 5.72s
[Epoch 15] Train acc: 1.000, loss: 0.002 | Test acc: 0.973, loss: 0.102 | Time: 5.67s
[Epoch 16] Train acc: 1.000, loss: 0.002 | Test acc: 0.973, loss: 0.102 | Time: 5.62s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.972, loss: 0.102 | Time: 5.71s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.974, loss: 0.102 | Time: 5.70s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.973, loss: 0.102 | Time: 5.74s
[Epoch 20] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.102 | Time: 5.69s
[Epoch 21] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.102 | Time: 5.68s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.103 | Time: 5.65s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.103 | Time: 5.74s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.102 | Time: 5.72s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.103 | Time: 5.69s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.103 | Time: 5.66s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.103 | Time: 5.72s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.104 | Time: 5.65s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.104 | Time: 5.67s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.104 | Time: 5.71s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.105 | Time: 5.70s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.105 | Time: 5.73s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.105 | Time: 5.64s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.105 | Time: 5.67s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.105 | Time: 5.69s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.106 | Time: 5.69s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.106 | Time: 5.64s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.106 | Time: 5.68s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.107 | Time: 5.74s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.107 | Time: 5.76s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.106 | Time: 5.74s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.106 | Time: 5.77s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.106 | Time: 5.80s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.105 | Time: 5.82s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.106 | Time: 5.81s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.106 | Time: 5.73s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.105 | Time: 5.74s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.106 | Time: 5.76s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.106 | Time: 5.74s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.975, loss: 0.106 | Time: 5.80s
Total training time: 362.38s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed1_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.977, loss: 0.076 | Test acc: 0.966, loss: 0.114 | Time: 16.82s
[Epoch 2] Train acc: 0.991, loss: 0.030 | Test acc: 0.975, loss: 0.085 | Time: 6.49s
[Epoch 3] Train acc: 0.995, loss: 0.017 | Test acc: 0.977, loss: 0.085 | Time: 6.98s
[Epoch 4] Train acc: 0.997, loss: 0.009 | Test acc: 0.978, loss: 0.083 | Time: 6.63s
[Epoch 5] Train acc: 0.999, loss: 0.003 | Test acc: 0.982, loss: 0.074 | Time: 6.99s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.982, loss: 0.068 | Time: 6.76s
[Epoch 7] Train acc: 1.000, loss: 0.001 | Test acc: 0.984, loss: 0.070 | Time: 6.93s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.80s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 7.07s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.82s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.95s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.071 | Time: 7.28s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 7.30s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 7.17s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 7.27s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 7.24s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 7.27s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.30s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.23s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 7.31s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 7.26s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.87s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.91s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.85s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.83s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.87s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.94s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.01s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.96s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.073 | Time: 6.86s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.073 | Time: 6.88s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.074 | Time: 6.90s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 6.93s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 6.89s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.90s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.075 | Time: 6.90s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 7.07s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.075 | Time: 7.04s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.076 | Time: 7.12s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.076 | Time: 7.02s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.076 | Time: 7.04s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 7.06s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 7.16s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 7.20s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.077 | Time: 7.06s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.077 | Time: 7.02s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.076 | Time: 7.04s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.077 | Time: 7.09s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 7.08s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 7.11s
Total training time: 430.07s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed1_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.960, loss: 0.128 | Test acc: 0.954, loss: 0.153 | Time: 20.33s
[Epoch 2] Train acc: 0.973, loss: 0.086 | Test acc: 0.964, loss: 0.125 | Time: 8.12s
[Epoch 3] Train acc: 0.979, loss: 0.065 | Test acc: 0.967, loss: 0.111 | Time: 8.18s
[Epoch 4] Train acc: 0.983, loss: 0.052 | Test acc: 0.974, loss: 0.099 | Time: 8.16s
[Epoch 5] Train acc: 0.989, loss: 0.035 | Test acc: 0.979, loss: 0.091 | Time: 8.34s
[Epoch 6] Train acc: 0.993, loss: 0.025 | Test acc: 0.985, loss: 0.076 | Time: 8.24s
[Epoch 7] Train acc: 0.994, loss: 0.020 | Test acc: 0.985, loss: 0.066 | Time: 8.45s
[Epoch 8] Train acc: 0.994, loss: 0.020 | Test acc: 0.984, loss: 0.067 | Time: 8.29s
[Epoch 9] Train acc: 0.977, loss: 0.132 | Test acc: 0.965, loss: 0.204 | Time: 8.22s
[Epoch 10] Train acc: 0.994, loss: 0.022 | Test acc: 0.983, loss: 0.082 | Time: 8.28s
[Epoch 11] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.059 | Time: 8.27s
[Epoch 12] Train acc: 0.993, loss: 0.027 | Test acc: 0.985, loss: 0.076 | Time: 8.36s
[Epoch 13] Train acc: 0.995, loss: 0.016 | Test acc: 0.985, loss: 0.063 | Time: 8.21s
[Epoch 14] Train acc: 0.996, loss: 0.016 | Test acc: 0.984, loss: 0.074 | Time: 8.16s
[Epoch 15] Train acc: 0.994, loss: 0.021 | Test acc: 0.985, loss: 0.078 | Time: 8.22s
[Epoch 16] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.065 | Time: 8.18s
[Epoch 17] Train acc: 0.997, loss: 0.011 | Test acc: 0.986, loss: 0.075 | Time: 8.21s
[Epoch 18] Train acc: 0.996, loss: 0.018 | Test acc: 0.985, loss: 0.073 | Time: 8.27s
[Epoch 19] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.075 | Time: 8.25s
[Epoch 20] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.060 | Time: 8.19s
[Epoch 21] Train acc: 0.998, loss: 0.009 | Test acc: 0.986, loss: 0.066 | Time: 8.24s
[Epoch 22] Train acc: 0.996, loss: 0.014 | Test acc: 0.985, loss: 0.088 | Time: 8.22s
[Epoch 23] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.070 | Time: 8.22s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.063 | Time: 8.26s
[Epoch 25] Train acc: 0.992, loss: 0.055 | Test acc: 0.980, loss: 0.131 | Time: 8.23s
[Epoch 26] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.077 | Time: 8.26s
[Epoch 27] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.068 | Time: 8.21s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.070 | Time: 8.29s
[Epoch 29] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.079 | Time: 8.47s
[Epoch 30] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.067 | Time: 8.48s
[Epoch 31] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.065 | Time: 8.47s
[Epoch 32] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.063 | Time: 8.52s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.066 | Time: 8.49s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.986, loss: 0.073 | Time: 8.42s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.080 | Time: 8.59s
[Epoch 36] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.085 | Time: 8.52s
[Epoch 37] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.082 | Time: 8.46s
[Epoch 38] Train acc: 0.995, loss: 0.032 | Test acc: 0.982, loss: 0.141 | Time: 8.50s
[Epoch 39] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.086 | Time: 8.54s
[Epoch 40] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.092 | Time: 8.51s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.074 | Time: 8.53s
[Epoch 42] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.086 | Time: 8.46s
[Epoch 43] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.078 | Time: 8.51s
[Epoch 44] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.068 | Time: 8.62s
[Epoch 45] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.080 | Time: 8.71s
[Epoch 46] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.078 | Time: 8.61s
[Epoch 47] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.062 | Time: 8.47s
[Epoch 48] Train acc: 0.997, loss: 0.014 | Test acc: 0.986, loss: 0.102 | Time: 8.66s
[Epoch 49] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.069 | Time: 8.70s
[Epoch 50] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.072 | Time: 8.65s
Total training time: 500.05s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed1_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.959, loss: 0.142 | Test acc: 0.956, loss: 0.164 | Time: 20.64s
[Epoch 2] Train acc: 0.964, loss: 0.117 | Test acc: 0.957, loss: 0.140 | Time: 7.49s
[Epoch 3] Train acc: 0.973, loss: 0.104 | Test acc: 0.965, loss: 0.133 | Time: 8.06s
[Epoch 4] Train acc: 0.988, loss: 0.037 | Test acc: 0.982, loss: 0.070 | Time: 7.77s
[Epoch 5] Train acc: 0.990, loss: 0.032 | Test acc: 0.981, loss: 0.080 | Time: 8.03s
[Epoch 6] Train acc: 0.992, loss: 0.028 | Test acc: 0.982, loss: 0.074 | Time: 7.89s
[Epoch 7] Train acc: 0.993, loss: 0.022 | Test acc: 0.983, loss: 0.068 | Time: 8.25s
[Epoch 8] Train acc: 0.995, loss: 0.018 | Test acc: 0.987, loss: 0.057 | Time: 7.85s
[Epoch 9] Train acc: 0.989, loss: 0.036 | Test acc: 0.980, loss: 0.081 | Time: 8.20s
[Epoch 10] Train acc: 0.995, loss: 0.018 | Test acc: 0.987, loss: 0.050 | Time: 7.82s
[Epoch 11] Train acc: 0.996, loss: 0.011 | Test acc: 0.987, loss: 0.051 | Time: 8.12s
[Epoch 12] Train acc: 0.997, loss: 0.011 | Test acc: 0.988, loss: 0.060 | Time: 7.96s
[Epoch 13] Train acc: 0.996, loss: 0.011 | Test acc: 0.987, loss: 0.062 | Time: 8.11s
[Epoch 14] Train acc: 0.994, loss: 0.020 | Test acc: 0.984, loss: 0.074 | Time: 7.99s
[Epoch 15] Train acc: 0.994, loss: 0.020 | Test acc: 0.986, loss: 0.075 | Time: 8.14s
[Epoch 16] Train acc: 0.988, loss: 0.046 | Test acc: 0.979, loss: 0.108 | Time: 8.05s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.062 | Time: 8.18s
[Epoch 18] Train acc: 0.998, loss: 0.009 | Test acc: 0.988, loss: 0.066 | Time: 8.05s
[Epoch 19] Train acc: 0.993, loss: 0.025 | Test acc: 0.980, loss: 0.102 | Time: 8.01s
[Epoch 20] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.057 | Time: 8.52s
[Epoch 21] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.056 | Time: 8.53s
[Epoch 22] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.062 | Time: 8.46s
[Epoch 23] Train acc: 0.990, loss: 0.049 | Test acc: 0.981, loss: 0.112 | Time: 8.62s
[Epoch 24] Train acc: 0.994, loss: 0.028 | Test acc: 0.984, loss: 0.093 | Time: 8.60s
[Epoch 25] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.056 | Time: 8.55s
[Epoch 26] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.069 | Time: 8.47s
[Epoch 27] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.063 | Time: 8.56s
[Epoch 28] Train acc: 0.994, loss: 0.031 | Test acc: 0.983, loss: 0.112 | Time: 8.49s
[Epoch 29] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.067 | Time: 8.54s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.064 | Time: 8.52s
[Epoch 31] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.064 | Time: 8.56s
[Epoch 32] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.073 | Time: 8.56s
[Epoch 33] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.071 | Time: 8.55s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.064 | Time: 8.53s
[Epoch 35] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.063 | Time: 8.58s
[Epoch 36] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.081 | Time: 8.51s
[Epoch 37] Train acc: 0.997, loss: 0.011 | Test acc: 0.985, loss: 0.098 | Time: 8.67s
[Epoch 38] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.064 | Time: 8.55s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.060 | Time: 8.59s
[Epoch 40] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.072 | Time: 8.60s
[Epoch 41] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.072 | Time: 8.57s
[Epoch 42] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.078 | Time: 8.57s
[Epoch 43] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.065 | Time: 8.55s
[Epoch 44] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.087 | Time: 8.69s
[Epoch 45] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.069 | Time: 8.57s
[Epoch 46] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.067 | Time: 8.73s
[Epoch 47] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.088 | Time: 8.52s
[Epoch 48] Train acc: 0.997, loss: 0.014 | Test acc: 0.984, loss: 0.100 | Time: 8.55s
[Epoch 49] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.073 | Time: 8.53s
[Epoch 50] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.083 | Time: 8.72s
Total training time: 499.41s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed1_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/Adam.learning_rate = 0.0003
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/FullES.recompute_samples = 100
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/GradientAccumulator.num_average = 20
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/HyperV2.param_inits = 256
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.lopt = @HyperV2()
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.num_estimators = 8
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.num_steps = 100000
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.staleness = 500
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.summary_every_n = 25
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/run_train.trainer_batch_size = 512
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__716fa461_50c3_48c4_9573_a73ef99f8b42/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.979, loss: 0.069 | Test acc: 0.967, loss: 0.101 | Time: 343.35s
[Epoch 2] Train acc: 0.987, loss: 0.043 | Test acc: 0.976, loss: 0.077 | Time: 83.67s
[Epoch 3] Train acc: 0.991, loss: 0.028 | Test acc: 0.981, loss: 0.068 | Time: 74.32s
[Epoch 4] Train acc: 0.994, loss: 0.017 | Test acc: 0.983, loss: 0.062 | Time: 83.60s
[Epoch 5] Train acc: 0.993, loss: 0.022 | Test acc: 0.984, loss: 0.066 | Time: 83.14s
[Epoch 6] Train acc: 0.997, loss: 0.011 | Test acc: 0.984, loss: 0.067 | Time: 82.20s
[Epoch 7] Train acc: 0.996, loss: 0.013 | Test acc: 0.984, loss: 0.076 | Time: 77.63s
[Epoch 8] Train acc: 0.998, loss: 0.006 | Test acc: 0.985, loss: 0.064 | Time: 78.55s
[Epoch 9] Train acc: 0.996, loss: 0.011 | Test acc: 0.985, loss: 0.068 | Time: 81.08s
[Epoch 10] Train acc: 0.996, loss: 0.013 | Test acc: 0.985, loss: 0.077 | Time: 76.28s
[Epoch 11] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.069 | Time: 83.59s
[Epoch 12] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.067 | Time: 73.78s
[Epoch 13] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.067 | Time: 76.56s
[Epoch 14] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.061 | Time: 83.16s
[Epoch 15] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.061 | Time: 72.34s
[Epoch 16] Train acc: 0.997, loss: 0.008 | Test acc: 0.988, loss: 0.068 | Time: 84.29s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.068 | Time: 79.95s
[Epoch 18] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.060 | Time: 75.29s
[Epoch 19] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.068 | Time: 60.54s
[Epoch 20] Train acc: 0.998, loss: 0.004 | Test acc: 0.988, loss: 0.067 | Time: 73.19s
[Epoch 21] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.073 | Time: 72.03s
[Epoch 22] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.075 | Time: 72.34s
[Epoch 23] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.070 | Time: 73.55s
[Epoch 24] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.070 | Time: 73.83s
[Epoch 25] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.068 | Time: 78.88s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.065 | Time: 71.00s
[Epoch 27] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.061 | Time: 61.15s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.066 | Time: 68.59s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.075 | Time: 74.94s
[Epoch 30] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.075 | Time: 83.36s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.986, loss: 0.076 | Time: 83.94s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.081 | Time: 73.97s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.069 | Time: 76.03s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.068 | Time: 76.85s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.056 | Time: 83.38s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.067 | Time: 82.66s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.068 | Time: 78.16s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.080 | Time: 69.10s
[Epoch 39] Train acc: 0.999, loss: 0.001 | Test acc: 0.988, loss: 0.075 | Time: 83.12s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.091 | Time: 84.28s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.084 | Time: 70.99s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.988, loss: 0.071 | Time: 68.94s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.069 | Time: 83.61s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.074 | Time: 83.50s
[Epoch 45] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.083 | Time: 74.59s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.989, loss: 0.075 | Time: 77.37s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.075 | Time: 83.54s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.989, loss: 0.074 | Time: 77.20s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.075 | Time: 73.06s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.075 | Time: 83.16s
Total training time: 4209.79s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed2_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.886, loss: 0.381 | Test acc: 0.875, loss: 0.409 | Time: 14.84s
[Epoch 2] Train acc: 0.951, loss: 0.170 | Test acc: 0.932, loss: 0.216 | Time: 5.45s
[Epoch 3] Train acc: 0.971, loss: 0.104 | Test acc: 0.951, loss: 0.162 | Time: 5.72s
[Epoch 4] Train acc: 0.982, loss: 0.068 | Test acc: 0.958, loss: 0.136 | Time: 5.51s
[Epoch 5] Train acc: 0.988, loss: 0.048 | Test acc: 0.961, loss: 0.127 | Time: 5.58s
[Epoch 6] Train acc: 0.993, loss: 0.032 | Test acc: 0.964, loss: 0.119 | Time: 5.63s
[Epoch 7] Train acc: 0.996, loss: 0.021 | Test acc: 0.965, loss: 0.114 | Time: 5.57s
[Epoch 8] Train acc: 0.998, loss: 0.015 | Test acc: 0.965, loss: 0.114 | Time: 5.71s
[Epoch 9] Train acc: 0.999, loss: 0.011 | Test acc: 0.969, loss: 0.112 | Time: 5.63s
[Epoch 10] Train acc: 0.999, loss: 0.007 | Test acc: 0.968, loss: 0.111 | Time: 5.64s
[Epoch 11] Train acc: 1.000, loss: 0.006 | Test acc: 0.968, loss: 0.111 | Time: 5.73s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.968, loss: 0.112 | Time: 5.71s
[Epoch 13] Train acc: 1.000, loss: 0.004 | Test acc: 0.967, loss: 0.111 | Time: 5.65s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.968, loss: 0.112 | Time: 5.62s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.968, loss: 0.111 | Time: 5.68s
[Epoch 16] Train acc: 1.000, loss: 0.003 | Test acc: 0.970, loss: 0.111 | Time: 5.68s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.111 | Time: 5.60s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.112 | Time: 5.57s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.111 | Time: 5.65s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.111 | Time: 5.56s
[Epoch 21] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.111 | Time: 5.57s
[Epoch 22] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.112 | Time: 5.58s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.112 | Time: 5.62s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.112 | Time: 5.53s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.112 | Time: 5.67s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.112 | Time: 5.62s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.112 | Time: 5.62s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.114 | Time: 5.61s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.113 | Time: 5.54s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.113 | Time: 5.62s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.114 | Time: 5.62s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.114 | Time: 5.62s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.114 | Time: 5.84s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.114 | Time: 5.78s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.114 | Time: 5.87s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.78s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.88s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.79s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.116 | Time: 5.91s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.82s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.97s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.114 | Time: 5.99s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.95s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.93s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.116 | Time: 6.02s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.116 | Time: 5.95s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.970, loss: 0.116 | Time: 5.96s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.971, loss: 0.116 | Time: 5.95s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.970, loss: 0.116 | Time: 5.91s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.971, loss: 0.116 | Time: 6.00s
Total training time: 364.05s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed2_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.980, loss: 0.068 | Test acc: 0.967, loss: 0.104 | Time: 16.42s
[Epoch 2] Train acc: 0.991, loss: 0.030 | Test acc: 0.974, loss: 0.086 | Time: 6.20s
[Epoch 3] Train acc: 0.994, loss: 0.020 | Test acc: 0.975, loss: 0.088 | Time: 6.66s
[Epoch 4] Train acc: 0.998, loss: 0.007 | Test acc: 0.979, loss: 0.078 | Time: 6.41s
[Epoch 5] Train acc: 0.998, loss: 0.007 | Test acc: 0.979, loss: 0.079 | Time: 6.76s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.983, loss: 0.068 | Time: 6.59s
[Epoch 7] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.067 | Time: 6.67s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.068 | Time: 6.66s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.79s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.66s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.71s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.070 | Time: 6.54s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.071 | Time: 6.74s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.071 | Time: 6.49s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.071 | Time: 6.59s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.071 | Time: 6.55s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.072 | Time: 6.64s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.68s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.63s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.75s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.72s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.71s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.65s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.073 | Time: 6.65s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.073 | Time: 6.65s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.073 | Time: 6.74s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.70s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 6.66s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.074 | Time: 6.65s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.074 | Time: 6.65s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.074 | Time: 6.71s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.074 | Time: 6.78s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.65s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.075 | Time: 6.69s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.72s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.69s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.70s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.81s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.76s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.69s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.75s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.66s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.76s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.075 | Time: 6.77s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 6.77s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 6.73s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 6.82s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 7.01s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 6.77s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.076 | Time: 6.93s
Total training time: 412.04s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed2_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.966, loss: 0.108 | Test acc: 0.961, loss: 0.123 | Time: 22.92s
[Epoch 2] Train acc: 0.985, loss: 0.047 | Test acc: 0.979, loss: 0.068 | Time: 7.68s
[Epoch 3] Train acc: 0.986, loss: 0.048 | Test acc: 0.981, loss: 0.076 | Time: 8.33s
[Epoch 4] Train acc: 0.985, loss: 0.048 | Test acc: 0.978, loss: 0.086 | Time: 7.96s
[Epoch 5] Train acc: 0.988, loss: 0.041 | Test acc: 0.976, loss: 0.088 | Time: 8.20s
[Epoch 6] Train acc: 0.993, loss: 0.024 | Test acc: 0.983, loss: 0.065 | Time: 8.03s
[Epoch 7] Train acc: 0.988, loss: 0.043 | Test acc: 0.979, loss: 0.097 | Time: 8.43s
[Epoch 8] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.054 | Time: 8.15s
[Epoch 9] Train acc: 0.995, loss: 0.017 | Test acc: 0.986, loss: 0.066 | Time: 8.48s
[Epoch 10] Train acc: 0.991, loss: 0.028 | Test acc: 0.984, loss: 0.060 | Time: 8.41s
[Epoch 11] Train acc: 0.985, loss: 0.051 | Test acc: 0.975, loss: 0.095 | Time: 8.56s
[Epoch 12] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.055 | Time: 8.49s
[Epoch 13] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.059 | Time: 8.60s
[Epoch 14] Train acc: 0.997, loss: 0.009 | Test acc: 0.988, loss: 0.069 | Time: 8.49s
[Epoch 15] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.063 | Time: 8.35s
[Epoch 16] Train acc: 0.997, loss: 0.010 | Test acc: 0.985, loss: 0.071 | Time: 8.28s
[Epoch 17] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.070 | Time: 8.34s
[Epoch 18] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.075 | Time: 8.36s
[Epoch 19] Train acc: 0.996, loss: 0.017 | Test acc: 0.986, loss: 0.084 | Time: 8.39s
[Epoch 20] Train acc: 0.993, loss: 0.025 | Test acc: 0.983, loss: 0.089 | Time: 8.30s
[Epoch 21] Train acc: 0.997, loss: 0.012 | Test acc: 0.988, loss: 0.069 | Time: 8.36s
[Epoch 22] Train acc: 0.997, loss: 0.012 | Test acc: 0.986, loss: 0.068 | Time: 8.46s
[Epoch 23] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.070 | Time: 8.53s
[Epoch 24] Train acc: 0.998, loss: 0.012 | Test acc: 0.987, loss: 0.076 | Time: 8.44s
[Epoch 25] Train acc: 0.999, loss: 0.014 | Test acc: 0.990, loss: 0.072 | Time: 8.35s
[Epoch 26] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.053 | Time: 8.57s
[Epoch 27] Train acc: 0.993, loss: 0.036 | Test acc: 0.977, loss: 0.159 | Time: 8.59s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.054 | Time: 8.55s
[Epoch 29] Train acc: 0.934, loss: 1.785 | Test acc: 0.919, loss: 2.026 | Time: 8.51s
[Epoch 30] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.054 | Time: 8.36s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.056 | Time: 8.40s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.054 | Time: 8.40s
[Epoch 33] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.072 | Time: 8.44s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.059 | Time: 8.37s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.072 | Time: 8.44s
[Epoch 36] Train acc: 0.997, loss: 0.012 | Test acc: 0.988, loss: 0.075 | Time: 8.34s
[Epoch 37] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.075 | Time: 8.43s
[Epoch 38] Train acc: 0.998, loss: 0.010 | Test acc: 0.988, loss: 0.079 | Time: 8.54s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.063 | Time: 8.48s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.065 | Time: 8.46s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.064 | Time: 8.51s
[Epoch 42] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.066 | Time: 8.46s
[Epoch 43] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.070 | Time: 8.47s
[Epoch 44] Train acc: 0.993, loss: 0.032 | Test acc: 0.981, loss: 0.130 | Time: 8.49s
[Epoch 45] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.063 | Time: 8.44s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.059 | Time: 8.50s
[Epoch 47] Train acc: 0.998, loss: 0.010 | Test acc: 0.988, loss: 0.089 | Time: 8.50s
[Epoch 48] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.064 | Time: 8.52s
[Epoch 49] Train acc: 0.998, loss: 0.009 | Test acc: 0.987, loss: 0.097 | Time: 8.45s
[Epoch 50] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.074 | Time: 8.51s
Total training time: 502.93s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed2_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.966, loss: 0.110 | Test acc: 0.957, loss: 0.138 | Time: 21.43s
[Epoch 2] Train acc: 0.975, loss: 0.079 | Test acc: 0.967, loss: 0.113 | Time: 7.73s
[Epoch 3] Train acc: 0.985, loss: 0.052 | Test acc: 0.976, loss: 0.082 | Time: 8.14s
[Epoch 4] Train acc: 0.984, loss: 0.051 | Test acc: 0.976, loss: 0.094 | Time: 7.90s
[Epoch 5] Train acc: 0.983, loss: 0.058 | Test acc: 0.974, loss: 0.101 | Time: 8.15s
[Epoch 6] Train acc: 0.991, loss: 0.032 | Test acc: 0.982, loss: 0.089 | Time: 7.89s
[Epoch 7] Train acc: 0.972, loss: 0.260 | Test acc: 0.964, loss: 0.344 | Time: 8.29s
[Epoch 8] Train acc: 0.995, loss: 0.020 | Test acc: 0.987, loss: 0.063 | Time: 8.07s
[Epoch 9] Train acc: 0.994, loss: 0.021 | Test acc: 0.985, loss: 0.071 | Time: 8.21s
[Epoch 10] Train acc: 0.996, loss: 0.015 | Test acc: 0.987, loss: 0.064 | Time: 8.14s
[Epoch 11] Train acc: 0.972, loss: 0.135 | Test acc: 0.961, loss: 0.222 | Time: 8.13s
[Epoch 12] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.056 | Time: 8.15s
[Epoch 13] Train acc: 0.996, loss: 0.016 | Test acc: 0.986, loss: 0.072 | Time: 8.34s
[Epoch 14] Train acc: 0.994, loss: 0.026 | Test acc: 0.984, loss: 0.095 | Time: 8.37s
[Epoch 15] Train acc: 0.997, loss: 0.011 | Test acc: 0.987, loss: 0.062 | Time: 8.14s
[Epoch 16] Train acc: 0.998, loss: 0.008 | Test acc: 0.989, loss: 0.056 | Time: 8.21s
[Epoch 17] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.072 | Time: 8.32s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.055 | Time: 8.35s
[Epoch 19] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.057 | Time: 8.37s
[Epoch 20] Train acc: 0.998, loss: 0.009 | Test acc: 0.988, loss: 0.062 | Time: 8.21s
[Epoch 21] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.081 | Time: 8.20s
[Epoch 22] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.052 | Time: 8.33s
[Epoch 23] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.082 | Time: 8.20s
[Epoch 24] Train acc: 0.996, loss: 0.017 | Test acc: 0.985, loss: 0.082 | Time: 8.21s
[Epoch 25] Train acc: 0.996, loss: 0.016 | Test acc: 0.988, loss: 0.070 | Time: 8.21s
[Epoch 26] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.070 | Time: 8.33s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.064 | Time: 8.31s
[Epoch 28] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.074 | Time: 8.19s
[Epoch 29] Train acc: 0.997, loss: 0.008 | Test acc: 0.987, loss: 0.075 | Time: 8.21s
[Epoch 30] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.068 | Time: 8.19s
[Epoch 31] Train acc: 0.999, loss: 0.006 | Test acc: 0.991, loss: 0.067 | Time: 8.21s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.058 | Time: 8.19s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.067 | Time: 8.23s
[Epoch 34] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.072 | Time: 8.26s
[Epoch 35] Train acc: 0.998, loss: 0.009 | Test acc: 0.988, loss: 0.066 | Time: 8.30s
[Epoch 36] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.064 | Time: 8.24s
[Epoch 37] Train acc: 0.999, loss: 0.006 | Test acc: 0.989, loss: 0.076 | Time: 8.30s
[Epoch 38] Train acc: 0.998, loss: 0.008 | Test acc: 0.990, loss: 0.059 | Time: 8.43s
[Epoch 39] Train acc: 0.997, loss: 0.028 | Test acc: 0.988, loss: 0.092 | Time: 8.29s
[Epoch 40] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.086 | Time: 8.28s
[Epoch 41] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.066 | Time: 8.42s
[Epoch 42] Train acc: 0.998, loss: 0.103 | Test acc: 0.990, loss: 0.224 | Time: 8.35s
[Epoch 43] Train acc: 0.999, loss: 0.043 | Test acc: 0.991, loss: 0.149 | Time: 8.36s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.055 | Time: 8.31s
[Epoch 45] Train acc: 1.000, loss: 0.002 | Test acc: 0.992, loss: 0.057 | Time: 8.37s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.069 | Time: 9.06s
[Epoch 47] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.068 | Time: 8.74s
[Epoch 48] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.056 | Time: 8.71s
[Epoch 49] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.064 | Time: 8.71s
[Epoch 50] Train acc: 0.998, loss: 0.011 | Test acc: 0.987, loss: 0.092 | Time: 8.49s
Total training time: 496.89s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed2_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/Adam.learning_rate = 0.0003
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/FullES.recompute_samples = 100
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/GradientAccumulator.num_average = 20
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/HyperV2.param_inits = 256
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.lopt = @HyperV2()
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.num_estimators = 8
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.num_steps = 100000
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.staleness = 500
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.summary_every_n = 25
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/run_train.trainer_batch_size = 512
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__76f5c15e_3ebb_4ca7_83fd_6366221c087f/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.980, loss: 0.065 | Test acc: 0.970, loss: 0.100 | Time: 343.32s
[Epoch 2] Train acc: 0.986, loss: 0.043 | Test acc: 0.973, loss: 0.083 | Time: 83.56s
[Epoch 3] Train acc: 0.993, loss: 0.023 | Test acc: 0.983, loss: 0.061 | Time: 79.62s
[Epoch 4] Train acc: 0.993, loss: 0.021 | Test acc: 0.982, loss: 0.072 | Time: 83.09s
[Epoch 5] Train acc: 0.996, loss: 0.013 | Test acc: 0.984, loss: 0.070 | Time: 83.61s
[Epoch 6] Train acc: 0.997, loss: 0.010 | Test acc: 0.985, loss: 0.066 | Time: 73.21s
[Epoch 7] Train acc: 0.997, loss: 0.011 | Test acc: 0.985, loss: 0.065 | Time: 82.80s
[Epoch 8] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.067 | Time: 83.26s
[Epoch 9] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.065 | Time: 71.48s
[Epoch 10] Train acc: 0.996, loss: 0.011 | Test acc: 0.984, loss: 0.061 | Time: 83.39s
[Epoch 11] Train acc: 0.997, loss: 0.008 | Test acc: 0.987, loss: 0.066 | Time: 83.45s
[Epoch 12] Train acc: 0.998, loss: 0.005 | Test acc: 0.985, loss: 0.067 | Time: 80.71s
[Epoch 13] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.065 | Time: 74.32s
[Epoch 14] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.060 | Time: 83.46s
[Epoch 15] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.066 | Time: 75.60s
[Epoch 16] Train acc: 0.998, loss: 0.009 | Test acc: 0.986, loss: 0.069 | Time: 77.39s
[Epoch 17] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.064 | Time: 84.56s
[Epoch 18] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.081 | Time: 77.41s
[Epoch 19] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.076 | Time: 83.25s
[Epoch 20] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.075 | Time: 84.68s
[Epoch 21] Train acc: 0.998, loss: 0.004 | Test acc: 0.987, loss: 0.069 | Time: 70.19s
[Epoch 22] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.068 | Time: 76.22s
[Epoch 23] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.063 | Time: 83.52s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.065 | Time: 81.19s
[Epoch 25] Train acc: 0.998, loss: 0.006 | Test acc: 0.985, loss: 0.077 | Time: 73.83s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.076 | Time: 83.72s
[Epoch 27] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.070 | Time: 82.91s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.985, loss: 0.086 | Time: 71.62s
[Epoch 29] Train acc: 0.998, loss: 0.005 | Test acc: 0.986, loss: 0.071 | Time: 83.31s
[Epoch 30] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.062 | Time: 84.02s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.067 | Time: 71.19s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.066 | Time: 82.74s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.066 | Time: 83.64s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.064 | Time: 83.50s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.073 | Time: 84.75s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.071 | Time: 83.71s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.066 | Time: 83.70s
[Epoch 38] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.073 | Time: 84.33s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.076 | Time: 83.63s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.084 | Time: 78.34s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.069 | Time: 67.63s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.065 | Time: 84.35s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.074 | Time: 83.02s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.079 | Time: 83.65s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.081 | Time: 84.22s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.073 | Time: 76.43s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.068 | Time: 71.02s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.072 | Time: 83.28s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.072 | Time: 76.32s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.072 | Time: 83.46s
Total training time: 4345.52s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed3_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.883, loss: 0.392 | Test acc: 0.873, loss: 0.420 | Time: 14.90s
[Epoch 2] Train acc: 0.950, loss: 0.172 | Test acc: 0.934, loss: 0.221 | Time: 5.45s
[Epoch 3] Train acc: 0.972, loss: 0.102 | Test acc: 0.952, loss: 0.162 | Time: 5.83s
[Epoch 4] Train acc: 0.983, loss: 0.067 | Test acc: 0.957, loss: 0.140 | Time: 5.59s
[Epoch 5] Train acc: 0.989, loss: 0.045 | Test acc: 0.962, loss: 0.128 | Time: 5.79s
[Epoch 6] Train acc: 0.994, loss: 0.028 | Test acc: 0.967, loss: 0.120 | Time: 5.64s
[Epoch 7] Train acc: 0.996, loss: 0.020 | Test acc: 0.967, loss: 0.117 | Time: 5.72s
[Epoch 8] Train acc: 0.998, loss: 0.013 | Test acc: 0.969, loss: 0.115 | Time: 5.63s
[Epoch 9] Train acc: 0.999, loss: 0.009 | Test acc: 0.969, loss: 0.114 | Time: 5.76s
[Epoch 10] Train acc: 0.999, loss: 0.007 | Test acc: 0.968, loss: 0.115 | Time: 5.65s
[Epoch 11] Train acc: 1.000, loss: 0.005 | Test acc: 0.969, loss: 0.115 | Time: 5.74s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.969, loss: 0.117 | Time: 5.70s
[Epoch 13] Train acc: 1.000, loss: 0.004 | Test acc: 0.968, loss: 0.118 | Time: 5.73s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.967, loss: 0.120 | Time: 5.93s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.968, loss: 0.121 | Time: 5.95s
[Epoch 16] Train acc: 1.000, loss: 0.003 | Test acc: 0.968, loss: 0.120 | Time: 5.90s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.968, loss: 0.122 | Time: 5.97s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.121 | Time: 5.59s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.121 | Time: 5.62s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.122 | Time: 5.71s
[Epoch 21] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.121 | Time: 5.69s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.122 | Time: 5.62s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.122 | Time: 5.67s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.121 | Time: 5.66s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.121 | Time: 5.66s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.121 | Time: 5.58s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.121 | Time: 5.65s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.122 | Time: 5.65s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.121 | Time: 5.61s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.122 | Time: 5.62s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.121 | Time: 5.67s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.122 | Time: 5.63s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.122 | Time: 5.70s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.123 | Time: 5.70s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.122 | Time: 5.67s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.123 | Time: 5.64s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.122 | Time: 5.64s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.122 | Time: 5.64s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.123 | Time: 5.67s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.122 | Time: 5.71s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.122 | Time: 5.63s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.122 | Time: 5.68s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.122 | Time: 5.66s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.122 | Time: 5.66s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.123 | Time: 5.70s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.123 | Time: 5.95s
[Epoch 47] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.123 | Time: 5.83s
[Epoch 48] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.124 | Time: 6.01s
[Epoch 49] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.123 | Time: 5.99s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.123 | Time: 5.99s
Total training time: 363.90s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed3_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.977, loss: 0.073 | Test acc: 0.962, loss: 0.113 | Time: 16.41s
[Epoch 2] Train acc: 0.989, loss: 0.037 | Test acc: 0.974, loss: 0.093 | Time: 6.21s
[Epoch 3] Train acc: 0.996, loss: 0.013 | Test acc: 0.979, loss: 0.079 | Time: 6.79s
[Epoch 4] Train acc: 0.999, loss: 0.006 | Test acc: 0.979, loss: 0.082 | Time: 6.39s
[Epoch 5] Train acc: 0.999, loss: 0.004 | Test acc: 0.980, loss: 0.076 | Time: 6.69s
[Epoch 6] Train acc: 0.999, loss: 0.002 | Test acc: 0.981, loss: 0.076 | Time: 6.49s
[Epoch 7] Train acc: 1.000, loss: 0.001 | Test acc: 0.983, loss: 0.068 | Time: 6.65s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.068 | Time: 6.53s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.66s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.069 | Time: 6.65s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.069 | Time: 6.54s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.070 | Time: 6.53s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.64s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.49s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.65s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.61s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.64s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.63s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.61s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.57s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.072 | Time: 6.63s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.59s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.60s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.60s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.74s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.64s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.60s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.63s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.67s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.63s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.66s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.62s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.71s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.68s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.71s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.72s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.66s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.65s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.67s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.69s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.66s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.79s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.75s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.87s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.78s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.99s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.83s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.92s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 6.82s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.89s
Total training time: 410.71s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed3_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.967, loss: 0.110 | Test acc: 0.958, loss: 0.147 | Time: 20.18s
[Epoch 2] Train acc: 0.978, loss: 0.075 | Test acc: 0.968, loss: 0.112 | Time: 7.16s
[Epoch 3] Train acc: 0.987, loss: 0.041 | Test acc: 0.978, loss: 0.076 | Time: 7.97s
[Epoch 4] Train acc: 0.988, loss: 0.038 | Test acc: 0.980, loss: 0.074 | Time: 7.58s
[Epoch 5] Train acc: 0.982, loss: 0.064 | Test acc: 0.975, loss: 0.114 | Time: 7.83s
[Epoch 6] Train acc: 0.986, loss: 0.054 | Test acc: 0.974, loss: 0.118 | Time: 7.62s
[Epoch 7] Train acc: 0.992, loss: 0.030 | Test acc: 0.982, loss: 0.079 | Time: 7.85s
[Epoch 8] Train acc: 0.996, loss: 0.017 | Test acc: 0.985, loss: 0.070 | Time: 7.72s
[Epoch 9] Train acc: 0.996, loss: 0.013 | Test acc: 0.986, loss: 0.055 | Time: 7.66s
[Epoch 10] Train acc: 0.981, loss: 0.301 | Test acc: 0.969, loss: 0.338 | Time: 7.72s
[Epoch 11] Train acc: 0.994, loss: 0.021 | Test acc: 0.981, loss: 0.088 | Time: 7.72s
[Epoch 12] Train acc: 0.991, loss: 0.038 | Test acc: 0.977, loss: 0.114 | Time: 7.69s
[Epoch 13] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.064 | Time: 7.71s
[Epoch 14] Train acc: 0.997, loss: 0.011 | Test acc: 0.987, loss: 0.074 | Time: 7.76s
[Epoch 15] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.068 | Time: 7.78s
[Epoch 16] Train acc: 0.985, loss: 0.075 | Test acc: 0.972, loss: 0.160 | Time: 7.71s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.066 | Time: 7.74s
[Epoch 18] Train acc: 0.998, loss: 0.009 | Test acc: 0.988, loss: 0.070 | Time: 7.80s
[Epoch 19] Train acc: 0.997, loss: 0.009 | Test acc: 0.985, loss: 0.069 | Time: 7.75s
[Epoch 20] Train acc: 0.995, loss: 0.023 | Test acc: 0.985, loss: 0.073 | Time: 7.89s
[Epoch 21] Train acc: 0.995, loss: 0.024 | Test acc: 0.984, loss: 0.089 | Time: 7.83s
[Epoch 22] Train acc: 0.995, loss: 0.017 | Test acc: 0.982, loss: 0.083 | Time: 7.79s
[Epoch 23] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.074 | Time: 7.67s
[Epoch 24] Train acc: 0.995, loss: 0.018 | Test acc: 0.984, loss: 0.089 | Time: 7.74s
[Epoch 25] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.064 | Time: 8.69s
[Epoch 26] Train acc: 0.998, loss: 0.010 | Test acc: 0.989, loss: 0.064 | Time: 8.67s
[Epoch 27] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.056 | Time: 8.70s
[Epoch 28] Train acc: 0.996, loss: 0.015 | Test acc: 0.984, loss: 0.085 | Time: 8.66s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.066 | Time: 8.61s
[Epoch 30] Train acc: 0.990, loss: 0.047 | Test acc: 0.975, loss: 0.158 | Time: 8.49s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.059 | Time: 8.45s
[Epoch 32] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.065 | Time: 8.46s
[Epoch 33] Train acc: 0.998, loss: 0.011 | Test acc: 0.985, loss: 0.086 | Time: 8.41s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.062 | Time: 8.49s
[Epoch 35] Train acc: 0.998, loss: 0.010 | Test acc: 0.987, loss: 0.089 | Time: 8.60s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.067 | Time: 8.67s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.068 | Time: 8.52s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.074 | Time: 8.59s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.082 | Time: 8.67s
[Epoch 40] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.068 | Time: 8.54s
[Epoch 41] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.079 | Time: 8.59s
[Epoch 42] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.070 | Time: 8.64s
[Epoch 43] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.070 | Time: 8.69s
[Epoch 44] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.081 | Time: 8.61s
[Epoch 45] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.071 | Time: 8.54s
[Epoch 46] Train acc: 0.999, loss: 0.004 | Test acc: 0.986, loss: 0.091 | Time: 8.64s
[Epoch 47] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.067 | Time: 8.53s
[Epoch 48] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.085 | Time: 8.54s
[Epoch 49] Train acc: 0.999, loss: 0.003 | Test acc: 0.986, loss: 0.080 | Time: 8.75s
[Epoch 50] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.069 | Time: 8.75s
Total training time: 490.43s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed3_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.973, loss: 0.091 | Test acc: 0.966, loss: 0.114 | Time: 21.59s
[Epoch 2] Train acc: 0.984, loss: 0.051 | Test acc: 0.978, loss: 0.071 | Time: 7.83s
[Epoch 3] Train acc: 0.986, loss: 0.045 | Test acc: 0.978, loss: 0.078 | Time: 8.35s
[Epoch 4] Train acc: 0.985, loss: 0.051 | Test acc: 0.979, loss: 0.087 | Time: 8.17s
[Epoch 5] Train acc: 0.987, loss: 0.044 | Test acc: 0.981, loss: 0.088 | Time: 8.39s
[Epoch 6] Train acc: 0.992, loss: 0.029 | Test acc: 0.983, loss: 0.081 | Time: 8.26s
[Epoch 7] Train acc: 0.989, loss: 0.037 | Test acc: 0.977, loss: 0.102 | Time: 8.38s
[Epoch 8] Train acc: 0.994, loss: 0.021 | Test acc: 0.983, loss: 0.075 | Time: 8.47s
[Epoch 9] Train acc: 0.995, loss: 0.019 | Test acc: 0.987, loss: 0.064 | Time: 8.42s
[Epoch 10] Train acc: 0.995, loss: 0.017 | Test acc: 0.984, loss: 0.071 | Time: 8.28s
[Epoch 11] Train acc: 0.995, loss: 0.016 | Test acc: 0.985, loss: 0.061 | Time: 8.29s
[Epoch 12] Train acc: 0.992, loss: 0.033 | Test acc: 0.981, loss: 0.102 | Time: 8.24s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.055 | Time: 8.30s
[Epoch 14] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.057 | Time: 8.25s
[Epoch 15] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.063 | Time: 8.32s
[Epoch 16] Train acc: 0.996, loss: 0.016 | Test acc: 0.984, loss: 0.078 | Time: 8.29s
[Epoch 17] Train acc: 0.997, loss: 0.013 | Test acc: 0.987, loss: 0.072 | Time: 8.48s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.053 | Time: 8.29s
[Epoch 19] Train acc: 0.996, loss: 0.022 | Test acc: 0.985, loss: 0.095 | Time: 8.29s
[Epoch 20] Train acc: 0.998, loss: 0.009 | Test acc: 0.987, loss: 0.073 | Time: 8.25s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.045 | Time: 8.29s
[Epoch 22] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.056 | Time: 8.28s
[Epoch 23] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.080 | Time: 8.28s
[Epoch 24] Train acc: 0.991, loss: 0.030 | Test acc: 0.979, loss: 0.108 | Time: 8.28s
[Epoch 25] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.077 | Time: 8.28s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.058 | Time: 8.46s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.060 | Time: 8.47s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.058 | Time: 8.44s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.057 | Time: 8.54s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.060 | Time: 8.49s
[Epoch 31] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.062 | Time: 8.37s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.076 | Time: 8.30s
[Epoch 33] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.075 | Time: 8.37s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.059 | Time: 8.38s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.074 | Time: 8.37s
[Epoch 36] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.078 | Time: 8.40s
[Epoch 37] Train acc: 0.999, loss: 0.006 | Test acc: 0.990, loss: 0.070 | Time: 8.42s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.070 | Time: 8.37s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.062 | Time: 8.44s
[Epoch 40] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.069 | Time: 8.55s
[Epoch 41] Train acc: 0.998, loss: 0.010 | Test acc: 0.991, loss: 0.070 | Time: 8.44s
[Epoch 42] Train acc: 0.994, loss: 0.281 | Test acc: 0.984, loss: 0.354 | Time: 8.54s
[Epoch 43] Train acc: 0.997, loss: 0.033 | Test acc: 0.988, loss: 0.086 | Time: 8.44s
[Epoch 44] Train acc: 0.998, loss: 0.039 | Test acc: 0.989, loss: 0.076 | Time: 8.46s
[Epoch 45] Train acc: 0.998, loss: 0.093 | Test acc: 0.989, loss: 0.115 | Time: 8.53s
[Epoch 46] Train acc: 0.998, loss: 0.073 | Test acc: 0.989, loss: 0.120 | Time: 8.47s
[Epoch 47] Train acc: 0.999, loss: 0.015 | Test acc: 0.990, loss: 0.068 | Time: 8.47s
[Epoch 48] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.081 | Time: 8.47s
[Epoch 49] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.074 | Time: 8.47s
[Epoch 50] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.080 | Time: 8.79s
Total training time: 500.26s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed3_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/Adam.learning_rate = 0.0003
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/FullES.recompute_samples = 100
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/GradientAccumulator.num_average = 20
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/HyperV2.param_inits = 256
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.lopt = @HyperV2()
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.num_estimators = 8
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.num_steps = 100000
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.staleness = 500
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.summary_every_n = 25
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/run_train.trainer_batch_size = 512
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__e7890c3f_e9b7_4775_9c2a_a88047d73b43/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.980, loss: 0.066 | Test acc: 0.967, loss: 0.098 | Time: 335.17s
[Epoch 2] Train acc: 0.985, loss: 0.047 | Test acc: 0.974, loss: 0.083 | Time: 83.58s
[Epoch 3] Train acc: 0.990, loss: 0.030 | Test acc: 0.980, loss: 0.075 | Time: 77.47s
[Epoch 4] Train acc: 0.993, loss: 0.023 | Test acc: 0.981, loss: 0.075 | Time: 74.52s
[Epoch 5] Train acc: 0.996, loss: 0.014 | Test acc: 0.986, loss: 0.059 | Time: 84.51s
[Epoch 6] Train acc: 0.995, loss: 0.015 | Test acc: 0.983, loss: 0.073 | Time: 83.51s
[Epoch 7] Train acc: 0.997, loss: 0.010 | Test acc: 0.985, loss: 0.064 | Time: 74.02s
[Epoch 8] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.062 | Time: 75.25s
[Epoch 9] Train acc: 0.998, loss: 0.007 | Test acc: 0.984, loss: 0.066 | Time: 69.30s
[Epoch 10] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.064 | Time: 78.96s
[Epoch 11] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.061 | Time: 82.95s
[Epoch 12] Train acc: 0.998, loss: 0.007 | Test acc: 0.985, loss: 0.065 | Time: 83.38s
[Epoch 13] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.064 | Time: 70.00s
[Epoch 14] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.057 | Time: 76.78s
[Epoch 15] Train acc: 0.997, loss: 0.009 | Test acc: 0.984, loss: 0.074 | Time: 83.51s
[Epoch 16] Train acc: 0.997, loss: 0.008 | Test acc: 0.986, loss: 0.068 | Time: 83.72s
[Epoch 17] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.066 | Time: 83.53s
[Epoch 18] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.057 | Time: 71.98s
[Epoch 19] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.066 | Time: 76.52s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.986, loss: 0.083 | Time: 68.11s
[Epoch 21] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.070 | Time: 84.66s
[Epoch 22] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.068 | Time: 74.03s
[Epoch 23] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.071 | Time: 72.33s
[Epoch 24] Train acc: 0.998, loss: 0.006 | Test acc: 0.984, loss: 0.078 | Time: 83.52s
[Epoch 25] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.064 | Time: 85.02s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.060 | Time: 81.10s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.058 | Time: 83.53s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.064 | Time: 70.60s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.063 | Time: 71.91s
[Epoch 30] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.065 | Time: 83.39s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.062 | Time: 70.19s
[Epoch 32] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.063 | Time: 83.65s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.056 | Time: 69.55s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.063 | Time: 82.46s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.067 | Time: 83.80s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.067 | Time: 72.86s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.067 | Time: 84.39s
[Epoch 38] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.067 | Time: 73.71s
[Epoch 39] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.077 | Time: 79.05s
[Epoch 40] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.070 | Time: 83.60s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.066 | Time: 81.49s
[Epoch 42] Train acc: 1.000, loss: 0.002 | Test acc: 0.992, loss: 0.072 | Time: 71.94s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.083 | Time: 83.89s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.067 | Time: 83.41s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.061 | Time: 84.53s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.066 | Time: 82.85s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.074 | Time: 83.81s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.071 | Time: 71.28s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.074 | Time: 79.88s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.075 | Time: 83.48s
Total training time: 4266.00s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed4_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.883, loss: 0.395 | Test acc: 0.870, loss: 0.418 | Time: 15.06s
[Epoch 2] Train acc: 0.949, loss: 0.179 | Test acc: 0.929, loss: 0.226 | Time: 5.43s
[Epoch 3] Train acc: 0.970, loss: 0.110 | Test acc: 0.948, loss: 0.169 | Time: 5.70s
[Epoch 4] Train acc: 0.983, loss: 0.070 | Test acc: 0.960, loss: 0.137 | Time: 5.60s
[Epoch 5] Train acc: 0.989, loss: 0.046 | Test acc: 0.962, loss: 0.122 | Time: 5.65s
[Epoch 6] Train acc: 0.994, loss: 0.030 | Test acc: 0.966, loss: 0.112 | Time: 5.61s
[Epoch 7] Train acc: 0.996, loss: 0.021 | Test acc: 0.968, loss: 0.109 | Time: 5.63s
[Epoch 8] Train acc: 0.998, loss: 0.014 | Test acc: 0.969, loss: 0.106 | Time: 5.67s
[Epoch 9] Train acc: 0.999, loss: 0.010 | Test acc: 0.970, loss: 0.105 | Time: 5.66s
[Epoch 10] Train acc: 0.999, loss: 0.007 | Test acc: 0.970, loss: 0.105 | Time: 5.64s
[Epoch 11] Train acc: 1.000, loss: 0.006 | Test acc: 0.971, loss: 0.104 | Time: 5.67s
[Epoch 12] Train acc: 1.000, loss: 0.005 | Test acc: 0.971, loss: 0.107 | Time: 5.66s
[Epoch 13] Train acc: 1.000, loss: 0.004 | Test acc: 0.972, loss: 0.106 | Time: 5.63s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.971, loss: 0.108 | Time: 5.64s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.973, loss: 0.108 | Time: 5.66s
[Epoch 16] Train acc: 1.000, loss: 0.003 | Test acc: 0.971, loss: 0.109 | Time: 5.63s
[Epoch 17] Train acc: 1.000, loss: 0.003 | Test acc: 0.972, loss: 0.109 | Time: 5.64s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.971, loss: 0.109 | Time: 5.57s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.971, loss: 0.109 | Time: 5.63s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.972, loss: 0.109 | Time: 5.65s
[Epoch 21] Train acc: 1.000, loss: 0.002 | Test acc: 0.972, loss: 0.109 | Time: 5.62s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.109 | Time: 5.62s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.109 | Time: 5.54s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.109 | Time: 5.59s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.109 | Time: 5.64s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.109 | Time: 5.68s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.108 | Time: 5.61s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.110 | Time: 5.64s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.109 | Time: 5.69s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.110 | Time: 5.68s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.109 | Time: 5.64s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.111 | Time: 5.94s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.110 | Time: 5.86s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.111 | Time: 5.82s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.110 | Time: 5.96s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.975, loss: 0.111 | Time: 5.83s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.111 | Time: 5.92s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.112 | Time: 5.92s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.112 | Time: 5.98s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.112 | Time: 5.92s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.111 | Time: 6.00s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.112 | Time: 5.93s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.111 | Time: 5.95s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.112 | Time: 5.96s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.975, loss: 0.112 | Time: 5.95s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.974, loss: 0.113 | Time: 5.75s
[Epoch 47] Train acc: 1.000, loss: 0.001 | Test acc: 0.975, loss: 0.113 | Time: 5.74s
[Epoch 48] Train acc: 1.000, loss: 0.001 | Test acc: 0.975, loss: 0.113 | Time: 5.79s
[Epoch 49] Train acc: 1.000, loss: 0.001 | Test acc: 0.975, loss: 0.113 | Time: 5.68s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.975, loss: 0.113 | Time: 5.72s
Total training time: 363.56s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed4_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.976, loss: 0.077 | Test acc: 0.960, loss: 0.119 | Time: 16.40s
[Epoch 2] Train acc: 0.993, loss: 0.026 | Test acc: 0.976, loss: 0.079 | Time: 6.86s
[Epoch 3] Train acc: 0.996, loss: 0.013 | Test acc: 0.979, loss: 0.073 | Time: 6.80s
[Epoch 4] Train acc: 0.999, loss: 0.004 | Test acc: 0.979, loss: 0.073 | Time: 6.89s
[Epoch 5] Train acc: 0.999, loss: 0.003 | Test acc: 0.982, loss: 0.073 | Time: 6.94s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.982, loss: 0.069 | Time: 7.05s
[Epoch 7] Train acc: 1.000, loss: 0.001 | Test acc: 0.983, loss: 0.067 | Time: 7.02s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 7.07s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.067 | Time: 6.95s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.067 | Time: 7.19s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.067 | Time: 7.09s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.069 | Time: 7.08s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.069 | Time: 6.92s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.070 | Time: 6.91s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.070 | Time: 6.98s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.070 | Time: 6.98s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.070 | Time: 7.05s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.071 | Time: 7.03s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.071 | Time: 7.04s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.93s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.95s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.92s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.92s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.98s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.99s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.86s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 7.05s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.072 | Time: 6.95s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.86s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.94s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 6.88s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.03s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.06s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.27s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.11s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 7.17s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.18s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.06s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.14s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 7.14s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.16s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.072 | Time: 7.27s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.073 | Time: 7.16s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.073 | Time: 7.11s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 7.16s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 7.19s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 7.10s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 7.33s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.15s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.073 | Time: 7.13s
Total training time: 432.53s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed4_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.976, loss: 0.079 | Test acc: 0.969, loss: 0.107 | Time: 20.75s
[Epoch 2] Train acc: 0.971, loss: 0.099 | Test acc: 0.968, loss: 0.119 | Time: 7.63s
[Epoch 3] Train acc: 0.985, loss: 0.052 | Test acc: 0.975, loss: 0.092 | Time: 8.12s
[Epoch 4] Train acc: 0.984, loss: 0.050 | Test acc: 0.976, loss: 0.093 | Time: 7.80s
[Epoch 5] Train acc: 0.992, loss: 0.027 | Test acc: 0.984, loss: 0.061 | Time: 8.26s
[Epoch 6] Train acc: 0.992, loss: 0.024 | Test acc: 0.984, loss: 0.064 | Time: 8.02s
[Epoch 7] Train acc: 0.992, loss: 0.029 | Test acc: 0.983, loss: 0.084 | Time: 8.28s
[Epoch 8] Train acc: 0.994, loss: 0.021 | Test acc: 0.985, loss: 0.071 | Time: 8.01s
[Epoch 9] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.058 | Time: 8.07s
[Epoch 10] Train acc: 0.998, loss: 0.008 | Test acc: 0.990, loss: 0.057 | Time: 8.02s
[Epoch 11] Train acc: 0.994, loss: 0.022 | Test acc: 0.982, loss: 0.077 | Time: 8.11s
[Epoch 12] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.058 | Time: 8.01s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.056 | Time: 8.15s
[Epoch 14] Train acc: 0.997, loss: 0.011 | Test acc: 0.988, loss: 0.062 | Time: 8.00s
[Epoch 15] Train acc: 0.997, loss: 0.012 | Test acc: 0.988, loss: 0.062 | Time: 8.16s
[Epoch 16] Train acc: 0.993, loss: 0.028 | Test acc: 0.982, loss: 0.092 | Time: 8.03s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.058 | Time: 8.31s
[Epoch 18] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.058 | Time: 8.12s
[Epoch 19] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.048 | Time: 8.27s
[Epoch 20] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.057 | Time: 8.30s
[Epoch 21] Train acc: 0.995, loss: 0.018 | Test acc: 0.982, loss: 0.085 | Time: 8.14s
[Epoch 22] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.060 | Time: 8.36s
[Epoch 23] Train acc: 0.997, loss: 0.013 | Test acc: 0.986, loss: 0.080 | Time: 8.22s
[Epoch 24] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.075 | Time: 8.34s
[Epoch 25] Train acc: 0.996, loss: 0.019 | Test acc: 0.985, loss: 0.076 | Time: 8.27s
[Epoch 26] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.072 | Time: 8.30s
[Epoch 27] Train acc: 0.997, loss: 0.013 | Test acc: 0.984, loss: 0.097 | Time: 8.28s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.069 | Time: 8.28s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.073 | Time: 8.24s
[Epoch 30] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.085 | Time: 8.28s
[Epoch 31] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.067 | Time: 8.24s
[Epoch 32] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.070 | Time: 8.31s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.065 | Time: 8.28s
[Epoch 34] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.068 | Time: 8.23s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.061 | Time: 8.29s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.060 | Time: 8.34s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.061 | Time: 8.37s
[Epoch 38] Train acc: 0.990, loss: 0.257 | Test acc: 0.979, loss: 0.314 | Time: 8.44s
[Epoch 39] Train acc: 0.993, loss: 0.026 | Test acc: 0.980, loss: 0.112 | Time: 8.32s
[Epoch 40] Train acc: 0.999, loss: 0.006 | Test acc: 0.988, loss: 0.071 | Time: 8.40s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.073 | Time: 8.31s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.075 | Time: 8.26s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.083 | Time: 8.34s
[Epoch 44] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.066 | Time: 8.50s
[Epoch 45] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.092 | Time: 8.35s
[Epoch 46] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.075 | Time: 8.30s
[Epoch 47] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.068 | Time: 8.36s
[Epoch 48] Train acc: 0.994, loss: 0.034 | Test acc: 0.985, loss: 0.107 | Time: 8.35s
[Epoch 49] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.074 | Time: 8.35s
[Epoch 50] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.065 | Time: 8.39s
Total training time: 492.11s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed4_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.969, loss: 0.105 | Test acc: 0.961, loss: 0.122 | Time: 20.53s
[Epoch 2] Train acc: 0.970, loss: 0.112 | Test acc: 0.962, loss: 0.150 | Time: 7.22s
[Epoch 3] Train acc: 0.975, loss: 0.084 | Test acc: 0.966, loss: 0.117 | Time: 7.75s
[Epoch 4] Train acc: 0.985, loss: 0.047 | Test acc: 0.979, loss: 0.086 | Time: 7.58s
[Epoch 5] Train acc: 0.990, loss: 0.033 | Test acc: 0.984, loss: 0.079 | Time: 7.83s
[Epoch 6] Train acc: 0.994, loss: 0.022 | Test acc: 0.986, loss: 0.059 | Time: 7.71s
[Epoch 7] Train acc: 0.990, loss: 0.035 | Test acc: 0.981, loss: 0.081 | Time: 7.83s
[Epoch 8] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.053 | Time: 8.56s
[Epoch 9] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.049 | Time: 8.53s
[Epoch 10] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.056 | Time: 8.54s
[Epoch 11] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.053 | Time: 8.55s
[Epoch 12] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.051 | Time: 8.46s
[Epoch 13] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.061 | Time: 8.45s
[Epoch 14] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.070 | Time: 8.43s
[Epoch 15] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.054 | Time: 8.44s
[Epoch 16] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.059 | Time: 8.46s
[Epoch 17] Train acc: 0.997, loss: 0.013 | Test acc: 0.986, loss: 0.067 | Time: 8.47s
[Epoch 18] Train acc: 0.997, loss: 0.011 | Test acc: 0.987, loss: 0.064 | Time: 8.46s
[Epoch 19] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.081 | Time: 8.49s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.081 | Time: 8.46s
[Epoch 21] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.065 | Time: 8.53s
[Epoch 22] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.060 | Time: 8.44s
[Epoch 23] Train acc: 0.924, loss: 9.854 | Test acc: 0.910, loss: 10.037 | Time: 8.61s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.065 | Time: 8.54s
[Epoch 25] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.067 | Time: 8.60s
[Epoch 26] Train acc: 0.999, loss: 0.007 | Test acc: 0.988, loss: 0.080 | Time: 8.57s
[Epoch 27] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.065 | Time: 8.53s
[Epoch 28] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.059 | Time: 8.44s
[Epoch 29] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.078 | Time: 8.61s
[Epoch 30] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.066 | Time: 8.47s
[Epoch 31] Train acc: 0.998, loss: 0.011 | Test acc: 0.986, loss: 0.079 | Time: 8.66s
[Epoch 32] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.078 | Time: 8.64s
[Epoch 33] Train acc: 0.995, loss: 0.020 | Test acc: 0.985, loss: 0.091 | Time: 8.51s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.061 | Time: 8.54s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.056 | Time: 8.47s
[Epoch 36] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.076 | Time: 8.50s
[Epoch 37] Train acc: 0.997, loss: 0.011 | Test acc: 0.987, loss: 0.059 | Time: 8.50s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.063 | Time: 8.60s
[Epoch 39] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.081 | Time: 8.67s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.070 | Time: 8.93s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.055 | Time: 8.99s
[Epoch 42] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.070 | Time: 8.51s
[Epoch 43] Train acc: 0.996, loss: 0.016 | Test acc: 0.985, loss: 0.085 | Time: 8.65s
[Epoch 44] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.064 | Time: 8.50s
[Epoch 45] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.063 | Time: 8.51s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.988, loss: 0.057 | Time: 8.50s
[Epoch 47] Train acc: 0.997, loss: 0.015 | Test acc: 0.987, loss: 0.091 | Time: 8.50s
[Epoch 48] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.066 | Time: 8.50s
[Epoch 49] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.066 | Time: 8.66s
[Epoch 50] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.068 | Time: 8.58s
Total training time: 503.78s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed4_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/Adam.learning_rate = 0.0003
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/FullES.recompute_samples = 100
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/GradientAccumulator.num_average = 20
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/HyperV2.param_inits = 256
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.lopt = @HyperV2()
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.num_estimators = 8
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.num_steps = 100000
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.staleness = 500
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.summary_every_n = 25
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/run_train.trainer_batch_size = 512
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__6f582918_54e9_479b_be3e_1410637fac9c/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.979, loss: 0.069 | Test acc: 0.970, loss: 0.100 | Time: 340.67s
[Epoch 2] Train acc: 0.988, loss: 0.038 | Test acc: 0.974, loss: 0.080 | Time: 73.83s
[Epoch 3] Train acc: 0.990, loss: 0.030 | Test acc: 0.977, loss: 0.072 | Time: 83.66s
[Epoch 4] Train acc: 0.993, loss: 0.021 | Test acc: 0.982, loss: 0.068 | Time: 72.77s
[Epoch 5] Train acc: 0.995, loss: 0.016 | Test acc: 0.984, loss: 0.074 | Time: 77.97s
[Epoch 6] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.055 | Time: 75.54s
[Epoch 7] Train acc: 0.996, loss: 0.013 | Test acc: 0.984, loss: 0.072 | Time: 83.94s
[Epoch 8] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.064 | Time: 83.76s
[Epoch 9] Train acc: 0.997, loss: 0.008 | Test acc: 0.986, loss: 0.063 | Time: 76.08s
[Epoch 10] Train acc: 0.998, loss: 0.006 | Test acc: 0.983, loss: 0.075 | Time: 67.92s
[Epoch 11] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.062 | Time: 73.69s
[Epoch 12] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.072 | Time: 83.67s
[Epoch 13] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.063 | Time: 83.51s
[Epoch 14] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.064 | Time: 71.97s
[Epoch 15] Train acc: 0.996, loss: 0.014 | Test acc: 0.982, loss: 0.101 | Time: 75.55s
[Epoch 16] Train acc: 0.998, loss: 0.007 | Test acc: 0.984, loss: 0.078 | Time: 83.52s
[Epoch 17] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.073 | Time: 83.66s
[Epoch 18] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.073 | Time: 85.01s
[Epoch 19] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.072 | Time: 72.87s
[Epoch 20] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.068 | Time: 75.70s
[Epoch 21] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.063 | Time: 83.29s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.986, loss: 0.073 | Time: 72.35s
[Epoch 23] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.071 | Time: 77.92s
[Epoch 24] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.068 | Time: 83.52s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.061 | Time: 76.56s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.986, loss: 0.065 | Time: 83.34s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.062 | Time: 85.05s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.066 | Time: 83.04s
[Epoch 29] Train acc: 0.998, loss: 0.005 | Test acc: 0.986, loss: 0.079 | Time: 83.47s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.074 | Time: 82.61s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.068 | Time: 75.70s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.061 | Time: 84.58s
[Epoch 33] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.073 | Time: 83.47s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.062 | Time: 83.40s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.068 | Time: 80.20s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.061 | Time: 69.12s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.988, loss: 0.069 | Time: 80.95s
[Epoch 38] Train acc: 1.000, loss: 0.002 | Test acc: 0.987, loss: 0.069 | Time: 83.97s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.062 | Time: 83.93s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.069 | Time: 79.72s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.081 | Time: 70.10s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.067 | Time: 82.80s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.074 | Time: 75.39s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.989, loss: 0.072 | Time: 71.83s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.082 | Time: 85.05s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.083 | Time: 82.02s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.076 | Time: 77.80s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.078 | Time: 70.71s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.077 | Time: 82.93s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.077 | Time: 84.67s
Total training time: 4294.67s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed5_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.883, loss: 0.391 | Test acc: 0.870, loss: 0.422 | Time: 15.19s
[Epoch 2] Train acc: 0.950, loss: 0.174 | Test acc: 0.933, loss: 0.227 | Time: 5.43s
[Epoch 3] Train acc: 0.971, loss: 0.107 | Test acc: 0.946, loss: 0.174 | Time: 5.70s
[Epoch 4] Train acc: 0.984, loss: 0.065 | Test acc: 0.956, loss: 0.144 | Time: 5.71s
[Epoch 5] Train acc: 0.990, loss: 0.043 | Test acc: 0.960, loss: 0.131 | Time: 5.83s
[Epoch 6] Train acc: 0.995, loss: 0.028 | Test acc: 0.962, loss: 0.127 | Time: 5.71s
[Epoch 7] Train acc: 0.998, loss: 0.018 | Test acc: 0.963, loss: 0.122 | Time: 5.77s
[Epoch 8] Train acc: 0.998, loss: 0.014 | Test acc: 0.962, loss: 0.126 | Time: 5.74s
[Epoch 9] Train acc: 0.999, loss: 0.009 | Test acc: 0.963, loss: 0.123 | Time: 5.73s
[Epoch 10] Train acc: 1.000, loss: 0.006 | Test acc: 0.964, loss: 0.122 | Time: 5.80s
[Epoch 11] Train acc: 1.000, loss: 0.005 | Test acc: 0.965, loss: 0.122 | Time: 5.76s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.965, loss: 0.122 | Time: 5.76s
[Epoch 13] Train acc: 1.000, loss: 0.003 | Test acc: 0.965, loss: 0.124 | Time: 5.76s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.965, loss: 0.123 | Time: 5.74s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.966, loss: 0.125 | Time: 5.74s
[Epoch 16] Train acc: 1.000, loss: 0.002 | Test acc: 0.965, loss: 0.124 | Time: 5.76s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.966, loss: 0.126 | Time: 5.74s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.966, loss: 0.126 | Time: 5.77s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.966, loss: 0.126 | Time: 5.78s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.966, loss: 0.127 | Time: 5.78s
[Epoch 21] Train acc: 1.000, loss: 0.002 | Test acc: 0.966, loss: 0.126 | Time: 5.80s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.127 | Time: 5.83s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.966, loss: 0.127 | Time: 5.80s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.127 | Time: 5.81s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.966, loss: 0.127 | Time: 5.81s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.966, loss: 0.127 | Time: 5.82s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.966, loss: 0.127 | Time: 5.90s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.966, loss: 0.129 | Time: 5.83s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.966, loss: 0.128 | Time: 5.89s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.966, loss: 0.129 | Time: 5.83s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.129 | Time: 5.86s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.129 | Time: 5.78s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.129 | Time: 5.85s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.966, loss: 0.129 | Time: 5.87s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.129 | Time: 6.10s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.130 | Time: 5.89s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.129 | Time: 5.94s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.129 | Time: 5.89s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.130 | Time: 5.91s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.130 | Time: 5.95s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.129 | Time: 5.92s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.129 | Time: 5.94s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.128 | Time: 5.98s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.129 | Time: 5.91s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.129 | Time: 5.95s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.130 | Time: 5.88s
[Epoch 47] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.130 | Time: 5.90s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.968, loss: 0.130 | Time: 6.36s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.968, loss: 0.129 | Time: 6.25s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.969, loss: 0.130 | Time: 6.30s
Total training time: 370.77s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed5_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.979, loss: 0.069 | Test acc: 0.964, loss: 0.113 | Time: 17.24s
[Epoch 2] Train acc: 0.990, loss: 0.034 | Test acc: 0.971, loss: 0.089 | Time: 6.22s
[Epoch 3] Train acc: 0.996, loss: 0.016 | Test acc: 0.976, loss: 0.083 | Time: 6.64s
[Epoch 4] Train acc: 0.998, loss: 0.007 | Test acc: 0.980, loss: 0.073 | Time: 6.41s
[Epoch 5] Train acc: 1.000, loss: 0.002 | Test acc: 0.982, loss: 0.069 | Time: 6.58s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.984, loss: 0.066 | Time: 6.41s
[Epoch 7] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.065 | Time: 6.58s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.063 | Time: 6.35s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.063 | Time: 6.49s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.063 | Time: 6.48s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.063 | Time: 6.50s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.064 | Time: 6.42s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.065 | Time: 6.54s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.065 | Time: 6.40s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.066 | Time: 6.50s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.065 | Time: 6.49s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.065 | Time: 6.45s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.065 | Time: 6.52s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.066 | Time: 6.58s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.066 | Time: 6.55s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.066 | Time: 6.58s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.066 | Time: 6.69s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.066 | Time: 6.55s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.066 | Time: 6.56s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 6.56s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.067 | Time: 6.50s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 6.57s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.63s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.067 | Time: 6.94s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 6.96s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.067 | Time: 6.81s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.57s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.60s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.57s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.65s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.73s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.64s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.63s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.67s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.73s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.67s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.65s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.068 | Time: 6.62s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.69s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.73s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.66s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.68s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.069 | Time: 6.66s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.60s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.64s
Total training time: 408.01s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed5_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.967, loss: 0.106 | Test acc: 0.959, loss: 0.129 | Time: 24.45s
[Epoch 2] Train acc: 0.982, loss: 0.056 | Test acc: 0.976, loss: 0.079 | Time: 8.09s
[Epoch 3] Train acc: 0.985, loss: 0.052 | Test acc: 0.981, loss: 0.078 | Time: 8.70s
[Epoch 4] Train acc: 0.986, loss: 0.043 | Test acc: 0.978, loss: 0.086 | Time: 8.15s
[Epoch 5] Train acc: 0.989, loss: 0.035 | Test acc: 0.979, loss: 0.075 | Time: 8.23s
[Epoch 6] Train acc: 0.992, loss: 0.025 | Test acc: 0.982, loss: 0.071 | Time: 8.10s
[Epoch 7] Train acc: 0.993, loss: 0.022 | Test acc: 0.984, loss: 0.067 | Time: 8.27s
[Epoch 8] Train acc: 0.995, loss: 0.016 | Test acc: 0.985, loss: 0.065 | Time: 8.12s
[Epoch 9] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.052 | Time: 8.42s
[Epoch 10] Train acc: 0.993, loss: 0.025 | Test acc: 0.982, loss: 0.086 | Time: 8.22s
[Epoch 11] Train acc: 0.997, loss: 0.011 | Test acc: 0.988, loss: 0.057 | Time: 8.34s
[Epoch 12] Train acc: 0.995, loss: 0.019 | Test acc: 0.986, loss: 0.063 | Time: 8.27s
[Epoch 13] Train acc: 0.995, loss: 0.016 | Test acc: 0.985, loss: 0.075 | Time: 8.19s
[Epoch 14] Train acc: 0.994, loss: 0.024 | Test acc: 0.985, loss: 0.086 | Time: 8.16s
[Epoch 15] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.065 | Time: 8.30s
[Epoch 16] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.064 | Time: 8.35s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.985, loss: 0.071 | Time: 8.35s
[Epoch 18] Train acc: 0.997, loss: 0.014 | Test acc: 0.988, loss: 0.078 | Time: 8.10s
[Epoch 19] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.082 | Time: 8.20s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.051 | Time: 8.13s
[Epoch 21] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.056 | Time: 8.23s
[Epoch 22] Train acc: 0.997, loss: 0.010 | Test acc: 0.985, loss: 0.077 | Time: 8.17s
[Epoch 23] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.063 | Time: 8.28s
[Epoch 24] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.061 | Time: 8.30s
[Epoch 25] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.058 | Time: 8.34s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.067 | Time: 8.17s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.055 | Time: 8.16s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.058 | Time: 8.23s
[Epoch 29] Train acc: 0.997, loss: 0.011 | Test acc: 0.984, loss: 0.091 | Time: 8.32s
[Epoch 30] Train acc: 0.997, loss: 0.016 | Test acc: 0.984, loss: 0.087 | Time: 8.19s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.065 | Time: 8.26s
[Epoch 32] Train acc: 0.999, loss: 0.007 | Test acc: 0.989, loss: 0.076 | Time: 8.25s
[Epoch 33] Train acc: 0.998, loss: 0.008 | Test acc: 0.990, loss: 0.055 | Time: 8.48s
[Epoch 34] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.071 | Time: 8.44s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.060 | Time: 8.51s
[Epoch 36] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.069 | Time: 8.36s
[Epoch 37] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.070 | Time: 8.44s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.066 | Time: 8.40s
[Epoch 39] Train acc: 0.998, loss: 0.010 | Test acc: 0.988, loss: 0.077 | Time: 8.66s
[Epoch 40] Train acc: 0.998, loss: 0.009 | Test acc: 0.988, loss: 0.072 | Time: 8.60s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.051 | Time: 8.48s
[Epoch 42] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.065 | Time: 8.60s
[Epoch 43] Train acc: 0.992, loss: 0.136 | Test acc: 0.979, loss: 0.191 | Time: 8.49s
[Epoch 44] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.065 | Time: 8.47s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.988, loss: 0.074 | Time: 8.57s
[Epoch 46] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.069 | Time: 8.55s
[Epoch 47] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.082 | Time: 8.45s
[Epoch 48] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.075 | Time: 8.71s
[Epoch 49] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.073 | Time: 8.43s
[Epoch 50] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.079 | Time: 8.45s
Total training time: 501.71s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed5_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.973, loss: 0.090 | Test acc: 0.966, loss: 0.115 | Time: 21.26s
[Epoch 2] Train acc: 0.982, loss: 0.059 | Test acc: 0.978, loss: 0.082 | Time: 7.77s
[Epoch 3] Train acc: 0.983, loss: 0.053 | Test acc: 0.975, loss: 0.092 | Time: 8.02s
[Epoch 4] Train acc: 0.988, loss: 0.042 | Test acc: 0.982, loss: 0.085 | Time: 7.96s
[Epoch 5] Train acc: 0.991, loss: 0.031 | Test acc: 0.984, loss: 0.074 | Time: 7.99s
[Epoch 6] Train acc: 0.991, loss: 0.030 | Test acc: 0.983, loss: 0.077 | Time: 8.10s
[Epoch 7] Train acc: 0.987, loss: 0.041 | Test acc: 0.976, loss: 0.088 | Time: 8.24s
[Epoch 8] Train acc: 0.991, loss: 0.033 | Test acc: 0.983, loss: 0.073 | Time: 7.94s
[Epoch 9] Train acc: 0.995, loss: 0.017 | Test acc: 0.987, loss: 0.054 | Time: 8.11s
[Epoch 10] Train acc: 0.994, loss: 0.020 | Test acc: 0.983, loss: 0.072 | Time: 8.05s
[Epoch 11] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.047 | Time: 8.24s
[Epoch 12] Train acc: 0.975, loss: 0.122 | Test acc: 0.961, loss: 0.208 | Time: 7.94s
[Epoch 13] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.056 | Time: 8.01s
[Epoch 14] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.049 | Time: 7.97s
[Epoch 15] Train acc: 0.994, loss: 0.034 | Test acc: 0.985, loss: 0.099 | Time: 7.98s
[Epoch 16] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.069 | Time: 8.10s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.078 | Time: 8.08s
[Epoch 18] Train acc: 0.997, loss: 0.016 | Test acc: 0.988, loss: 0.061 | Time: 7.97s
[Epoch 19] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.063 | Time: 8.05s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.070 | Time: 8.00s
[Epoch 21] Train acc: 0.997, loss: 0.014 | Test acc: 0.986, loss: 0.078 | Time: 8.07s
[Epoch 22] Train acc: 0.993, loss: 0.037 | Test acc: 0.982, loss: 0.104 | Time: 7.99s
[Epoch 23] Train acc: 0.998, loss: 0.014 | Test acc: 0.988, loss: 0.060 | Time: 7.99s
[Epoch 24] Train acc: 0.989, loss: 0.060 | Test acc: 0.978, loss: 0.120 | Time: 7.95s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.059 | Time: 8.24s
[Epoch 26] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.067 | Time: 8.12s
[Epoch 27] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.073 | Time: 8.21s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.058 | Time: 8.10s
[Epoch 29] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.087 | Time: 8.03s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.052 | Time: 8.00s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.061 | Time: 8.09s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.057 | Time: 8.03s
[Epoch 33] Train acc: 0.995, loss: 0.017 | Test acc: 0.984, loss: 0.087 | Time: 8.27s
[Epoch 34] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.072 | Time: 8.21s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.048 | Time: 8.24s
[Epoch 36] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.068 | Time: 8.20s
[Epoch 37] Train acc: 0.996, loss: 0.019 | Test acc: 0.986, loss: 0.089 | Time: 8.17s
[Epoch 38] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.065 | Time: 8.16s
[Epoch 39] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.068 | Time: 8.25s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.063 | Time: 8.20s
[Epoch 41] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.057 | Time: 8.14s
[Epoch 42] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.074 | Time: 8.04s
[Epoch 43] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.061 | Time: 8.25s
[Epoch 44] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.079 | Time: 8.13s
[Epoch 45] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.057 | Time: 8.05s
[Epoch 46] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.061 | Time: 8.18s
[Epoch 47] Train acc: 0.997, loss: 0.013 | Test acc: 0.987, loss: 0.096 | Time: 8.33s
[Epoch 48] Train acc: 0.996, loss: 0.017 | Test acc: 0.987, loss: 0.114 | Time: 8.16s
[Epoch 49] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.071 | Time: 8.30s
[Epoch 50] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.064 | Time: 8.13s
Total training time: 486.73s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed5_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/Adam.learning_rate = 0.0003
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/FullES.recompute_samples = 100
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/GradientAccumulator.num_average = 20
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/HyperV2.param_inits = 256
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.lopt = @HyperV2()
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.num_estimators = 8
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.num_steps = 100000
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.staleness = 500
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.summary_every_n = 25
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/run_train.trainer_batch_size = 512
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__a78ec8dd_4af6_47d0_b3ce_de2be15fd278/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.981, loss: 0.061 | Test acc: 0.968, loss: 0.095 | Time: 343.82s
[Epoch 2] Train acc: 0.989, loss: 0.035 | Test acc: 0.978, loss: 0.071 | Time: 83.51s
[Epoch 3] Train acc: 0.991, loss: 0.027 | Test acc: 0.981, loss: 0.062 | Time: 71.67s
[Epoch 4] Train acc: 0.992, loss: 0.023 | Test acc: 0.980, loss: 0.075 | Time: 78.47s
[Epoch 5] Train acc: 0.995, loss: 0.016 | Test acc: 0.982, loss: 0.065 | Time: 83.85s
[Epoch 6] Train acc: 0.995, loss: 0.016 | Test acc: 0.983, loss: 0.073 | Time: 83.10s
[Epoch 7] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.053 | Time: 80.66s
[Epoch 8] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.057 | Time: 70.63s
[Epoch 9] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.056 | Time: 83.07s
[Epoch 10] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.061 | Time: 83.35s
[Epoch 11] Train acc: 0.997, loss: 0.007 | Test acc: 0.985, loss: 0.059 | Time: 83.48s
[Epoch 12] Train acc: 0.997, loss: 0.008 | Test acc: 0.985, loss: 0.067 | Time: 84.98s
[Epoch 13] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.058 | Time: 80.06s
[Epoch 14] Train acc: 0.997, loss: 0.010 | Test acc: 0.984, loss: 0.074 | Time: 83.19s
[Epoch 15] Train acc: 0.997, loss: 0.012 | Test acc: 0.986, loss: 0.068 | Time: 79.09s
[Epoch 16] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.062 | Time: 82.63s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.069 | Time: 69.42s
[Epoch 18] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.060 | Time: 76.72s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.061 | Time: 82.97s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.066 | Time: 83.90s
[Epoch 21] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.050 | Time: 82.70s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.056 | Time: 84.63s
[Epoch 23] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.058 | Time: 83.40s
[Epoch 24] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.074 | Time: 69.18s
[Epoch 25] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.066 | Time: 70.34s
[Epoch 26] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.058 | Time: 70.70s
[Epoch 27] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.060 | Time: 84.02s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.065 | Time: 83.41s
[Epoch 29] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.055 | Time: 83.00s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.060 | Time: 83.53s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.062 | Time: 70.67s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.056 | Time: 76.98s
[Epoch 33] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.058 | Time: 68.79s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.060 | Time: 83.43s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.062 | Time: 78.81s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.058 | Time: 82.45s
[Epoch 37] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.054 | Time: 84.66s
[Epoch 38] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.068 | Time: 83.69s
[Epoch 39] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.058 | Time: 78.35s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.065 | Time: 67.76s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.064 | Time: 81.51s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.059 | Time: 83.64s
[Epoch 43] Train acc: 0.999, loss: 0.001 | Test acc: 0.991, loss: 0.067 | Time: 84.36s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.063 | Time: 80.28s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.068 | Time: 67.48s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.067 | Time: 79.74s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.068 | Time: 83.60s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.068 | Time: 84.92s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.990, loss: 0.071 | Time: 79.97s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.071 | Time: 82.67s
Total training time: 4318.03s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed6_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.893, loss: 0.358 | Test acc: 0.880, loss: 0.386 | Time: 15.10s
[Epoch 2] Train acc: 0.956, loss: 0.156 | Test acc: 0.938, loss: 0.202 | Time: 5.55s
[Epoch 3] Train acc: 0.975, loss: 0.093 | Test acc: 0.953, loss: 0.150 | Time: 5.70s
[Epoch 4] Train acc: 0.986, loss: 0.058 | Test acc: 0.960, loss: 0.127 | Time: 5.64s
[Epoch 5] Train acc: 0.992, loss: 0.038 | Test acc: 0.964, loss: 0.117 | Time: 5.70s
[Epoch 6] Train acc: 0.996, loss: 0.024 | Test acc: 0.965, loss: 0.115 | Time: 5.60s
[Epoch 7] Train acc: 0.998, loss: 0.016 | Test acc: 0.966, loss: 0.110 | Time: 5.54s
[Epoch 8] Train acc: 0.999, loss: 0.011 | Test acc: 0.968, loss: 0.109 | Time: 5.57s
[Epoch 9] Train acc: 1.000, loss: 0.007 | Test acc: 0.969, loss: 0.105 | Time: 5.58s
[Epoch 10] Train acc: 1.000, loss: 0.006 | Test acc: 0.969, loss: 0.105 | Time: 5.64s
[Epoch 11] Train acc: 1.000, loss: 0.004 | Test acc: 0.970, loss: 0.105 | Time: 5.66s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.969, loss: 0.107 | Time: 5.64s
[Epoch 13] Train acc: 1.000, loss: 0.003 | Test acc: 0.969, loss: 0.107 | Time: 5.62s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.970, loss: 0.108 | Time: 5.61s
[Epoch 15] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.108 | Time: 5.60s
[Epoch 16] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.107 | Time: 5.60s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.107 | Time: 5.59s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.107 | Time: 5.59s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.971, loss: 0.107 | Time: 5.59s
[Epoch 20] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.108 | Time: 5.67s
[Epoch 21] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.107 | Time: 5.61s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.108 | Time: 5.88s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.108 | Time: 5.80s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.108 | Time: 5.86s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.109 | Time: 5.87s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.110 | Time: 5.84s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.109 | Time: 5.78s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.110 | Time: 5.80s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.109 | Time: 5.80s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.109 | Time: 5.81s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.110 | Time: 5.73s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.110 | Time: 5.80s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.110 | Time: 5.91s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.111 | Time: 5.89s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.110 | Time: 5.84s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.111 | Time: 5.77s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.110 | Time: 5.80s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.110 | Time: 5.83s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.110 | Time: 5.84s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.111 | Time: 5.78s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.110 | Time: 5.91s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.109 | Time: 5.93s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.108 | Time: 5.92s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.109 | Time: 6.19s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.110 | Time: 6.24s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.110 | Time: 6.22s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.971, loss: 0.110 | Time: 6.10s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.972, loss: 0.110 | Time: 6.08s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.971, loss: 0.110 | Time: 6.17s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.971, loss: 0.110 | Time: 5.84s
Total training time: 366.72s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed6_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.979, loss: 0.069 | Test acc: 0.967, loss: 0.105 | Time: 18.88s
[Epoch 2] Train acc: 0.991, loss: 0.029 | Test acc: 0.977, loss: 0.078 | Time: 6.53s
[Epoch 3] Train acc: 0.996, loss: 0.014 | Test acc: 0.980, loss: 0.070 | Time: 6.99s
[Epoch 4] Train acc: 0.998, loss: 0.007 | Test acc: 0.981, loss: 0.067 | Time: 6.74s
[Epoch 5] Train acc: 0.999, loss: 0.003 | Test acc: 0.982, loss: 0.067 | Time: 7.00s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.983, loss: 0.063 | Time: 6.76s
[Epoch 7] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.060 | Time: 6.84s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.060 | Time: 6.79s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.060 | Time: 6.86s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.060 | Time: 6.99s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.060 | Time: 6.90s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.061 | Time: 6.96s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.063 | Time: 6.79s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.063 | Time: 6.78s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.064 | Time: 6.75s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.063 | Time: 6.81s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.063 | Time: 6.86s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.063 | Time: 6.86s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.064 | Time: 6.84s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.064 | Time: 6.89s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.064 | Time: 6.85s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.064 | Time: 6.96s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.064 | Time: 6.81s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.064 | Time: 6.79s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.064 | Time: 6.87s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.064 | Time: 7.01s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.064 | Time: 7.06s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 6.99s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.064 | Time: 7.00s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.064 | Time: 7.01s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.065 | Time: 6.98s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.065 | Time: 6.91s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 6.95s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 7.01s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 7.22s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.067 | Time: 6.99s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.067 | Time: 6.98s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.067 | Time: 7.04s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.067 | Time: 7.07s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.067 | Time: 7.08s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 7.07s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 6.95s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 7.16s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 7.06s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 7.11s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 7.07s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 7.08s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 6.89s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 7.08s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.066 | Time: 7.12s
Total training time: 427.83s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed6_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.963, loss: 0.129 | Test acc: 0.956, loss: 0.138 | Time: 20.64s
[Epoch 2] Train acc: 0.983, loss: 0.053 | Test acc: 0.978, loss: 0.074 | Time: 7.48s
[Epoch 3] Train acc: 0.982, loss: 0.063 | Test acc: 0.974, loss: 0.097 | Time: 7.79s
[Epoch 4] Train acc: 0.973, loss: 0.104 | Test acc: 0.962, loss: 0.158 | Time: 7.72s
[Epoch 5] Train acc: 0.983, loss: 0.053 | Test acc: 0.974, loss: 0.099 | Time: 7.95s
[Epoch 6] Train acc: 0.990, loss: 0.036 | Test acc: 0.979, loss: 0.092 | Time: 7.75s
[Epoch 7] Train acc: 0.992, loss: 0.027 | Test acc: 0.981, loss: 0.082 | Time: 7.96s
[Epoch 8] Train acc: 0.995, loss: 0.019 | Test acc: 0.983, loss: 0.073 | Time: 7.89s
[Epoch 9] Train acc: 0.996, loss: 0.013 | Test acc: 0.986, loss: 0.060 | Time: 7.87s
[Epoch 10] Train acc: 0.972, loss: 0.131 | Test acc: 0.964, loss: 0.175 | Time: 7.93s
[Epoch 11] Train acc: 0.993, loss: 0.025 | Test acc: 0.980, loss: 0.086 | Time: 7.94s
[Epoch 12] Train acc: 0.994, loss: 0.023 | Test acc: 0.982, loss: 0.071 | Time: 7.93s
[Epoch 13] Train acc: 0.996, loss: 0.012 | Test acc: 0.983, loss: 0.081 | Time: 7.96s
[Epoch 14] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.057 | Time: 7.93s
[Epoch 15] Train acc: 0.995, loss: 0.020 | Test acc: 0.984, loss: 0.086 | Time: 7.97s
[Epoch 16] Train acc: 0.995, loss: 0.020 | Test acc: 0.984, loss: 0.086 | Time: 7.95s
[Epoch 17] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.072 | Time: 7.97s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.067 | Time: 7.98s
[Epoch 19] Train acc: 0.997, loss: 0.012 | Test acc: 0.984, loss: 0.067 | Time: 7.93s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.070 | Time: 8.10s
[Epoch 21] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.069 | Time: 7.92s
[Epoch 22] Train acc: 0.998, loss: 0.006 | Test acc: 0.984, loss: 0.069 | Time: 8.05s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.060 | Time: 8.08s
[Epoch 24] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.067 | Time: 8.02s
[Epoch 25] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.058 | Time: 7.95s
[Epoch 26] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.058 | Time: 7.97s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.068 | Time: 7.93s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.048 | Time: 8.27s
[Epoch 29] Train acc: 0.999, loss: 0.007 | Test acc: 0.988, loss: 0.070 | Time: 8.38s
[Epoch 30] Train acc: 0.998, loss: 0.009 | Test acc: 0.984, loss: 0.088 | Time: 8.37s
[Epoch 31] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.076 | Time: 8.35s
[Epoch 32] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.055 | Time: 8.41s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.988, loss: 0.062 | Time: 8.55s
[Epoch 34] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.066 | Time: 8.39s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.069 | Time: 8.43s
[Epoch 36] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.082 | Time: 8.56s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.061 | Time: 8.52s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.988, loss: 0.070 | Time: 8.12s
[Epoch 39] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.074 | Time: 8.02s
[Epoch 40] Train acc: 0.998, loss: 0.007 | Test acc: 0.985, loss: 0.075 | Time: 7.98s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.070 | Time: 7.93s
[Epoch 42] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.073 | Time: 8.06s
[Epoch 43] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.057 | Time: 7.97s
[Epoch 44] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.065 | Time: 8.02s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.061 | Time: 8.06s
[Epoch 46] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.077 | Time: 8.00s
[Epoch 47] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.102 | Time: 8.06s
[Epoch 48] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.086 | Time: 8.00s
[Epoch 49] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.072 | Time: 8.00s
[Epoch 50] Train acc: 0.997, loss: 0.018 | Test acc: 0.985, loss: 0.113 | Time: 8.14s
Total training time: 483.79s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed6_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.966, loss: 0.115 | Test acc: 0.959, loss: 0.137 | Time: 21.18s
[Epoch 2] Train acc: 0.977, loss: 0.073 | Test acc: 0.971, loss: 0.102 | Time: 7.18s
[Epoch 3] Train acc: 0.985, loss: 0.049 | Test acc: 0.977, loss: 0.084 | Time: 7.87s
[Epoch 4] Train acc: 0.986, loss: 0.048 | Test acc: 0.976, loss: 0.088 | Time: 7.44s
[Epoch 5] Train acc: 0.990, loss: 0.032 | Test acc: 0.981, loss: 0.074 | Time: 7.68s
[Epoch 6] Train acc: 0.990, loss: 0.033 | Test acc: 0.982, loss: 0.083 | Time: 7.78s
[Epoch 7] Train acc: 0.994, loss: 0.022 | Test acc: 0.983, loss: 0.073 | Time: 7.77s
[Epoch 8] Train acc: 0.987, loss: 0.049 | Test acc: 0.977, loss: 0.109 | Time: 7.69s
[Epoch 9] Train acc: 0.996, loss: 0.013 | Test acc: 0.985, loss: 0.062 | Time: 7.63s
[Epoch 10] Train acc: 0.991, loss: 0.030 | Test acc: 0.981, loss: 0.077 | Time: 7.72s
[Epoch 11] Train acc: 0.995, loss: 0.017 | Test acc: 0.984, loss: 0.060 | Time: 7.80s
[Epoch 12] Train acc: 0.995, loss: 0.019 | Test acc: 0.984, loss: 0.080 | Time: 7.72s
[Epoch 13] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.053 | Time: 7.56s
[Epoch 14] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.052 | Time: 7.73s
[Epoch 15] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.057 | Time: 7.69s
[Epoch 16] Train acc: 0.997, loss: 0.009 | Test acc: 0.988, loss: 0.058 | Time: 7.59s
[Epoch 17] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.059 | Time: 7.71s
[Epoch 18] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.072 | Time: 7.63s
[Epoch 19] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.071 | Time: 7.57s
[Epoch 20] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.067 | Time: 7.53s
[Epoch 21] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.064 | Time: 7.61s
[Epoch 22] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.061 | Time: 7.76s
[Epoch 23] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.057 | Time: 7.68s
[Epoch 24] Train acc: 0.996, loss: 0.030 | Test acc: 0.985, loss: 0.085 | Time: 7.75s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.066 | Time: 7.76s
[Epoch 26] Train acc: 0.996, loss: 0.012 | Test acc: 0.987, loss: 0.060 | Time: 7.66s
[Epoch 27] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.058 | Time: 7.80s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.053 | Time: 7.64s
[Epoch 29] Train acc: 0.993, loss: 0.065 | Test acc: 0.982, loss: 0.148 | Time: 7.68s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.066 | Time: 7.73s
[Epoch 31] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.077 | Time: 7.64s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.065 | Time: 7.71s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.063 | Time: 7.70s
[Epoch 34] Train acc: 0.999, loss: 0.006 | Test acc: 0.990, loss: 0.066 | Time: 7.71s
[Epoch 35] Train acc: 0.998, loss: 0.009 | Test acc: 0.988, loss: 0.059 | Time: 7.66s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.056 | Time: 7.60s
[Epoch 37] Train acc: 0.999, loss: 0.001 | Test acc: 0.991, loss: 0.053 | Time: 8.63s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.062 | Time: 8.58s
[Epoch 39] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.079 | Time: 8.60s
[Epoch 40] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.070 | Time: 8.46s
[Epoch 41] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.075 | Time: 8.43s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.068 | Time: 8.44s
[Epoch 43] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.074 | Time: 8.44s
[Epoch 44] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.081 | Time: 8.61s
[Epoch 45] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.068 | Time: 8.44s
[Epoch 46] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.067 | Time: 8.46s
[Epoch 47] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.068 | Time: 8.47s
[Epoch 48] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.069 | Time: 8.44s
[Epoch 49] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.056 | Time: 8.47s
[Epoch 50] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.067 | Time: 8.56s
Total training time: 487.18s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed6_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/Adam.learning_rate = 0.0003
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/FullES.recompute_samples = 100
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/GradientAccumulator.num_average = 20
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/HyperV2.param_inits = 256
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.lopt = @HyperV2()
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.num_estimators = 8
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.num_steps = 100000
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.staleness = 500
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.summary_every_n = 25
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/run_train.trainer_batch_size = 512
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__8a1ebc31_1b0c_4f91_9b01_21c6229b3cf3/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.976, loss: 0.075 | Test acc: 0.968, loss: 0.099 | Time: 347.43s
[Epoch 2] Train acc: 0.987, loss: 0.042 | Test acc: 0.975, loss: 0.078 | Time: 72.80s
[Epoch 3] Train acc: 0.991, loss: 0.029 | Test acc: 0.979, loss: 0.068 | Time: 82.24s
[Epoch 4] Train acc: 0.994, loss: 0.019 | Test acc: 0.981, loss: 0.073 | Time: 83.56s
[Epoch 5] Train acc: 0.995, loss: 0.016 | Test acc: 0.984, loss: 0.066 | Time: 72.19s
[Epoch 6] Train acc: 0.994, loss: 0.016 | Test acc: 0.983, loss: 0.067 | Time: 83.55s
[Epoch 7] Train acc: 0.996, loss: 0.011 | Test acc: 0.986, loss: 0.062 | Time: 73.66s
[Epoch 8] Train acc: 0.997, loss: 0.011 | Test acc: 0.983, loss: 0.066 | Time: 79.23s
[Epoch 9] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.057 | Time: 77.41s
[Epoch 10] Train acc: 0.997, loss: 0.008 | Test acc: 0.985, loss: 0.061 | Time: 83.60s
[Epoch 11] Train acc: 0.998, loss: 0.006 | Test acc: 0.985, loss: 0.068 | Time: 82.35s
[Epoch 12] Train acc: 0.997, loss: 0.008 | Test acc: 0.985, loss: 0.063 | Time: 69.53s
[Epoch 13] Train acc: 0.998, loss: 0.007 | Test acc: 0.984, loss: 0.071 | Time: 76.32s
[Epoch 14] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.071 | Time: 83.68s
[Epoch 15] Train acc: 0.998, loss: 0.007 | Test acc: 0.984, loss: 0.067 | Time: 83.95s
[Epoch 16] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.058 | Time: 83.72s
[Epoch 17] Train acc: 0.998, loss: 0.005 | Test acc: 0.986, loss: 0.070 | Time: 74.52s
[Epoch 18] Train acc: 0.998, loss: 0.006 | Test acc: 0.985, loss: 0.067 | Time: 71.21s
[Epoch 19] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.063 | Time: 83.60s
[Epoch 20] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.062 | Time: 83.90s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.074 | Time: 70.57s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.064 | Time: 83.64s
[Epoch 23] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.076 | Time: 82.02s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.064 | Time: 69.18s
[Epoch 25] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.063 | Time: 80.01s
[Epoch 26] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.075 | Time: 83.98s
[Epoch 27] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.070 | Time: 83.51s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.071 | Time: 76.66s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.061 | Time: 71.60s
[Epoch 30] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.061 | Time: 83.49s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.055 | Time: 78.06s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.058 | Time: 71.03s
[Epoch 33] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.071 | Time: 83.31s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.986, loss: 0.072 | Time: 83.75s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.059 | Time: 84.32s
[Epoch 36] Train acc: 0.999, loss: 0.001 | Test acc: 0.989, loss: 0.068 | Time: 71.00s
[Epoch 37] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.059 | Time: 83.43s
[Epoch 38] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.064 | Time: 83.92s
[Epoch 39] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.084 | Time: 72.05s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.061 | Time: 84.62s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.066 | Time: 83.52s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.069 | Time: 81.34s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.070 | Time: 68.49s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.075 | Time: 82.29s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.072 | Time: 74.01s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.073 | Time: 84.02s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.073 | Time: 68.47s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.071 | Time: 79.15s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.070 | Time: 83.51s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.070 | Time: 83.22s
Total training time: 4286.09s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed7_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.891, loss: 0.364 | Test acc: 0.877, loss: 0.397 | Time: 15.24s
[Epoch 2] Train acc: 0.951, loss: 0.170 | Test acc: 0.931, loss: 0.225 | Time: 5.34s
[Epoch 3] Train acc: 0.972, loss: 0.102 | Test acc: 0.950, loss: 0.167 | Time: 5.63s
[Epoch 4] Train acc: 0.983, loss: 0.066 | Test acc: 0.955, loss: 0.144 | Time: 5.48s
[Epoch 5] Train acc: 0.989, loss: 0.045 | Test acc: 0.961, loss: 0.133 | Time: 5.66s
[Epoch 6] Train acc: 0.994, loss: 0.030 | Test acc: 0.962, loss: 0.126 | Time: 5.65s
[Epoch 7] Train acc: 0.997, loss: 0.020 | Test acc: 0.964, loss: 0.123 | Time: 5.82s
[Epoch 8] Train acc: 0.998, loss: 0.014 | Test acc: 0.965, loss: 0.122 | Time: 5.67s
[Epoch 9] Train acc: 0.999, loss: 0.010 | Test acc: 0.966, loss: 0.120 | Time: 5.84s
[Epoch 10] Train acc: 1.000, loss: 0.007 | Test acc: 0.966, loss: 0.120 | Time: 5.72s
[Epoch 11] Train acc: 1.000, loss: 0.005 | Test acc: 0.967, loss: 0.119 | Time: 5.79s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.967, loss: 0.121 | Time: 5.79s
[Epoch 13] Train acc: 1.000, loss: 0.004 | Test acc: 0.968, loss: 0.122 | Time: 5.77s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.967, loss: 0.124 | Time: 5.78s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.968, loss: 0.125 | Time: 5.78s
[Epoch 16] Train acc: 1.000, loss: 0.002 | Test acc: 0.967, loss: 0.125 | Time: 5.84s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.967, loss: 0.126 | Time: 5.78s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.967, loss: 0.127 | Time: 5.79s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.968, loss: 0.126 | Time: 5.84s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.967, loss: 0.127 | Time: 5.75s
[Epoch 21] Train acc: 1.000, loss: 0.002 | Test acc: 0.967, loss: 0.126 | Time: 5.77s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.128 | Time: 5.78s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.967, loss: 0.128 | Time: 5.76s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.127 | Time: 5.80s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.127 | Time: 5.83s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.127 | Time: 5.77s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.127 | Time: 5.84s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.129 | Time: 5.78s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.128 | Time: 5.78s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.130 | Time: 5.81s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.129 | Time: 5.80s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.130 | Time: 5.87s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.131 | Time: 5.82s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.131 | Time: 5.87s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.130 | Time: 5.77s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.131 | Time: 5.84s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.130 | Time: 5.85s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.130 | Time: 5.82s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.130 | Time: 5.86s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.131 | Time: 5.85s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.129 | Time: 5.85s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.129 | Time: 5.87s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.130 | Time: 5.84s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.130 | Time: 5.85s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.131 | Time: 5.83s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.131 | Time: 5.93s
[Epoch 47] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.132 | Time: 5.83s
[Epoch 48] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.131 | Time: 5.93s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.970, loss: 0.131 | Time: 5.93s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.970, loss: 0.132 | Time: 5.94s
Total training time: 368.97s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed7_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.974, loss: 0.084 | Test acc: 0.961, loss: 0.126 | Time: 16.45s
[Epoch 2] Train acc: 0.991, loss: 0.029 | Test acc: 0.972, loss: 0.087 | Time: 6.27s
[Epoch 3] Train acc: 0.996, loss: 0.013 | Test acc: 0.979, loss: 0.079 | Time: 6.69s
[Epoch 4] Train acc: 0.998, loss: 0.008 | Test acc: 0.977, loss: 0.089 | Time: 6.42s
[Epoch 5] Train acc: 0.999, loss: 0.002 | Test acc: 0.980, loss: 0.075 | Time: 6.75s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.981, loss: 0.074 | Time: 6.61s
[Epoch 7] Train acc: 1.000, loss: 0.001 | Test acc: 0.982, loss: 0.073 | Time: 6.68s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.070 | Time: 6.70s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.069 | Time: 6.74s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.069 | Time: 6.72s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.070 | Time: 6.65s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.070 | Time: 6.58s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.071 | Time: 6.60s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.071 | Time: 6.59s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.61s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.071 | Time: 6.70s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.66s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.58s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.071 | Time: 6.62s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.072 | Time: 6.59s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.64s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.073 | Time: 6.57s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.61s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.58s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.61s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.59s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.70s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.68s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.63s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.69s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.073 | Time: 6.73s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.64s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.57s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.074 | Time: 6.58s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.68s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.075 | Time: 6.63s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.62s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.075 | Time: 6.62s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.982, loss: 0.075 | Time: 6.69s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.075 | Time: 6.60s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.074 | Time: 6.73s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 6.70s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 6.65s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 6.65s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.075 | Time: 6.62s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.075 | Time: 6.70s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.075 | Time: 6.64s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.075 | Time: 6.66s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.983, loss: 0.075 | Time: 6.64s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.984, loss: 0.074 | Time: 6.58s
Total training time: 410.50s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed7_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.961, loss: 0.126 | Test acc: 0.958, loss: 0.143 | Time: 19.49s
[Epoch 2] Train acc: 0.973, loss: 0.091 | Test acc: 0.967, loss: 0.121 | Time: 7.02s
[Epoch 3] Train acc: 0.980, loss: 0.071 | Test acc: 0.977, loss: 0.091 | Time: 7.58s
[Epoch 4] Train acc: 0.986, loss: 0.048 | Test acc: 0.980, loss: 0.084 | Time: 7.31s
[Epoch 5] Train acc: 0.986, loss: 0.046 | Test acc: 0.977, loss: 0.086 | Time: 7.60s
[Epoch 6] Train acc: 0.986, loss: 0.067 | Test acc: 0.978, loss: 0.106 | Time: 7.45s
[Epoch 7] Train acc: 0.992, loss: 0.029 | Test acc: 0.982, loss: 0.073 | Time: 7.55s
[Epoch 8] Train acc: 0.994, loss: 0.023 | Test acc: 0.986, loss: 0.070 | Time: 7.59s
[Epoch 9] Train acc: 0.996, loss: 0.012 | Test acc: 0.988, loss: 0.054 | Time: 7.57s
[Epoch 10] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.053 | Time: 7.54s
[Epoch 11] Train acc: 0.991, loss: 0.030 | Test acc: 0.982, loss: 0.076 | Time: 7.65s
[Epoch 12] Train acc: 0.996, loss: 0.018 | Test acc: 0.986, loss: 0.079 | Time: 7.55s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.052 | Time: 7.47s
[Epoch 14] Train acc: 0.997, loss: 0.009 | Test acc: 0.988, loss: 0.062 | Time: 7.44s
[Epoch 15] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.062 | Time: 7.49s
[Epoch 16] Train acc: 0.993, loss: 0.030 | Test acc: 0.984, loss: 0.082 | Time: 7.45s
[Epoch 17] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.049 | Time: 7.49s
[Epoch 18] Train acc: 0.992, loss: 0.027 | Test acc: 0.982, loss: 0.094 | Time: 7.50s
[Epoch 19] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.063 | Time: 7.47s
[Epoch 20] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.065 | Time: 7.50s
[Epoch 21] Train acc: 0.989, loss: 0.050 | Test acc: 0.979, loss: 0.120 | Time: 7.50s
[Epoch 22] Train acc: 0.997, loss: 0.011 | Test acc: 0.986, loss: 0.081 | Time: 7.58s
[Epoch 23] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.049 | Time: 7.50s
[Epoch 24] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.067 | Time: 7.52s
[Epoch 25] Train acc: 0.997, loss: 0.015 | Test acc: 0.986, loss: 0.081 | Time: 7.50s
[Epoch 26] Train acc: 0.999, loss: 0.006 | Test acc: 0.989, loss: 0.075 | Time: 7.52s
[Epoch 27] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.046 | Time: 7.45s
[Epoch 28] Train acc: 0.997, loss: 0.011 | Test acc: 0.988, loss: 0.062 | Time: 7.53s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.053 | Time: 7.47s
[Epoch 30] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.064 | Time: 7.53s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.055 | Time: 7.46s
[Epoch 32] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.064 | Time: 7.53s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.066 | Time: 7.52s
[Epoch 34] Train acc: 0.998, loss: 0.009 | Test acc: 0.987, loss: 0.079 | Time: 7.60s
[Epoch 35] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.063 | Time: 7.61s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.069 | Time: 7.84s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.065 | Time: 7.87s
[Epoch 38] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.073 | Time: 7.89s
[Epoch 39] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.058 | Time: 7.89s
[Epoch 40] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.062 | Time: 7.85s
[Epoch 41] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.054 | Time: 8.02s
[Epoch 42] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.091 | Time: 7.97s
[Epoch 43] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.060 | Time: 8.01s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.051 | Time: 7.88s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.059 | Time: 7.86s
[Epoch 46] Train acc: 0.998, loss: 0.010 | Test acc: 0.987, loss: 0.074 | Time: 7.86s
[Epoch 47] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.066 | Time: 7.59s
[Epoch 48] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.053 | Time: 7.60s
[Epoch 49] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.063 | Time: 7.76s
[Epoch 50] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.078 | Time: 7.68s
Total training time: 459.60s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed7_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.974, loss: 0.084 | Test acc: 0.968, loss: 0.103 | Time: 23.66s
[Epoch 2] Train acc: 0.980, loss: 0.067 | Test acc: 0.974, loss: 0.089 | Time: 7.61s
[Epoch 3] Train acc: 0.975, loss: 0.086 | Test acc: 0.964, loss: 0.139 | Time: 8.37s
[Epoch 4] Train acc: 0.985, loss: 0.047 | Test acc: 0.975, loss: 0.085 | Time: 8.04s
[Epoch 5] Train acc: 0.992, loss: 0.027 | Test acc: 0.983, loss: 0.064 | Time: 8.42s
[Epoch 6] Train acc: 0.992, loss: 0.028 | Test acc: 0.983, loss: 0.073 | Time: 8.34s
[Epoch 7] Train acc: 0.993, loss: 0.025 | Test acc: 0.988, loss: 0.057 | Time: 8.54s
[Epoch 8] Train acc: 0.996, loss: 0.012 | Test acc: 0.988, loss: 0.058 | Time: 8.17s
[Epoch 9] Train acc: 0.994, loss: 0.019 | Test acc: 0.982, loss: 0.080 | Time: 8.37s
[Epoch 10] Train acc: 0.996, loss: 0.013 | Test acc: 0.986, loss: 0.064 | Time: 8.17s
[Epoch 11] Train acc: 0.994, loss: 0.020 | Test acc: 0.987, loss: 0.056 | Time: 8.38s
[Epoch 12] Train acc: 0.997, loss: 0.008 | Test acc: 0.987, loss: 0.055 | Time: 8.30s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.057 | Time: 8.43s
[Epoch 14] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.057 | Time: 8.33s
[Epoch 15] Train acc: 0.996, loss: 0.014 | Test acc: 0.985, loss: 0.083 | Time: 8.51s
[Epoch 16] Train acc: 0.996, loss: 0.016 | Test acc: 0.986, loss: 0.070 | Time: 8.21s
[Epoch 17] Train acc: 0.998, loss: 0.009 | Test acc: 0.988, loss: 0.066 | Time: 8.41s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.068 | Time: 8.25s
[Epoch 19] Train acc: 0.998, loss: 0.010 | Test acc: 0.989, loss: 0.066 | Time: 8.49s
[Epoch 20] Train acc: 0.998, loss: 0.009 | Test acc: 0.986, loss: 0.080 | Time: 8.29s
[Epoch 21] Train acc: 0.996, loss: 0.022 | Test acc: 0.983, loss: 0.099 | Time: 8.52s
[Epoch 22] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.062 | Time: 8.42s
[Epoch 23] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.071 | Time: 8.49s
[Epoch 24] Train acc: 0.997, loss: 0.013 | Test acc: 0.987, loss: 0.069 | Time: 8.49s
[Epoch 25] Train acc: 0.998, loss: 0.009 | Test acc: 0.988, loss: 0.080 | Time: 8.56s
[Epoch 26] Train acc: 0.998, loss: 0.010 | Test acc: 0.987, loss: 0.072 | Time: 8.40s
[Epoch 27] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.068 | Time: 8.58s
[Epoch 28] Train acc: 0.998, loss: 0.008 | Test acc: 0.985, loss: 0.091 | Time: 8.34s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.066 | Time: 8.41s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.068 | Time: 8.39s
[Epoch 31] Train acc: 0.997, loss: 0.014 | Test acc: 0.986, loss: 0.085 | Time: 8.57s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.069 | Time: 8.33s
[Epoch 33] Train acc: 0.997, loss: 0.013 | Test acc: 0.985, loss: 0.101 | Time: 8.42s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.088 | Time: 8.29s
[Epoch 35] Train acc: 0.999, loss: 0.007 | Test acc: 0.987, loss: 0.082 | Time: 8.47s
[Epoch 36] Train acc: 0.999, loss: 0.006 | Test acc: 0.988, loss: 0.080 | Time: 8.31s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.057 | Time: 8.57s
[Epoch 38] Train acc: 0.997, loss: 0.013 | Test acc: 0.984, loss: 0.100 | Time: 8.39s
[Epoch 39] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.075 | Time: 8.48s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.086 | Time: 8.41s
[Epoch 41] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.070 | Time: 8.49s
[Epoch 42] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.071 | Time: 8.39s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.077 | Time: 8.42s
[Epoch 44] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.066 | Time: 8.37s
[Epoch 45] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.084 | Time: 8.44s
[Epoch 46] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.063 | Time: 8.39s
[Epoch 47] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.057 | Time: 8.65s
[Epoch 48] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.065 | Time: 8.49s
[Epoch 49] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.065 | Time: 8.44s
[Epoch 50] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.075 | Time: 8.43s
Total training time: 502.72s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed7_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/Adam.learning_rate = 0.0003
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/FullES.recompute_samples = 100
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/GradientAccumulator.num_average = 20
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/HyperV2.param_inits = 256
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.lopt = @HyperV2()
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.num_estimators = 8
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.num_steps = 100000
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.staleness = 500
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.summary_every_n = 25
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/run_train.trainer_batch_size = 512
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__43ccb288_2091_48e5_b9b5_7a71fbc55074/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.979, loss: 0.071 | Test acc: 0.967, loss: 0.099 | Time: 339.16s
[Epoch 2] Train acc: 0.986, loss: 0.042 | Test acc: 0.976, loss: 0.081 | Time: 83.08s
[Epoch 3] Train acc: 0.992, loss: 0.025 | Test acc: 0.979, loss: 0.067 | Time: 83.04s
[Epoch 4] Train acc: 0.994, loss: 0.019 | Test acc: 0.983, loss: 0.060 | Time: 83.99s
[Epoch 5] Train acc: 0.994, loss: 0.019 | Test acc: 0.982, loss: 0.072 | Time: 83.46s
[Epoch 6] Train acc: 0.997, loss: 0.008 | Test acc: 0.987, loss: 0.051 | Time: 83.95s
[Epoch 7] Train acc: 0.996, loss: 0.013 | Test acc: 0.983, loss: 0.080 | Time: 85.54s
[Epoch 8] Train acc: 0.995, loss: 0.015 | Test acc: 0.982, loss: 0.081 | Time: 83.43s
[Epoch 9] Train acc: 0.996, loss: 0.012 | Test acc: 0.985, loss: 0.072 | Time: 69.62s
[Epoch 10] Train acc: 0.997, loss: 0.012 | Test acc: 0.986, loss: 0.065 | Time: 71.58s
[Epoch 11] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.064 | Time: 77.29s
[Epoch 12] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.059 | Time: 83.64s
[Epoch 13] Train acc: 0.998, loss: 0.005 | Test acc: 0.985, loss: 0.059 | Time: 70.96s
[Epoch 14] Train acc: 0.997, loss: 0.015 | Test acc: 0.985, loss: 0.076 | Time: 82.25s
[Epoch 15] Train acc: 0.996, loss: 0.011 | Test acc: 0.984, loss: 0.072 | Time: 83.45s
[Epoch 16] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.059 | Time: 83.62s
[Epoch 17] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.067 | Time: 71.34s
[Epoch 18] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.067 | Time: 73.68s
[Epoch 19] Train acc: 0.998, loss: 0.010 | Test acc: 0.985, loss: 0.077 | Time: 85.05s
[Epoch 20] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.065 | Time: 78.56s
[Epoch 21] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.060 | Time: 83.65s
[Epoch 22] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.058 | Time: 83.50s
[Epoch 23] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.066 | Time: 83.63s
[Epoch 24] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.065 | Time: 83.73s
[Epoch 25] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.065 | Time: 73.08s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.067 | Time: 80.65s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.055 | Time: 83.65s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.054 | Time: 83.75s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.059 | Time: 78.42s
[Epoch 30] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.061 | Time: 70.52s
[Epoch 31] Train acc: 0.999, loss: 0.005 | Test acc: 0.986, loss: 0.077 | Time: 84.73s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.069 | Time: 83.84s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.050 | Time: 83.58s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.057 | Time: 69.03s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.065 | Time: 79.67s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.070 | Time: 83.73s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.061 | Time: 85.50s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.067 | Time: 78.63s
[Epoch 39] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.059 | Time: 83.38s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.065 | Time: 81.77s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.063 | Time: 69.41s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.063 | Time: 82.98s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.068 | Time: 85.32s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.066 | Time: 79.06s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.066 | Time: 83.52s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.070 | Time: 83.81s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.073 | Time: 83.79s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.073 | Time: 83.62s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.069 | Time: 85.23s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.070 | Time: 71.09s
Total training time: 4352.50s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed8_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.885, loss: 0.389 | Test acc: 0.871, loss: 0.413 | Time: 15.56s
[Epoch 2] Train acc: 0.950, loss: 0.173 | Test acc: 0.935, loss: 0.217 | Time: 5.42s
[Epoch 3] Train acc: 0.971, loss: 0.104 | Test acc: 0.951, loss: 0.162 | Time: 5.60s
[Epoch 4] Train acc: 0.982, loss: 0.067 | Test acc: 0.956, loss: 0.138 | Time: 5.44s
[Epoch 5] Train acc: 0.990, loss: 0.043 | Test acc: 0.962, loss: 0.125 | Time: 5.61s
[Epoch 6] Train acc: 0.996, loss: 0.026 | Test acc: 0.965, loss: 0.115 | Time: 5.66s
[Epoch 7] Train acc: 0.998, loss: 0.017 | Test acc: 0.964, loss: 0.113 | Time: 5.62s
[Epoch 8] Train acc: 0.999, loss: 0.012 | Test acc: 0.967, loss: 0.110 | Time: 5.70s
[Epoch 9] Train acc: 0.999, loss: 0.008 | Test acc: 0.967, loss: 0.110 | Time: 5.59s
[Epoch 10] Train acc: 1.000, loss: 0.006 | Test acc: 0.968, loss: 0.109 | Time: 5.59s
[Epoch 11] Train acc: 1.000, loss: 0.005 | Test acc: 0.968, loss: 0.110 | Time: 5.66s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.969, loss: 0.112 | Time: 5.62s
[Epoch 13] Train acc: 1.000, loss: 0.004 | Test acc: 0.969, loss: 0.113 | Time: 5.59s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.969, loss: 0.114 | Time: 5.57s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.969, loss: 0.114 | Time: 5.66s
[Epoch 16] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.113 | Time: 5.67s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.114 | Time: 5.65s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.113 | Time: 5.62s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.112 | Time: 5.68s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.112 | Time: 5.59s
[Epoch 21] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.112 | Time: 5.59s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.113 | Time: 5.68s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.112 | Time: 5.62s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.112 | Time: 5.66s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.112 | Time: 5.57s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.112 | Time: 5.59s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.112 | Time: 5.68s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.113 | Time: 5.63s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.113 | Time: 5.70s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.113 | Time: 5.62s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.113 | Time: 5.66s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.114 | Time: 5.61s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.114 | Time: 5.61s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.114 | Time: 5.61s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.114 | Time: 5.61s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.115 | Time: 5.65s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.114 | Time: 5.64s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.70s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.115 | Time: 5.75s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.74s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.114 | Time: 5.74s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.114 | Time: 5.69s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.114 | Time: 5.68s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.114 | Time: 5.68s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.69s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.115 | Time: 5.68s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.970, loss: 0.114 | Time: 5.98s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.970, loss: 0.115 | Time: 5.70s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.970, loss: 0.115 | Time: 5.71s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.970, loss: 0.115 | Time: 5.72s
Total training time: 360.68s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed8_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.979, loss: 0.070 | Test acc: 0.967, loss: 0.106 | Time: 16.68s
[Epoch 2] Train acc: 0.989, loss: 0.036 | Test acc: 0.971, loss: 0.084 | Time: 6.21s
[Epoch 3] Train acc: 0.996, loss: 0.014 | Test acc: 0.979, loss: 0.071 | Time: 6.54s
[Epoch 4] Train acc: 0.998, loss: 0.008 | Test acc: 0.982, loss: 0.074 | Time: 6.24s
[Epoch 5] Train acc: 0.999, loss: 0.003 | Test acc: 0.984, loss: 0.068 | Time: 6.53s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.985, loss: 0.067 | Time: 6.34s
[Epoch 7] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.061 | Time: 6.47s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.061 | Time: 6.30s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.060 | Time: 6.58s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.060 | Time: 6.40s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.060 | Time: 6.44s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.061 | Time: 6.36s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 6.40s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 6.35s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 6.42s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 6.43s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 6.38s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 6.40s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 6.40s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.063 | Time: 6.35s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.063 | Time: 6.38s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.063 | Time: 6.36s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.063 | Time: 6.42s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.063 | Time: 6.35s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.064 | Time: 6.41s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.064 | Time: 6.42s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.064 | Time: 6.45s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 6.41s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.064 | Time: 6.45s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 6.44s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 6.44s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 6.39s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.51s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 6.42s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.46s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.45s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.50s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.43s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.53s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.45s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.60s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.47s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.49s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 6.59s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 6.59s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 6.56s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 6.52s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 6.51s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 6.53s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.065 | Time: 6.55s
Total training time: 400.03s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed8_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.966, loss: 0.114 | Test acc: 0.958, loss: 0.136 | Time: 19.89s
[Epoch 2] Train acc: 0.982, loss: 0.056 | Test acc: 0.976, loss: 0.079 | Time: 6.90s
[Epoch 3] Train acc: 0.984, loss: 0.053 | Test acc: 0.974, loss: 0.091 | Time: 7.54s
[Epoch 4] Train acc: 0.985, loss: 0.050 | Test acc: 0.976, loss: 0.082 | Time: 7.20s
[Epoch 5] Train acc: 0.985, loss: 0.053 | Test acc: 0.975, loss: 0.095 | Time: 7.58s
[Epoch 6] Train acc: 0.994, loss: 0.019 | Test acc: 0.986, loss: 0.053 | Time: 7.22s
[Epoch 7] Train acc: 0.952, loss: 1.211 | Test acc: 0.938, loss: 1.335 | Time: 7.41s
[Epoch 8] Train acc: 0.995, loss: 0.017 | Test acc: 0.984, loss: 0.059 | Time: 7.37s
[Epoch 9] Train acc: 0.994, loss: 0.021 | Test acc: 0.984, loss: 0.072 | Time: 7.43s
[Epoch 10] Train acc: 0.994, loss: 0.027 | Test acc: 0.985, loss: 0.080 | Time: 7.34s
[Epoch 11] Train acc: 0.993, loss: 0.022 | Test acc: 0.982, loss: 0.081 | Time: 7.51s
[Epoch 12] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.058 | Time: 7.46s
[Epoch 13] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.045 | Time: 7.50s
[Epoch 14] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.062 | Time: 7.34s
[Epoch 15] Train acc: 0.993, loss: 0.024 | Test acc: 0.985, loss: 0.076 | Time: 7.46s
[Epoch 16] Train acc: 0.996, loss: 0.012 | Test acc: 0.985, loss: 0.079 | Time: 7.39s
[Epoch 17] Train acc: 0.996, loss: 0.015 | Test acc: 0.984, loss: 0.074 | Time: 7.49s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.054 | Time: 7.39s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.068 | Time: 7.60s
[Epoch 20] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.072 | Time: 7.55s
[Epoch 21] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.072 | Time: 8.71s
[Epoch 22] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.054 | Time: 8.65s
[Epoch 23] Train acc: 0.996, loss: 0.014 | Test acc: 0.984, loss: 0.089 | Time: 8.66s
[Epoch 24] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.061 | Time: 8.61s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.066 | Time: 8.62s
[Epoch 26] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.072 | Time: 8.31s
[Epoch 27] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.061 | Time: 8.32s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.066 | Time: 8.66s
[Epoch 29] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.066 | Time: 8.76s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.069 | Time: 8.46s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.074 | Time: 8.46s
[Epoch 32] Train acc: 0.998, loss: 0.010 | Test acc: 0.987, loss: 0.090 | Time: 8.43s
[Epoch 33] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.078 | Time: 8.29s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.068 | Time: 8.45s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.081 | Time: 8.40s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.064 | Time: 8.32s
[Epoch 37] Train acc: 0.999, loss: 0.007 | Test acc: 0.989, loss: 0.081 | Time: 8.35s
[Epoch 38] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.062 | Time: 8.48s
[Epoch 39] Train acc: 0.999, loss: 0.004 | Test acc: 0.986, loss: 0.078 | Time: 8.48s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.063 | Time: 8.42s
[Epoch 41] Train acc: 0.999, loss: 0.001 | Test acc: 0.989, loss: 0.072 | Time: 8.39s
[Epoch 42] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.085 | Time: 8.33s
[Epoch 43] Train acc: 0.990, loss: 0.059 | Test acc: 0.979, loss: 0.137 | Time: 8.41s
[Epoch 44] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.058 | Time: 8.40s
[Epoch 45] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.064 | Time: 8.37s
[Epoch 46] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.074 | Time: 8.34s
[Epoch 47] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.069 | Time: 8.39s
[Epoch 48] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.062 | Time: 8.38s
[Epoch 49] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.069 | Time: 8.60s
[Epoch 50] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.070 | Time: 8.41s
Total training time: 485.51s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed8_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.962, loss: 0.123 | Test acc: 0.955, loss: 0.144 | Time: 21.41s
[Epoch 2] Train acc: 0.981, loss: 0.060 | Test acc: 0.975, loss: 0.083 | Time: 7.71s
[Epoch 3] Train acc: 0.987, loss: 0.041 | Test acc: 0.981, loss: 0.071 | Time: 8.20s
[Epoch 4] Train acc: 0.974, loss: 0.095 | Test acc: 0.964, loss: 0.140 | Time: 7.96s
[Epoch 5] Train acc: 0.992, loss: 0.027 | Test acc: 0.984, loss: 0.066 | Time: 8.38s
[Epoch 6] Train acc: 0.994, loss: 0.020 | Test acc: 0.987, loss: 0.058 | Time: 8.15s
[Epoch 7] Train acc: 0.987, loss: 0.042 | Test acc: 0.975, loss: 0.100 | Time: 8.29s
[Epoch 8] Train acc: 0.995, loss: 0.017 | Test acc: 0.985, loss: 0.063 | Time: 8.05s
[Epoch 9] Train acc: 0.993, loss: 0.021 | Test acc: 0.983, loss: 0.070 | Time: 8.32s
[Epoch 10] Train acc: 0.993, loss: 0.023 | Test acc: 0.984, loss: 0.077 | Time: 8.11s
[Epoch 11] Train acc: 0.996, loss: 0.014 | Test acc: 0.986, loss: 0.068 | Time: 8.17s
[Epoch 12] Train acc: 0.992, loss: 0.035 | Test acc: 0.981, loss: 0.093 | Time: 8.07s
[Epoch 13] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.063 | Time: 8.17s
[Epoch 14] Train acc: 0.996, loss: 0.012 | Test acc: 0.985, loss: 0.066 | Time: 8.05s
[Epoch 15] Train acc: 0.996, loss: 0.014 | Test acc: 0.985, loss: 0.077 | Time: 8.15s
[Epoch 16] Train acc: 0.990, loss: 0.043 | Test acc: 0.978, loss: 0.119 | Time: 8.06s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.073 | Time: 8.16s
[Epoch 18] Train acc: 0.994, loss: 0.023 | Test acc: 0.984, loss: 0.083 | Time: 8.03s
[Epoch 19] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.072 | Time: 8.20s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.078 | Time: 8.13s
[Epoch 21] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.053 | Time: 8.32s
[Epoch 22] Train acc: 0.997, loss: 0.009 | Test acc: 0.986, loss: 0.084 | Time: 8.31s
[Epoch 23] Train acc: 0.998, loss: 0.008 | Test acc: 0.984, loss: 0.098 | Time: 8.65s
[Epoch 24] Train acc: 0.995, loss: 0.022 | Test acc: 0.985, loss: 0.082 | Time: 8.57s
[Epoch 25] Train acc: 0.997, loss: 0.012 | Test acc: 0.986, loss: 0.077 | Time: 8.66s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.055 | Time: 8.65s
[Epoch 27] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.066 | Time: 8.70s
[Epoch 28] Train acc: 0.996, loss: 0.014 | Test acc: 0.985, loss: 0.072 | Time: 8.55s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.053 | Time: 8.63s
[Epoch 30] Train acc: 0.996, loss: 0.014 | Test acc: 0.984, loss: 0.078 | Time: 8.53s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.060 | Time: 8.57s
[Epoch 32] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.084 | Time: 8.47s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.072 | Time: 8.63s
[Epoch 34] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.079 | Time: 8.52s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.062 | Time: 8.65s
[Epoch 36] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.070 | Time: 8.60s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.058 | Time: 8.54s
[Epoch 38] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.073 | Time: 8.49s
[Epoch 39] Train acc: 0.999, loss: 0.006 | Test acc: 0.988, loss: 0.080 | Time: 8.35s
[Epoch 40] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.074 | Time: 8.22s
[Epoch 41] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.048 | Time: 8.21s
[Epoch 42] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.054 | Time: 8.34s
[Epoch 43] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.063 | Time: 8.30s
[Epoch 44] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.066 | Time: 8.29s
[Epoch 45] Train acc: 0.999, loss: 0.007 | Test acc: 0.989, loss: 0.068 | Time: 8.35s
[Epoch 46] Train acc: 0.997, loss: 0.016 | Test acc: 0.984, loss: 0.106 | Time: 8.21s
[Epoch 47] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.063 | Time: 8.27s
[Epoch 48] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.075 | Time: 8.28s
[Epoch 49] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.060 | Time: 8.41s
[Epoch 50] Train acc: 0.998, loss: 0.010 | Test acc: 0.986, loss: 0.077 | Time: 8.28s
Total training time: 499.23s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed8_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/Adam.learning_rate = 0.0003
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/FullES.recompute_samples = 100
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/GradientAccumulator.num_average = 20
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/HyperV2.param_inits = 256
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.lopt = @HyperV2()
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.num_estimators = 8
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.num_steps = 100000
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.staleness = 500
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.summary_every_n = 25
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/run_train.trainer_batch_size = 512
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__693bcc22_eaaf_4d82_b9df_eab1e186e9cd/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.977, loss: 0.071 | Test acc: 0.966, loss: 0.101 | Time: 346.32s
[Epoch 2] Train acc: 0.986, loss: 0.044 | Test acc: 0.975, loss: 0.084 | Time: 83.47s
[Epoch 3] Train acc: 0.988, loss: 0.036 | Test acc: 0.976, loss: 0.081 | Time: 70.01s
[Epoch 4] Train acc: 0.989, loss: 0.037 | Test acc: 0.980, loss: 0.086 | Time: 82.16s
[Epoch 5] Train acc: 0.994, loss: 0.019 | Test acc: 0.983, loss: 0.067 | Time: 82.38s
[Epoch 6] Train acc: 0.995, loss: 0.016 | Test acc: 0.983, loss: 0.070 | Time: 80.33s
[Epoch 7] Train acc: 0.996, loss: 0.013 | Test acc: 0.985, loss: 0.062 | Time: 70.77s
[Epoch 8] Train acc: 0.997, loss: 0.008 | Test acc: 0.985, loss: 0.064 | Time: 83.69s
[Epoch 9] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.061 | Time: 83.72s
[Epoch 10] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.057 | Time: 83.83s
[Epoch 11] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.069 | Time: 71.37s
[Epoch 12] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.060 | Time: 83.23s
[Epoch 13] Train acc: 0.997, loss: 0.011 | Test acc: 0.985, loss: 0.072 | Time: 84.31s
[Epoch 14] Train acc: 0.996, loss: 0.011 | Test acc: 0.984, loss: 0.074 | Time: 83.35s
[Epoch 15] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.063 | Time: 83.89s
[Epoch 16] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.064 | Time: 83.63s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.058 | Time: 78.19s
[Epoch 18] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.070 | Time: 73.44s
[Epoch 19] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.071 | Time: 83.25s
[Epoch 20] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.061 | Time: 85.69s
[Epoch 21] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.075 | Time: 83.04s
[Epoch 22] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.061 | Time: 68.73s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.061 | Time: 83.66s
[Epoch 24] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.063 | Time: 83.00s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.055 | Time: 68.74s
[Epoch 26] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.055 | Time: 84.36s
[Epoch 27] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.061 | Time: 83.37s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.069 | Time: 80.85s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.062 | Time: 70.39s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.060 | Time: 83.14s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.059 | Time: 84.01s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.064 | Time: 72.35s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.062 | Time: 80.45s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.063 | Time: 83.38s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.068 | Time: 83.07s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.064 | Time: 79.98s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.071 | Time: 80.09s
[Epoch 38] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.063 | Time: 78.50s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.064 | Time: 79.30s
[Epoch 40] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.072 | Time: 78.36s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.064 | Time: 82.56s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.065 | Time: 75.71s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.063 | Time: 82.27s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.075 | Time: 77.29s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.073 | Time: 79.86s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.072 | Time: 80.39s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.073 | Time: 78.23s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.075 | Time: 76.10s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.077 | Time: 83.18s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.077 | Time: 83.27s
Total training time: 4334.29s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed9_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.876, loss: 0.419 | Test acc: 0.865, loss: 0.442 | Time: 15.09s
[Epoch 2] Train acc: 0.949, loss: 0.178 | Test acc: 0.932, loss: 0.225 | Time: 5.47s
[Epoch 3] Train acc: 0.971, loss: 0.106 | Test acc: 0.950, loss: 0.163 | Time: 5.67s
[Epoch 4] Train acc: 0.982, loss: 0.069 | Test acc: 0.957, loss: 0.136 | Time: 5.68s
[Epoch 5] Train acc: 0.988, loss: 0.046 | Test acc: 0.961, loss: 0.122 | Time: 5.68s
[Epoch 6] Train acc: 0.994, loss: 0.031 | Test acc: 0.965, loss: 0.116 | Time: 5.71s
[Epoch 7] Train acc: 0.997, loss: 0.020 | Test acc: 0.967, loss: 0.111 | Time: 5.71s
[Epoch 8] Train acc: 0.999, loss: 0.013 | Test acc: 0.968, loss: 0.109 | Time: 5.74s
[Epoch 9] Train acc: 0.999, loss: 0.009 | Test acc: 0.968, loss: 0.107 | Time: 5.82s
[Epoch 10] Train acc: 1.000, loss: 0.006 | Test acc: 0.969, loss: 0.107 | Time: 5.71s
[Epoch 11] Train acc: 1.000, loss: 0.005 | Test acc: 0.969, loss: 0.108 | Time: 5.77s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.969, loss: 0.109 | Time: 5.69s
[Epoch 13] Train acc: 1.000, loss: 0.004 | Test acc: 0.968, loss: 0.110 | Time: 5.83s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.969, loss: 0.112 | Time: 5.79s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.969, loss: 0.113 | Time: 5.87s
[Epoch 16] Train acc: 1.000, loss: 0.003 | Test acc: 0.970, loss: 0.112 | Time: 5.84s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.112 | Time: 5.80s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.112 | Time: 5.82s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.970, loss: 0.112 | Time: 5.84s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.971, loss: 0.111 | Time: 5.77s
[Epoch 21] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.111 | Time: 5.90s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.112 | Time: 5.86s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.112 | Time: 5.89s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.112 | Time: 5.79s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.112 | Time: 5.78s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.113 | Time: 5.75s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.112 | Time: 5.89s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.113 | Time: 5.87s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.113 | Time: 5.77s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.114 | Time: 5.83s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.114 | Time: 5.78s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.115 | Time: 5.76s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.86s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.115 | Time: 5.83s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.76s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.116 | Time: 5.77s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.116 | Time: 5.84s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.971, loss: 0.115 | Time: 5.84s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.116 | Time: 5.87s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.116 | Time: 5.89s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.115 | Time: 5.80s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.115 | Time: 5.87s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.115 | Time: 5.80s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.972, loss: 0.115 | Time: 5.80s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.116 | Time: 5.84s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.973, loss: 0.116 | Time: 5.85s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.972, loss: 0.116 | Time: 5.86s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.973, loss: 0.117 | Time: 5.89s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.972, loss: 0.117 | Time: 5.85s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.972, loss: 0.118 | Time: 5.94s
Total training time: 367.74s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed9_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.977, loss: 0.075 | Test acc: 0.966, loss: 0.112 | Time: 20.54s
[Epoch 2] Train acc: 0.993, loss: 0.024 | Test acc: 0.977, loss: 0.078 | Time: 6.34s
[Epoch 3] Train acc: 0.994, loss: 0.019 | Test acc: 0.976, loss: 0.082 | Time: 7.11s
[Epoch 4] Train acc: 0.999, loss: 0.006 | Test acc: 0.982, loss: 0.071 | Time: 6.82s
[Epoch 5] Train acc: 0.999, loss: 0.003 | Test acc: 0.982, loss: 0.070 | Time: 7.11s
[Epoch 6] Train acc: 0.999, loss: 0.003 | Test acc: 0.984, loss: 0.070 | Time: 6.96s
[Epoch 7] Train acc: 1.000, loss: 0.001 | Test acc: 0.985, loss: 0.062 | Time: 7.18s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 7.02s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.061 | Time: 7.04s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 7.01s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.062 | Time: 7.08s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.063 | Time: 7.00s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 7.03s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.065 | Time: 7.01s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.064 | Time: 7.05s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 6.98s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 7.03s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 7.05s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.064 | Time: 7.01s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 7.04s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.064 | Time: 7.06s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 7.05s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.065 | Time: 7.08s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 7.19s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.065 | Time: 7.06s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.05s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 7.03s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 7.05s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.16s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.17s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 7.00s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.01s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 7.01s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 7.07s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.07s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.067 | Time: 7.05s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.067 | Time: 7.07s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.06s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.067 | Time: 7.08s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.067 | Time: 7.07s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.13s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.22s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.066 | Time: 7.05s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.066 | Time: 7.09s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.067 | Time: 7.08s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.067 | Time: 7.11s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.067 | Time: 7.17s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.067 | Time: 7.13s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.067 | Time: 7.18s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.988, loss: 0.067 | Time: 7.15s
Total training time: 434.93s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed9_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.967, loss: 0.106 | Test acc: 0.964, loss: 0.123 | Time: 21.10s
[Epoch 2] Train acc: 0.982, loss: 0.056 | Test acc: 0.975, loss: 0.082 | Time: 7.18s
[Epoch 3] Train acc: 0.981, loss: 0.061 | Test acc: 0.975, loss: 0.087 | Time: 7.72s
[Epoch 4] Train acc: 0.984, loss: 0.053 | Test acc: 0.972, loss: 0.100 | Time: 7.54s
[Epoch 5] Train acc: 0.986, loss: 0.046 | Test acc: 0.982, loss: 0.079 | Time: 7.70s
[Epoch 6] Train acc: 0.992, loss: 0.027 | Test acc: 0.982, loss: 0.073 | Time: 7.51s
[Epoch 7] Train acc: 0.994, loss: 0.020 | Test acc: 0.986, loss: 0.057 | Time: 7.87s
[Epoch 8] Train acc: 0.996, loss: 0.015 | Test acc: 0.984, loss: 0.069 | Time: 7.51s
[Epoch 9] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.053 | Time: 7.71s
[Epoch 10] Train acc: 0.992, loss: 0.030 | Test acc: 0.983, loss: 0.085 | Time: 7.60s
[Epoch 11] Train acc: 0.923, loss: 0.793 | Test acc: 0.915, loss: 0.871 | Time: 7.73s
[Epoch 12] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.059 | Time: 7.63s
[Epoch 13] Train acc: 0.997, loss: 0.009 | Test acc: 0.988, loss: 0.066 | Time: 7.70s
[Epoch 14] Train acc: 0.996, loss: 0.011 | Test acc: 0.988, loss: 0.056 | Time: 7.63s
[Epoch 15] Train acc: 0.993, loss: 0.028 | Test acc: 0.982, loss: 0.093 | Time: 7.77s
[Epoch 16] Train acc: 0.996, loss: 0.012 | Test acc: 0.984, loss: 0.072 | Time: 7.81s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.061 | Time: 7.88s
[Epoch 18] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.063 | Time: 7.82s
[Epoch 19] Train acc: 0.997, loss: 0.013 | Test acc: 0.987, loss: 0.068 | Time: 7.88s
[Epoch 20] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.066 | Time: 7.79s
[Epoch 21] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.074 | Time: 7.70s
[Epoch 22] Train acc: 0.998, loss: 0.006 | Test acc: 0.987, loss: 0.075 | Time: 7.83s
[Epoch 23] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.075 | Time: 7.83s
[Epoch 24] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.080 | Time: 7.75s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.068 | Time: 7.82s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.067 | Time: 7.74s
[Epoch 27] Train acc: 0.998, loss: 0.011 | Test acc: 0.987, loss: 0.076 | Time: 7.82s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.066 | Time: 7.74s
[Epoch 29] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.078 | Time: 7.79s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.065 | Time: 7.83s
[Epoch 31] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.071 | Time: 7.95s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.069 | Time: 7.93s
[Epoch 33] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.080 | Time: 7.83s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.076 | Time: 7.81s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.986, loss: 0.089 | Time: 7.88s
[Epoch 36] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.070 | Time: 107.35s
[Epoch 37] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.070 | Time: 7.99s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.062 | Time: 7.97s
[Epoch 39] Train acc: 0.999, loss: 0.005 | Test acc: 0.986, loss: 0.088 | Time: 8.18s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.066 | Time: 8.04s
[Epoch 41] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.072 | Time: 7.82s
[Epoch 42] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.060 | Time: 7.90s
[Epoch 43] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.082 | Time: 7.82s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.060 | Time: 7.92s
[Epoch 45] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.060 | Time: 8.01s
[Epoch 46] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.074 | Time: 7.98s
[Epoch 47] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.084 | Time: 7.92s
[Epoch 48] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.079 | Time: 8.01s
[Epoch 49] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.066 | Time: 7.96s
[Epoch 50] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.069 | Time: 8.01s
Total training time: 571.44s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed9_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.972, loss: 0.089 | Test acc: 0.967, loss: 0.108 | Time: 20.42s
[Epoch 2] Train acc: 0.982, loss: 0.058 | Test acc: 0.975, loss: 0.082 | Time: 7.14s
[Epoch 3] Train acc: 0.984, loss: 0.052 | Test acc: 0.975, loss: 0.084 | Time: 7.88s
[Epoch 4] Train acc: 0.985, loss: 0.048 | Test acc: 0.976, loss: 0.090 | Time: 7.66s
[Epoch 5] Train acc: 0.988, loss: 0.039 | Test acc: 0.977, loss: 0.087 | Time: 7.83s
[Epoch 6] Train acc: 0.994, loss: 0.018 | Test acc: 0.985, loss: 0.065 | Time: 7.73s
[Epoch 7] Train acc: 0.993, loss: 0.024 | Test acc: 0.982, loss: 0.071 | Time: 7.89s
[Epoch 8] Train acc: 0.993, loss: 0.022 | Test acc: 0.983, loss: 0.073 | Time: 7.63s
[Epoch 9] Train acc: 0.995, loss: 0.015 | Test acc: 0.986, loss: 0.059 | Time: 7.83s
[Epoch 10] Train acc: 0.995, loss: 0.014 | Test acc: 0.985, loss: 0.059 | Time: 7.86s
[Epoch 11] Train acc: 0.989, loss: 0.046 | Test acc: 0.979, loss: 0.101 | Time: 7.91s
[Epoch 12] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.060 | Time: 7.83s
[Epoch 13] Train acc: 0.997, loss: 0.013 | Test acc: 0.985, loss: 0.077 | Time: 7.95s
[Epoch 14] Train acc: 0.995, loss: 0.020 | Test acc: 0.986, loss: 0.073 | Time: 7.88s
[Epoch 15] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.053 | Time: 7.94s
[Epoch 16] Train acc: 0.994, loss: 0.021 | Test acc: 0.985, loss: 0.079 | Time: 7.95s
[Epoch 17] Train acc: 0.996, loss: 0.014 | Test acc: 0.986, loss: 0.071 | Time: 7.62s
[Epoch 18] Train acc: 0.995, loss: 0.020 | Test acc: 0.984, loss: 0.074 | Time: 7.57s
[Epoch 19] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.062 | Time: 7.45s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.063 | Time: 7.52s
[Epoch 21] Train acc: 0.997, loss: 0.011 | Test acc: 0.988, loss: 0.062 | Time: 7.57s
[Epoch 22] Train acc: 0.994, loss: 0.024 | Test acc: 0.983, loss: 0.081 | Time: 7.48s
[Epoch 23] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.059 | Time: 7.66s
[Epoch 24] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.051 | Time: 7.58s
[Epoch 25] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.066 | Time: 7.68s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.077 | Time: 7.69s
[Epoch 27] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.058 | Time: 7.63s
[Epoch 28] Train acc: 0.997, loss: 0.014 | Test acc: 0.985, loss: 0.082 | Time: 7.53s
[Epoch 29] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.068 | Time: 7.48s
[Epoch 30] Train acc: 0.997, loss: 0.016 | Test acc: 0.985, loss: 0.092 | Time: 7.50s
[Epoch 31] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.073 | Time: 7.57s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.065 | Time: 7.53s
[Epoch 33] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.058 | Time: 7.59s
[Epoch 34] Train acc: 0.997, loss: 0.011 | Test acc: 0.986, loss: 0.084 | Time: 7.67s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.053 | Time: 7.68s
[Epoch 36] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.071 | Time: 7.65s
[Epoch 37] Train acc: 0.997, loss: 0.016 | Test acc: 0.987, loss: 0.083 | Time: 7.86s
[Epoch 38] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.068 | Time: 7.58s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.061 | Time: 7.70s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.072 | Time: 7.71s
[Epoch 41] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.066 | Time: 7.79s
[Epoch 42] Train acc: 0.998, loss: 0.246 | Test acc: 0.988, loss: 0.473 | Time: 7.69s
[Epoch 43] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.067 | Time: 7.78s
[Epoch 44] Train acc: 0.996, loss: 0.015 | Test acc: 0.985, loss: 0.072 | Time: 7.90s
[Epoch 45] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.067 | Time: 7.92s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.063 | Time: 7.71s
[Epoch 47] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.062 | Time: 7.75s
[Epoch 48] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.055 | Time: 7.81s
[Epoch 49] Train acc: 0.997, loss: 0.012 | Test acc: 0.987, loss: 0.081 | Time: 7.77s
[Epoch 50] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.065 | Time: 7.95s
Total training time: 466.45s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed9_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/Adam.learning_rate = 0.0003
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/FullES.recompute_samples = 100
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/GradientAccumulator.num_average = 20
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/HyperV2.param_inits = 256
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.lopt = @HyperV2()
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.num_estimators = 8
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.num_steps = 100000
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.staleness = 500
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.summary_every_n = 25
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/run_train.trainer_batch_size = 512
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__d48de79d_48e1_4532_9328_d14908caae73/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.981, loss: 0.065 | Test acc: 0.968, loss: 0.107 | Time: 352.51s
[Epoch 2] Train acc: 0.985, loss: 0.047 | Test acc: 0.973, loss: 0.090 | Time: 80.12s
[Epoch 3] Train acc: 0.991, loss: 0.027 | Test acc: 0.980, loss: 0.076 | Time: 83.03s
[Epoch 4] Train acc: 0.992, loss: 0.027 | Test acc: 0.980, loss: 0.075 | Time: 73.41s
[Epoch 5] Train acc: 0.993, loss: 0.022 | Test acc: 0.981, loss: 0.081 | Time: 69.96s
[Epoch 6] Train acc: 0.995, loss: 0.017 | Test acc: 0.981, loss: 0.072 | Time: 70.36s
[Epoch 7] Train acc: 0.996, loss: 0.013 | Test acc: 0.984, loss: 0.077 | Time: 82.29s
[Epoch 8] Train acc: 0.996, loss: 0.012 | Test acc: 0.981, loss: 0.078 | Time: 81.77s
[Epoch 9] Train acc: 0.997, loss: 0.008 | Test acc: 0.985, loss: 0.068 | Time: 71.13s
[Epoch 10] Train acc: 0.996, loss: 0.011 | Test acc: 0.985, loss: 0.074 | Time: 80.26s
[Epoch 11] Train acc: 0.996, loss: 0.011 | Test acc: 0.986, loss: 0.065 | Time: 85.38s
[Epoch 12] Train acc: 0.997, loss: 0.009 | Test acc: 0.984, loss: 0.073 | Time: 74.74s
[Epoch 13] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.056 | Time: 74.01s
[Epoch 14] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.069 | Time: 79.09s
[Epoch 15] Train acc: 0.998, loss: 0.006 | Test acc: 0.986, loss: 0.072 | Time: 83.54s
[Epoch 16] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.067 | Time: 74.85s
[Epoch 17] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.058 | Time: 79.09s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.067 | Time: 85.46s
[Epoch 19] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.069 | Time: 74.36s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.986, loss: 0.087 | Time: 80.06s
[Epoch 21] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.065 | Time: 83.04s
[Epoch 22] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.065 | Time: 82.92s
[Epoch 23] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.062 | Time: 83.17s
[Epoch 24] Train acc: 0.998, loss: 0.005 | Test acc: 0.986, loss: 0.075 | Time: 69.88s
[Epoch 25] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.067 | Time: 85.37s
[Epoch 26] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.056 | Time: 83.80s
[Epoch 27] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.055 | Time: 70.52s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.071 | Time: 83.21s
[Epoch 29] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.059 | Time: 83.24s
[Epoch 30] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.059 | Time: 70.87s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.068 | Time: 83.09s
[Epoch 32] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.052 | Time: 83.34s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.065 | Time: 72.71s
[Epoch 34] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.064 | Time: 83.07s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.055 | Time: 83.37s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.067 | Time: 83.15s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.074 | Time: 83.57s
[Epoch 38] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.071 | Time: 83.38s
[Epoch 39] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.071 | Time: 83.27s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.987, loss: 0.093 | Time: 84.10s
[Epoch 41] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.076 | Time: 83.35s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.087 | Time: 83.28s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.075 | Time: 83.06s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.080 | Time: 83.42s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.075 | Time: 82.59s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.068 | Time: 68.46s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.069 | Time: 77.52s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.068 | Time: 83.36s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.069 | Time: 83.01s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.991, loss: 0.069 | Time: 83.62s
Total training time: 4336.03s
Checkpoint is written to results/checkpoints/kmnist/velo_resnet34_kmnist_seed10_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.889, loss: 0.376 | Test acc: 0.878, loss: 0.406 | Time: 16.83s
[Epoch 2] Train acc: 0.949, loss: 0.175 | Test acc: 0.931, loss: 0.223 | Time: 5.50s
[Epoch 3] Train acc: 0.971, loss: 0.106 | Test acc: 0.951, loss: 0.167 | Time: 5.70s
[Epoch 4] Train acc: 0.982, loss: 0.069 | Test acc: 0.959, loss: 0.142 | Time: 5.65s
[Epoch 5] Train acc: 0.988, loss: 0.047 | Test acc: 0.961, loss: 0.131 | Time: 5.73s
[Epoch 6] Train acc: 0.994, loss: 0.031 | Test acc: 0.964, loss: 0.123 | Time: 5.67s
[Epoch 7] Train acc: 0.997, loss: 0.020 | Test acc: 0.965, loss: 0.118 | Time: 5.66s
[Epoch 8] Train acc: 0.998, loss: 0.013 | Test acc: 0.967, loss: 0.114 | Time: 5.69s
[Epoch 9] Train acc: 0.999, loss: 0.009 | Test acc: 0.967, loss: 0.112 | Time: 5.66s
[Epoch 10] Train acc: 1.000, loss: 0.007 | Test acc: 0.967, loss: 0.113 | Time: 5.80s
[Epoch 11] Train acc: 1.000, loss: 0.005 | Test acc: 0.968, loss: 0.114 | Time: 5.68s
[Epoch 12] Train acc: 1.000, loss: 0.004 | Test acc: 0.967, loss: 0.116 | Time: 5.71s
[Epoch 13] Train acc: 1.000, loss: 0.004 | Test acc: 0.967, loss: 0.117 | Time: 5.66s
[Epoch 14] Train acc: 1.000, loss: 0.003 | Test acc: 0.966, loss: 0.118 | Time: 5.69s
[Epoch 15] Train acc: 1.000, loss: 0.003 | Test acc: 0.965, loss: 0.119 | Time: 5.67s
[Epoch 16] Train acc: 1.000, loss: 0.002 | Test acc: 0.967, loss: 0.117 | Time: 5.72s
[Epoch 17] Train acc: 1.000, loss: 0.002 | Test acc: 0.967, loss: 0.118 | Time: 5.65s
[Epoch 18] Train acc: 1.000, loss: 0.002 | Test acc: 0.968, loss: 0.117 | Time: 5.76s
[Epoch 19] Train acc: 1.000, loss: 0.002 | Test acc: 0.968, loss: 0.117 | Time: 5.68s
[Epoch 20] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.116 | Time: 5.65s
[Epoch 21] Train acc: 1.000, loss: 0.002 | Test acc: 0.969, loss: 0.116 | Time: 5.71s
[Epoch 22] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.117 | Time: 5.66s
[Epoch 23] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.117 | Time: 5.74s
[Epoch 24] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.116 | Time: 5.67s
[Epoch 25] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.118 | Time: 5.75s
[Epoch 26] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.118 | Time: 5.73s
[Epoch 27] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.118 | Time: 5.67s
[Epoch 28] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.118 | Time: 5.66s
[Epoch 29] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.118 | Time: 5.61s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.118 | Time: 5.62s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.119 | Time: 5.64s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.118 | Time: 5.62s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.118 | Time: 5.69s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.119 | Time: 5.63s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.119 | Time: 5.66s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.120 | Time: 5.67s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.121 | Time: 5.68s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.120 | Time: 5.61s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.121 | Time: 5.71s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.970, loss: 0.121 | Time: 5.67s
[Epoch 41] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.120 | Time: 5.72s
[Epoch 42] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.120 | Time: 5.71s
[Epoch 43] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.120 | Time: 5.76s
[Epoch 44] Train acc: 1.000, loss: 0.001 | Test acc: 0.968, loss: 0.120 | Time: 5.71s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.121 | Time: 5.69s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.120 | Time: 5.75s
[Epoch 47] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.121 | Time: 5.77s
[Epoch 48] Train acc: 1.000, loss: 0.001 | Test acc: 0.969, loss: 0.121 | Time: 5.80s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.968, loss: 0.122 | Time: 5.77s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.968, loss: 0.122 | Time: 5.80s
Total training time: 364.43s
Checkpoint is written to results/checkpoints/kmnist/sgd_resnet34_kmnist_seed10_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.978, loss: 0.073 | Test acc: 0.961, loss: 0.121 | Time: 16.61s
[Epoch 2] Train acc: 0.989, loss: 0.036 | Test acc: 0.970, loss: 0.092 | Time: 6.31s
[Epoch 3] Train acc: 0.996, loss: 0.016 | Test acc: 0.978, loss: 0.078 | Time: 6.73s
[Epoch 4] Train acc: 0.999, loss: 0.006 | Test acc: 0.980, loss: 0.073 | Time: 6.43s
[Epoch 5] Train acc: 1.000, loss: 0.002 | Test acc: 0.983, loss: 0.065 | Time: 6.69s
[Epoch 6] Train acc: 1.000, loss: 0.001 | Test acc: 0.983, loss: 0.064 | Time: 6.52s
[Epoch 7] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.065 | Time: 6.61s
[Epoch 8] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 6.55s
[Epoch 9] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.065 | Time: 6.65s
[Epoch 10] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.066 | Time: 6.56s
[Epoch 11] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.066 | Time: 6.70s
[Epoch 12] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.067 | Time: 6.63s
[Epoch 13] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.57s
[Epoch 14] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.068 | Time: 6.64s
[Epoch 15] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.63s
[Epoch 16] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.65s
[Epoch 17] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.59s
[Epoch 18] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.068 | Time: 6.53s
[Epoch 19] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.068 | Time: 6.64s
[Epoch 20] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.70s
[Epoch 21] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.069 | Time: 6.63s
[Epoch 22] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 6.68s
[Epoch 23] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.069 | Time: 7.14s
[Epoch 24] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.069 | Time: 7.08s
[Epoch 25] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 7.18s
[Epoch 26] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 7.33s
[Epoch 27] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 7.05s
[Epoch 28] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 7.16s
[Epoch 29] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 7.06s
[Epoch 30] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 7.25s
[Epoch 31] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 7.14s
[Epoch 32] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.070 | Time: 7.28s
[Epoch 33] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 7.11s
[Epoch 34] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 7.25s
[Epoch 35] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 7.13s
[Epoch 36] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.072 | Time: 7.21s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 7.19s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 7.13s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 7.06s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 7.20s
[Epoch 41] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 7.25s
[Epoch 42] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.069 | Time: 7.20s
[Epoch 43] Train acc: 1.000, loss: 0.000 | Test acc: 0.987, loss: 0.070 | Time: 7.24s
[Epoch 44] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.069 | Time: 7.14s
[Epoch 45] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 7.24s
[Epoch 46] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.071 | Time: 7.22s
[Epoch 47] Train acc: 1.000, loss: 0.000 | Test acc: 0.985, loss: 0.071 | Time: 7.04s
[Epoch 48] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.071 | Time: 7.12s
[Epoch 49] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.071 | Time: 7.08s
[Epoch 50] Train acc: 1.000, loss: 0.000 | Test acc: 0.986, loss: 0.070 | Time: 7.20s
Total training time: 427.65s
Checkpoint is written to results/checkpoints/kmnist/sgdm_resnet34_kmnist_seed10_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.973, loss: 0.092 | Test acc: 0.967, loss: 0.112 | Time: 20.40s
[Epoch 2] Train acc: 0.980, loss: 0.063 | Test acc: 0.974, loss: 0.087 | Time: 7.21s
[Epoch 3] Train acc: 0.982, loss: 0.060 | Test acc: 0.973, loss: 0.091 | Time: 7.88s
[Epoch 4] Train acc: 0.985, loss: 0.050 | Test acc: 0.978, loss: 0.082 | Time: 7.75s
[Epoch 5] Train acc: 0.972, loss: 0.101 | Test acc: 0.963, loss: 0.153 | Time: 7.70s
[Epoch 6] Train acc: 0.992, loss: 0.026 | Test acc: 0.984, loss: 0.072 | Time: 7.72s
[Epoch 7] Train acc: 0.994, loss: 0.020 | Test acc: 0.985, loss: 0.069 | Time: 7.84s
[Epoch 8] Train acc: 0.996, loss: 0.014 | Test acc: 0.986, loss: 0.060 | Time: 7.67s
[Epoch 9] Train acc: 0.986, loss: 0.061 | Test acc: 0.973, loss: 0.129 | Time: 7.83s
[Epoch 10] Train acc: 0.995, loss: 0.017 | Test acc: 0.985, loss: 0.065 | Time: 7.69s
[Epoch 11] Train acc: 0.995, loss: 0.017 | Test acc: 0.987, loss: 0.071 | Time: 7.78s
[Epoch 12] Train acc: 0.995, loss: 0.016 | Test acc: 0.986, loss: 0.067 | Time: 7.64s
[Epoch 13] Train acc: 0.996, loss: 0.013 | Test acc: 0.986, loss: 0.065 | Time: 7.69s
[Epoch 14] Train acc: 0.995, loss: 0.016 | Test acc: 0.986, loss: 0.078 | Time: 7.68s
[Epoch 15] Train acc: 0.994, loss: 0.024 | Test acc: 0.981, loss: 0.102 | Time: 7.76s
[Epoch 16] Train acc: 0.997, loss: 0.011 | Test acc: 0.987, loss: 0.066 | Time: 7.72s
[Epoch 17] Train acc: 0.990, loss: 0.043 | Test acc: 0.979, loss: 0.113 | Time: 7.77s
[Epoch 18] Train acc: 0.992, loss: 0.035 | Test acc: 0.982, loss: 0.097 | Time: 7.80s
[Epoch 19] Train acc: 0.996, loss: 0.017 | Test acc: 0.985, loss: 0.088 | Time: 7.79s
[Epoch 20] Train acc: 0.995, loss: 0.017 | Test acc: 0.982, loss: 0.090 | Time: 7.74s
[Epoch 21] Train acc: 0.998, loss: 0.005 | Test acc: 0.987, loss: 0.071 | Time: 7.80s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.988, loss: 0.064 | Time: 7.77s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.065 | Time: 7.80s
[Epoch 24] Train acc: 0.998, loss: 0.009 | Test acc: 0.987, loss: 0.078 | Time: 7.74s
[Epoch 25] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.057 | Time: 7.75s
[Epoch 26] Train acc: 0.996, loss: 0.017 | Test acc: 0.986, loss: 0.083 | Time: 7.66s
[Epoch 27] Train acc: 0.999, loss: 0.006 | Test acc: 0.987, loss: 0.082 | Time: 7.76s
[Epoch 28] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.058 | Time: 7.72s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.058 | Time: 7.69s
[Epoch 30] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.071 | Time: 7.74s
[Epoch 31] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.074 | Time: 7.73s
[Epoch 32] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.071 | Time: 7.92s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.064 | Time: 7.94s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.074 | Time: 7.79s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.071 | Time: 7.73s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.988, loss: 0.081 | Time: 7.75s
[Epoch 37] Train acc: 0.999, loss: 0.005 | Test acc: 0.987, loss: 0.082 | Time: 7.80s
[Epoch 38] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.090 | Time: 7.77s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.063 | Time: 7.81s
[Epoch 40] Train acc: 0.998, loss: 0.009 | Test acc: 0.986, loss: 0.094 | Time: 7.81s
[Epoch 41] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.060 | Time: 7.91s
[Epoch 42] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.071 | Time: 7.92s
[Epoch 43] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.074 | Time: 7.80s
[Epoch 44] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.067 | Time: 7.76s
[Epoch 45] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.071 | Time: 7.75s
[Epoch 46] Train acc: 0.998, loss: 0.010 | Test acc: 0.987, loss: 0.105 | Time: 7.90s
[Epoch 47] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.079 | Time: 7.93s
[Epoch 48] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.071 | Time: 7.91s
[Epoch 49] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.076 | Time: 7.80s
[Epoch 50] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.071 | Time: 7.96s
Total training time: 469.32s
Checkpoint is written to results/checkpoints/kmnist/adam_resnet34_kmnist_seed10_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet34: 21283530

Training 42150 steps over 50 epochs
[Epoch 1] Train acc: 0.965, loss: 0.113 | Test acc: 0.961, loss: 0.132 | Time: 20.12s
[Epoch 2] Train acc: 0.982, loss: 0.058 | Test acc: 0.972, loss: 0.090 | Time: 7.06s
[Epoch 3] Train acc: 0.983, loss: 0.054 | Test acc: 0.977, loss: 0.084 | Time: 7.69s
[Epoch 4] Train acc: 0.990, loss: 0.032 | Test acc: 0.981, loss: 0.069 | Time: 7.43s
[Epoch 5] Train acc: 0.990, loss: 0.033 | Test acc: 0.981, loss: 0.067 | Time: 7.65s
[Epoch 6] Train acc: 0.988, loss: 0.041 | Test acc: 0.980, loss: 0.082 | Time: 7.49s
[Epoch 7] Train acc: 0.984, loss: 0.051 | Test acc: 0.972, loss: 0.105 | Time: 7.60s
[Epoch 8] Train acc: 0.981, loss: 0.074 | Test acc: 0.974, loss: 0.119 | Time: 7.61s
[Epoch 9] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.048 | Time: 7.73s
[Epoch 10] Train acc: 0.995, loss: 0.017 | Test acc: 0.984, loss: 0.070 | Time: 7.77s
[Epoch 11] Train acc: 0.952, loss: 2.055 | Test acc: 0.940, loss: 2.221 | Time: 7.61s
[Epoch 12] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.060 | Time: 7.59s
[Epoch 13] Train acc: 0.996, loss: 0.014 | Test acc: 0.986, loss: 0.066 | Time: 7.57s
[Epoch 14] Train acc: 0.994, loss: 0.018 | Test acc: 0.983, loss: 0.069 | Time: 7.61s
[Epoch 15] Train acc: 0.995, loss: 0.019 | Test acc: 0.984, loss: 0.074 | Time: 7.56s
[Epoch 16] Train acc: 0.997, loss: 0.015 | Test acc: 0.986, loss: 0.070 | Time: 7.60s
[Epoch 17] Train acc: 0.995, loss: 0.022 | Test acc: 0.986, loss: 0.075 | Time: 7.49s
[Epoch 18] Train acc: 0.993, loss: 0.029 | Test acc: 0.981, loss: 0.104 | Time: 7.49s
[Epoch 19] Train acc: 0.996, loss: 0.017 | Test acc: 0.986, loss: 0.074 | Time: 7.70s
[Epoch 20] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.060 | Time: 7.63s
[Epoch 21] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.060 | Time: 7.71s
[Epoch 22] Train acc: 0.998, loss: 0.010 | Test acc: 0.987, loss: 0.083 | Time: 7.62s
[Epoch 23] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.060 | Time: 7.63s
[Epoch 24] Train acc: 0.999, loss: 0.004 | Test acc: 0.987, loss: 0.066 | Time: 7.61s
[Epoch 25] Train acc: 0.998, loss: 0.005 | Test acc: 0.988, loss: 0.071 | Time: 7.63s
[Epoch 26] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.061 | Time: 7.63s
[Epoch 27] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.074 | Time: 7.67s
[Epoch 28] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.078 | Time: 7.61s
[Epoch 29] Train acc: 0.999, loss: 0.006 | Test acc: 0.990, loss: 0.054 | Time: 7.65s
[Epoch 30] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.064 | Time: 7.64s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.049 | Time: 7.73s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.065 | Time: 7.69s
[Epoch 33] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.073 | Time: 7.77s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.989, loss: 0.066 | Time: 7.83s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.070 | Time: 7.74s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.075 | Time: 7.67s
[Epoch 37] Train acc: 0.997, loss: 0.010 | Test acc: 0.985, loss: 0.090 | Time: 7.71s
[Epoch 38] Train acc: 0.999, loss: 0.003 | Test acc: 0.987, loss: 0.082 | Time: 7.78s
[Epoch 39] Train acc: 0.997, loss: 0.014 | Test acc: 0.986, loss: 0.096 | Time: 7.74s
[Epoch 40] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.081 | Time: 7.88s
[Epoch 41] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.066 | Time: 7.91s
[Epoch 42] Train acc: 0.998, loss: 0.008 | Test acc: 0.986, loss: 0.086 | Time: 7.86s
[Epoch 43] Train acc: 0.998, loss: 0.010 | Test acc: 0.986, loss: 0.093 | Time: 7.78s
[Epoch 44] Train acc: 0.995, loss: 0.023 | Test acc: 0.985, loss: 0.089 | Time: 7.74s
[Epoch 45] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.053 | Time: 7.74s
[Epoch 46] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.055 | Time: 7.82s
[Epoch 47] Train acc: 0.988, loss: 0.052 | Test acc: 0.978, loss: 0.148 | Time: 7.80s
[Epoch 48] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.058 | Time: 7.80s
[Epoch 49] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.077 | Time: 7.93s
[Epoch 50] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.061 | Time: 7.80s
Total training time: 464.65s
Checkpoint is written to results/checkpoints/kmnist/adamw_resnet34_kmnist_seed10_pretrained.msgpack
