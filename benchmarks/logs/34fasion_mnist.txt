Using: [CudaDevice(id=0)]
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/Adam.learning_rate = 0.0003
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/FullES.recompute_samples = 100
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/GradientAccumulator.num_average = 20
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/HyperV2.param_inits = 256
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.lopt = @HyperV2()
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.num_estimators = 8
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.num_steps = 100000
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.staleness = 500
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.summary_every_n = 25
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/run_train.trainer_batch_size = 512
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__c93bfb2f_eca8_4b34_ba54_4e509c140637/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet34: 21283530

Training 46800 steps over 100 epochs
[Epoch 1] Train acc: 0.899, loss: 0.275 | Test acc: 0.875, loss: 0.337 | Time: 251.75s
[Epoch 2] Train acc: 0.918, loss: 0.225 | Test acc: 0.890, loss: 0.307 | Time: 33.90s
[Epoch 3] Train acc: 0.930, loss: 0.189 | Test acc: 0.894, loss: 0.309 | Time: 33.66s
[Epoch 4] Train acc: 0.940, loss: 0.162 | Test acc: 0.897, loss: 0.314 | Time: 33.63s
[Epoch 5] Train acc: 0.946, loss: 0.147 | Test acc: 0.899, loss: 0.322 | Time: 33.99s
[Epoch 6] Train acc: 0.949, loss: 0.138 | Test acc: 0.894, loss: 0.359 | Time: 33.66s
[Epoch 7] Train acc: 0.953, loss: 0.130 | Test acc: 0.900, loss: 0.368 | Time: 33.76s
[Epoch 8] Train acc: 0.955, loss: 0.124 | Test acc: 0.894, loss: 0.372 | Time: 33.89s
[Epoch 9] Train acc: 0.960, loss: 0.109 | Test acc: 0.899, loss: 0.402 | Time: 33.66s
[Epoch 10] Train acc: 0.966, loss: 0.099 | Test acc: 0.897, loss: 0.431 | Time: 33.62s
[Epoch 11] Train acc: 0.969, loss: 0.088 | Test acc: 0.902, loss: 0.428 | Time: 33.85s
[Epoch 12] Train acc: 0.974, loss: 0.074 | Test acc: 0.903, loss: 0.445 | Time: 33.60s
[Epoch 13] Train acc: 0.976, loss: 0.068 | Test acc: 0.904, loss: 0.470 | Time: 33.77s
[Epoch 14] Train acc: 0.977, loss: 0.065 | Test acc: 0.903, loss: 0.464 | Time: 33.87s
[Epoch 15] Train acc: 0.976, loss: 0.071 | Test acc: 0.901, loss: 0.495 | Time: 33.60s
[Epoch 16] Train acc: 0.980, loss: 0.059 | Test acc: 0.903, loss: 0.453 | Time: 33.59s
[Epoch 17] Train acc: 0.978, loss: 0.062 | Test acc: 0.905, loss: 0.487 | Time: 33.94s
[Epoch 18] Train acc: 0.978, loss: 0.064 | Test acc: 0.898, loss: 0.502 | Time: 33.64s
[Epoch 19] Train acc: 0.981, loss: 0.053 | Test acc: 0.906, loss: 0.468 | Time: 33.67s
[Epoch 20] Train acc: 0.979, loss: 0.059 | Test acc: 0.904, loss: 0.469 | Time: 33.89s
[Epoch 21] Train acc: 0.983, loss: 0.048 | Test acc: 0.905, loss: 0.487 | Time: 33.64s
[Epoch 22] Train acc: 0.977, loss: 0.065 | Test acc: 0.897, loss: 0.499 | Time: 33.63s
[Epoch 23] Train acc: 0.982, loss: 0.049 | Test acc: 0.902, loss: 0.483 | Time: 33.91s
[Epoch 24] Train acc: 0.983, loss: 0.049 | Test acc: 0.905, loss: 0.479 | Time: 33.64s
[Epoch 25] Train acc: 0.984, loss: 0.045 | Test acc: 0.903, loss: 0.490 | Time: 33.65s
[Epoch 26] Train acc: 0.984, loss: 0.047 | Test acc: 0.905, loss: 0.491 | Time: 33.94s

Early stopping triggered at epoch 26. Best epoch was 19
Total training time: 1121.30s

Evaluating final test accuracy:
Final Model Accuracy: 0.9055 | Loss: 0.4711
EMA Model Accuracy:   0.7472 | Loss: 1.2026
SWA Model Accuracy:   0.0504 | Loss: 148.7910
Checkpoint is written to results/checkpoints/fashion_mnist/velo_resnet34_fashion_mnist_pretrained.msgpack
###################################################################################################


number of parameters for resnet34: 21283530

Training 46800 steps over 100 epochs
[Epoch 1] Train acc: 0.808, loss: 0.532 | Test acc: 0.796, loss: 0.563 | Time: 15.75s
[Epoch 2] Train acc: 0.849, loss: 0.414 | Test acc: 0.836, loss: 0.458 | Time: 4.69s
[Epoch 3] Train acc: 0.873, loss: 0.352 | Test acc: 0.851, loss: 0.412 | Time: 4.79s
[Epoch 4] Train acc: 0.888, loss: 0.313 | Test acc: 0.863, loss: 0.382 | Time: 4.77s
[Epoch 5] Train acc: 0.900, loss: 0.280 | Test acc: 0.870, loss: 0.364 | Time: 4.87s
[Epoch 6] Train acc: 0.908, loss: 0.257 | Test acc: 0.871, loss: 0.357 | Time: 4.85s
[Epoch 7] Train acc: 0.913, loss: 0.244 | Test acc: 0.872, loss: 0.355 | Time: 4.86s
[Epoch 8] Train acc: 0.920, loss: 0.226 | Test acc: 0.873, loss: 0.354 | Time: 4.80s
[Epoch 9] Train acc: 0.927, loss: 0.205 | Test acc: 0.875, loss: 0.349 | Time: 4.89s
[Epoch 10] Train acc: 0.935, loss: 0.185 | Test acc: 0.879, loss: 0.340 | Time: 4.82s
[Epoch 11] Train acc: 0.925, loss: 0.204 | Test acc: 0.868, loss: 0.375 | Time: 4.92s
[Epoch 12] Train acc: 0.938, loss: 0.177 | Test acc: 0.879, loss: 0.367 | Time: 4.84s
[Epoch 13] Train acc: 0.941, loss: 0.161 | Test acc: 0.875, loss: 0.379 | Time: 4.93s
[Epoch 14] Train acc: 0.946, loss: 0.151 | Test acc: 0.877, loss: 0.383 | Time: 4.84s
[Epoch 15] Train acc: 0.915, loss: 0.238 | Test acc: 0.848, loss: 0.494 | Time: 4.78s
[Epoch 16] Train acc: 0.953, loss: 0.131 | Test acc: 0.872, loss: 0.414 | Time: 4.84s
[Epoch 17] Train acc: 0.962, loss: 0.108 | Test acc: 0.878, loss: 0.413 | Time: 4.84s

Early stopping triggered at epoch 17. Best epoch was 10
Total training time: 110.67s

Evaluating final test accuracy:
Final Model Accuracy: 0.8777 | Loss: 0.3432
EMA Model Accuracy:   0.8693 | Loss: 0.4084
SWA Model Accuracy:   0.1155 | Loss: 3.2768
Checkpoint is written to results/checkpoints/fashion_mnist/sgd_resnet34_fashion_mnist_pretrained.msgpack
###################################################################################################


number of parameters for resnet34: 21283530

Training 46800 steps over 100 epochs
[Epoch 1] Train acc: 0.885, loss: 0.317 | Test acc: 0.866, loss: 0.379 | Time: 17.91s
[Epoch 2] Train acc: 0.892, loss: 0.293 | Test acc: 0.864, loss: 0.378 | Time: 5.27s
[Epoch 3] Train acc: 0.898, loss: 0.278 | Test acc: 0.867, loss: 0.392 | Time: 5.59s
[Epoch 4] Train acc: 0.920, loss: 0.222 | Test acc: 0.879, loss: 0.365 | Time: 5.48s
[Epoch 5] Train acc: 0.913, loss: 0.248 | Test acc: 0.869, loss: 0.422 | Time: 5.52s
[Epoch 6] Train acc: 0.943, loss: 0.153 | Test acc: 0.886, loss: 0.365 | Time: 5.58s
[Epoch 7] Train acc: 0.945, loss: 0.149 | Test acc: 0.886, loss: 0.402 | Time: 5.55s
[Epoch 8] Train acc: 0.902, loss: 0.282 | Test acc: 0.845, loss: 0.567 | Time: 5.56s
[Epoch 9] Train acc: 0.939, loss: 0.170 | Test acc: 0.875, loss: 0.457 | Time: 5.48s
[Epoch 10] Train acc: 0.948, loss: 0.149 | Test acc: 0.882, loss: 0.455 | Time: 5.48s
[Epoch 11] Train acc: 0.953, loss: 0.130 | Test acc: 0.888, loss: 0.425 | Time: 5.49s
[Epoch 12] Train acc: 0.950, loss: 0.168 | Test acc: 0.882, loss: 0.511 | Time: 5.57s
[Epoch 13] Train acc: 0.958, loss: 0.120 | Test acc: 0.883, loss: 0.494 | Time: 5.46s
[Epoch 14] Train acc: 0.961, loss: 0.110 | Test acc: 0.888, loss: 0.489 | Time: 5.48s
[Epoch 15] Train acc: 0.956, loss: 0.143 | Test acc: 0.883, loss: 0.568 | Time: 5.52s
[Epoch 16] Train acc: 0.965, loss: 0.111 | Test acc: 0.892, loss: 0.548 | Time: 5.54s
[Epoch 17] Train acc: 0.974, loss: 0.079 | Test acc: 0.891, loss: 0.518 | Time: 5.53s
[Epoch 18] Train acc: 0.978, loss: 0.061 | Test acc: 0.900, loss: 0.519 | Time: 5.58s
[Epoch 19] Train acc: 0.973, loss: 0.079 | Test acc: 0.890, loss: 0.559 | Time: 5.53s
[Epoch 20] Train acc: 0.978, loss: 0.067 | Test acc: 0.893, loss: 0.577 | Time: 5.53s
[Epoch 21] Train acc: 0.979, loss: 0.059 | Test acc: 0.894, loss: 0.532 | Time: 5.49s
[Epoch 22] Train acc: 0.985, loss: 0.043 | Test acc: 0.896, loss: 0.542 | Time: 5.60s
[Epoch 23] Train acc: 0.984, loss: 0.044 | Test acc: 0.895, loss: 0.570 | Time: 5.60s
[Epoch 24] Train acc: 0.989, loss: 0.032 | Test acc: 0.900, loss: 0.550 | Time: 5.54s
[Epoch 25] Train acc: 0.983, loss: 0.055 | Test acc: 0.889, loss: 0.626 | Time: 5.49s
[Epoch 26] Train acc: 0.991, loss: 0.025 | Test acc: 0.899, loss: 0.581 | Time: 5.51s
[Epoch 27] Train acc: 0.989, loss: 0.032 | Test acc: 0.899, loss: 0.560 | Time: 5.52s
[Epoch 28] Train acc: 0.987, loss: 0.036 | Test acc: 0.894, loss: 0.606 | Time: 5.57s
[Epoch 29] Train acc: 0.993, loss: 0.019 | Test acc: 0.899, loss: 0.575 | Time: 5.52s
[Epoch 30] Train acc: 0.992, loss: 0.022 | Test acc: 0.901, loss: 0.611 | Time: 5.53s
[Epoch 31] Train acc: 0.993, loss: 0.022 | Test acc: 0.903, loss: 0.617 | Time: 15.00s
[Epoch 32] Train acc: 0.995, loss: 0.014 | Test acc: 0.902, loss: 0.592 | Time: 5.44s
[Epoch 33] Train acc: 0.991, loss: 0.025 | Test acc: 0.902, loss: 0.626 | Time: 5.45s
[Epoch 34] Train acc: 0.995, loss: 0.016 | Test acc: 0.905, loss: 0.617 | Time: 14.04s
[Epoch 35] Train acc: 0.996, loss: 0.011 | Test acc: 0.904, loss: 0.607 | Time: 5.43s
[Epoch 36] Train acc: 0.995, loss: 0.014 | Test acc: 0.905, loss: 0.648 | Time: 5.47s
[Epoch 37] Train acc: 0.994, loss: 0.016 | Test acc: 0.904, loss: 0.631 | Time: 14.06s
[Epoch 38] Train acc: 0.992, loss: 0.028 | Test acc: 0.899, loss: 0.648 | Time: 5.49s
[Epoch 39] Train acc: 0.993, loss: 0.021 | Test acc: 0.902, loss: 0.642 | Time: 5.44s
[Epoch 40] Train acc: 0.994, loss: 0.019 | Test acc: 0.902, loss: 0.645 | Time: 13.84s
[Epoch 41] Train acc: 0.997, loss: 0.010 | Test acc: 0.902, loss: 0.641 | Time: 5.42s

Early stopping triggered at epoch 41. Best epoch was 34
Total training time: 311.90s

Evaluating final test accuracy:
Final Model Accuracy: 0.9061 | Loss: 0.6112
EMA Model Accuracy:   0.9003 | Loss: 0.6297
SWA Model Accuracy:   0.9071 | Loss: 0.5476
Checkpoint is written to results/checkpoints/fashion_mnist/sgd_momentum_resnet34_fashion_mnist_pretrained.msgpack
###################################################################################################


number of parameters for resnet34: 21283530

Training 46800 steps over 100 epochs
[Epoch 1] Train acc: 0.876, loss: 0.332 | Test acc: 0.863, loss: 0.377 | Time: 19.59s
[Epoch 2] Train acc: 0.887, loss: 0.304 | Test acc: 0.872, loss: 0.357 | Time: 5.99s
[Epoch 3] Train acc: 0.883, loss: 0.332 | Test acc: 0.867, loss: 0.401 | Time: 6.22s
[Epoch 4] Train acc: 0.897, loss: 0.282 | Test acc: 0.878, loss: 0.355 | Time: 6.20s
[Epoch 5] Train acc: 0.874, loss: 0.364 | Test acc: 0.854, loss: 0.452 | Time: 6.29s
[Epoch 6] Train acc: 0.915, loss: 0.230 | Test acc: 0.893, loss: 0.332 | Time: 6.18s
[Epoch 7] Train acc: 0.918, loss: 0.242 | Test acc: 0.889, loss: 0.366 | Time: 6.24s
[Epoch 8] Train acc: 0.925, loss: 0.211 | Test acc: 0.894, loss: 0.343 | Time: 6.10s
[Epoch 9] Train acc: 0.927, loss: 0.193 | Test acc: 0.894, loss: 0.343 | Time: 6.26s
[Epoch 10] Train acc: 0.935, loss: 0.179 | Test acc: 0.895, loss: 0.335 | Time: 6.18s
[Epoch 11] Train acc: 0.945, loss: 0.156 | Test acc: 0.905, loss: 0.353 | Time: 6.23s
[Epoch 12] Train acc: 0.941, loss: 0.157 | Test acc: 0.898, loss: 0.329 | Time: 6.19s
[Epoch 13] Train acc: 0.937, loss: 0.181 | Test acc: 0.895, loss: 0.403 | Time: 6.25s
[Epoch 14] Train acc: 0.951, loss: 0.148 | Test acc: 0.902, loss: 0.431 | Time: 6.20s
[Epoch 15] Train acc: 0.950, loss: 0.146 | Test acc: 0.899, loss: 0.419 | Time: 6.21s
[Epoch 16] Train acc: 0.957, loss: 0.127 | Test acc: 0.904, loss: 0.400 | Time: 6.19s
[Epoch 17] Train acc: 0.945, loss: 0.181 | Test acc: 0.895, loss: 0.487 | Time: 6.16s
[Epoch 18] Train acc: 0.946, loss: 0.181 | Test acc: 0.892, loss: 0.496 | Time: 6.15s

Early stopping triggered at epoch 18. Best epoch was 11
Total training time: 143.31s

Evaluating final test accuracy:
Final Model Accuracy: 0.9036 | Loss: 0.3596
EMA Model Accuracy:   0.1237 | Loss: 254.5056
SWA Model Accuracy:   0.0994 | Loss: 3.2457
Checkpoint is written to results/checkpoints/fashion_mnist/adam_resnet34_fashion_mnist_pretrained.msgpack
###################################################################################################


number of parameters for resnet34: 21283530

Training 46800 steps over 100 epochs
[Epoch 1] Train acc: 0.884, loss: 0.316 | Test acc: 0.872, loss: 0.356 | Time: 19.54s
[Epoch 2] Train acc: 0.898, loss: 0.274 | Test acc: 0.884, loss: 0.324 | Time: 5.82s
[Epoch 3] Train acc: 0.901, loss: 0.266 | Test acc: 0.884, loss: 0.327 | Time: 6.04s
[Epoch 4] Train acc: 0.911, loss: 0.240 | Test acc: 0.893, loss: 0.312 | Time: 5.88s
[Epoch 5] Train acc: 0.909, loss: 0.244 | Test acc: 0.889, loss: 0.329 | Time: 6.06s
[Epoch 6] Train acc: 0.927, loss: 0.194 | Test acc: 0.899, loss: 0.289 | Time: 6.09s
[Epoch 7] Train acc: 0.935, loss: 0.174 | Test acc: 0.901, loss: 0.279 | Time: 5.96s
[Epoch 8] Train acc: 0.927, loss: 0.198 | Test acc: 0.894, loss: 0.331 | Time: 6.03s
[Epoch 9] Train acc: 0.935, loss: 0.174 | Test acc: 0.897, loss: 0.327 | Time: 5.96s
[Epoch 10] Train acc: 0.941, loss: 0.158 | Test acc: 0.900, loss: 0.319 | Time: 6.01s
[Epoch 11] Train acc: 0.938, loss: 0.161 | Test acc: 0.892, loss: 0.337 | Time: 6.02s
[Epoch 12] Train acc: 0.946, loss: 0.143 | Test acc: 0.902, loss: 0.338 | Time: 6.03s
[Epoch 13] Train acc: 0.953, loss: 0.127 | Test acc: 0.902, loss: 0.366 | Time: 5.95s
[Epoch 14] Train acc: 0.948, loss: 0.153 | Test acc: 0.892, loss: 0.427 | Time: 6.00s
[Epoch 15] Train acc: 0.953, loss: 0.129 | Test acc: 0.901, loss: 0.391 | Time: 6.03s
[Epoch 16] Train acc: 0.950, loss: 0.152 | Test acc: 0.899, loss: 0.436 | Time: 6.03s
[Epoch 17] Train acc: 0.956, loss: 0.129 | Test acc: 0.900, loss: 0.429 | Time: 5.97s
[Epoch 18] Train acc: 0.960, loss: 0.119 | Test acc: 0.902, loss: 0.423 | Time: 6.05s
[Epoch 19] Train acc: 0.955, loss: 0.142 | Test acc: 0.897, loss: 0.491 | Time: 5.94s
[Epoch 20] Train acc: 0.953, loss: 0.160 | Test acc: 0.894, loss: 0.550 | Time: 6.09s

Early stopping triggered at epoch 20. Best epoch was 13
Total training time: 153.66s

Evaluating final test accuracy:
Final Model Accuracy: 0.9019 | Loss: 0.3702
EMA Model Accuracy:   0.4150 | Loss: 43.0784
SWA Model Accuracy:   0.1004 | Loss: 3.7523
Checkpoint is written to results/checkpoints/fashion_mnist/adamw_resnet34_fashion_mnist_pretrained.msgpack
