Using: [CudaDevice(id=0)]
################### TRAINING WITH velo ###################
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/Adam.learning_rate = 0.0003
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/FullES.recompute_samples = 100
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/GradientAccumulator.num_average = 20
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/HyperV2.param_inits = 256
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.lopt = @HyperV2()
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.num_estimators = 8
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.num_steps = 100000
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.staleness = 500
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.summary_every_n = 25
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/run_train.trainer_batch_size = 512
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__61b77d6e_6ed6_4de4_9d12_bc0c5087f830/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.979, loss: 0.069 | Test acc: 0.978, loss: 0.076 | Time: 26.95s
[Epoch 2] Train acc: 0.982, loss: 0.056 | Test acc: 0.978, loss: 0.070 | Time: 1.89s
[Epoch 3] Train acc: 0.983, loss: 0.054 | Test acc: 0.976, loss: 0.078 | Time: 1.96s
[Epoch 4] Train acc: 0.989, loss: 0.035 | Test acc: 0.983, loss: 0.054 | Time: 1.96s
[Epoch 5] Train acc: 0.994, loss: 0.018 | Test acc: 0.986, loss: 0.039 | Time: 1.97s
[Epoch 6] Train acc: 0.994, loss: 0.017 | Test acc: 0.988, loss: 0.039 | Time: 1.95s
[Epoch 7] Train acc: 0.995, loss: 0.016 | Test acc: 0.989, loss: 0.040 | Time: 1.97s
[Epoch 8] Train acc: 0.994, loss: 0.018 | Test acc: 0.989, loss: 0.045 | Time: 1.96s
[Epoch 9] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.050 | Time: 1.96s
[Epoch 10] Train acc: 0.995, loss: 0.016 | Test acc: 0.987, loss: 0.054 | Time: 1.96s
[Epoch 11] Train acc: 0.996, loss: 0.013 | Test acc: 0.990, loss: 0.042 | Time: 1.96s
[Epoch 12] Train acc: 0.996, loss: 0.014 | Test acc: 0.989, loss: 0.044 | Time: 1.97s
[Epoch 13] Train acc: 0.995, loss: 0.013 | Test acc: 0.988, loss: 0.047 | Time: 1.96s
[Epoch 14] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.049 | Time: 1.97s
[Epoch 15] Train acc: 0.997, loss: 0.008 | Test acc: 0.991, loss: 0.038 | Time: 2.01s
[Epoch 16] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.046 | Time: 2.00s
[Epoch 17] Train acc: 0.996, loss: 0.011 | Test acc: 0.986, loss: 0.052 | Time: 1.96s
[Epoch 18] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.045 | Time: 2.00s
[Epoch 19] Train acc: 0.997, loss: 0.008 | Test acc: 0.989, loss: 0.041 | Time: 2.01s
[Epoch 20] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.047 | Time: 1.98s
[Epoch 21] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.039 | Time: 1.99s
[Epoch 22] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.049 | Time: 1.98s
[Epoch 23] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.045 | Time: 1.98s
[Epoch 24] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.042 | Time: 2.00s
[Epoch 25] Train acc: 0.998, loss: 0.004 | Test acc: 0.991, loss: 0.035 | Time: 1.98s
[Epoch 26] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.043 | Time: 2.02s
[Epoch 27] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.047 | Time: 1.98s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.042 | Time: 1.98s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.043 | Time: 2.00s
[Epoch 30] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.050 | Time: 1.99s
[Epoch 31] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.053 | Time: 1.99s
[Epoch 32] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.045 | Time: 2.00s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.053 | Time: 2.01s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.045 | Time: 1.99s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.045 | Time: 1.99s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.046 | Time: 2.01s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.994, loss: 0.043 | Time: 2.00s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.046 | Time: 2.00s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.046 | Time: 2.02s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.046 | Time: 2.02s
Total training time: 129.88s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed0_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.379, loss: 1.868 | Test acc: 0.381, loss: 1.866 | Time: 2.79s
[Epoch 2] Train acc: 0.597, loss: 1.469 | Test acc: 0.607, loss: 1.464 | Time: 0.96s
[Epoch 3] Train acc: 0.831, loss: 0.895 | Test acc: 0.837, loss: 0.889 | Time: 0.99s
[Epoch 4] Train acc: 0.912, loss: 0.478 | Test acc: 0.918, loss: 0.473 | Time: 0.98s
[Epoch 5] Train acc: 0.940, loss: 0.296 | Test acc: 0.942, loss: 0.291 | Time: 0.97s
[Epoch 6] Train acc: 0.941, loss: 0.244 | Test acc: 0.937, loss: 0.239 | Time: 0.98s
[Epoch 7] Train acc: 0.959, loss: 0.180 | Test acc: 0.958, loss: 0.182 | Time: 0.98s
[Epoch 8] Train acc: 0.958, loss: 0.174 | Test acc: 0.956, loss: 0.179 | Time: 0.98s
[Epoch 9] Train acc: 0.970, loss: 0.127 | Test acc: 0.970, loss: 0.130 | Time: 0.98s
[Epoch 10] Train acc: 0.971, loss: 0.122 | Test acc: 0.966, loss: 0.129 | Time: 0.99s
[Epoch 11] Train acc: 0.969, loss: 0.115 | Test acc: 0.968, loss: 0.120 | Time: 0.97s
[Epoch 12] Train acc: 0.973, loss: 0.102 | Test acc: 0.968, loss: 0.109 | Time: 0.98s
[Epoch 13] Train acc: 0.976, loss: 0.089 | Test acc: 0.973, loss: 0.096 | Time: 0.99s
[Epoch 14] Train acc: 0.958, loss: 0.140 | Test acc: 0.954, loss: 0.150 | Time: 0.98s
[Epoch 15] Train acc: 0.979, loss: 0.079 | Test acc: 0.974, loss: 0.088 | Time: 1.00s
[Epoch 16] Train acc: 0.984, loss: 0.066 | Test acc: 0.977, loss: 0.075 | Time: 1.00s
[Epoch 17] Train acc: 0.974, loss: 0.091 | Test acc: 0.971, loss: 0.101 | Time: 0.99s
[Epoch 18] Train acc: 0.929, loss: 0.220 | Test acc: 0.930, loss: 0.230 | Time: 0.98s
[Epoch 19] Train acc: 0.983, loss: 0.065 | Test acc: 0.979, loss: 0.077 | Time: 0.98s
[Epoch 20] Train acc: 0.967, loss: 0.108 | Test acc: 0.966, loss: 0.122 | Time: 1.03s
[Epoch 21] Train acc: 0.984, loss: 0.062 | Test acc: 0.978, loss: 0.077 | Time: 0.99s
[Epoch 22] Train acc: 0.989, loss: 0.045 | Test acc: 0.983, loss: 0.060 | Time: 0.99s
[Epoch 23] Train acc: 0.988, loss: 0.049 | Test acc: 0.982, loss: 0.064 | Time: 1.00s
[Epoch 24] Train acc: 0.988, loss: 0.046 | Test acc: 0.982, loss: 0.061 | Time: 0.99s
[Epoch 25] Train acc: 0.988, loss: 0.047 | Test acc: 0.979, loss: 0.064 | Time: 0.99s
[Epoch 26] Train acc: 0.989, loss: 0.044 | Test acc: 0.981, loss: 0.062 | Time: 0.99s
[Epoch 27] Train acc: 0.972, loss: 0.093 | Test acc: 0.966, loss: 0.114 | Time: 1.01s
[Epoch 28] Train acc: 0.967, loss: 0.104 | Test acc: 0.963, loss: 0.123 | Time: 1.02s
[Epoch 29] Train acc: 0.984, loss: 0.055 | Test acc: 0.977, loss: 0.070 | Time: 1.01s
[Epoch 30] Train acc: 0.989, loss: 0.041 | Test acc: 0.981, loss: 0.061 | Time: 1.03s
[Epoch 31] Train acc: 0.993, loss: 0.029 | Test acc: 0.983, loss: 0.049 | Time: 1.02s
[Epoch 32] Train acc: 0.993, loss: 0.030 | Test acc: 0.983, loss: 0.052 | Time: 1.02s
[Epoch 33] Train acc: 0.985, loss: 0.051 | Test acc: 0.975, loss: 0.077 | Time: 1.03s
[Epoch 34] Train acc: 0.992, loss: 0.032 | Test acc: 0.982, loss: 0.054 | Time: 1.02s
[Epoch 35] Train acc: 0.991, loss: 0.032 | Test acc: 0.982, loss: 0.055 | Time: 1.02s
[Epoch 36] Train acc: 0.987, loss: 0.043 | Test acc: 0.980, loss: 0.066 | Time: 1.03s
[Epoch 37] Train acc: 0.994, loss: 0.023 | Test acc: 0.986, loss: 0.045 | Time: 1.02s
[Epoch 38] Train acc: 0.995, loss: 0.021 | Test acc: 0.988, loss: 0.041 | Time: 1.02s
[Epoch 39] Train acc: 0.995, loss: 0.023 | Test acc: 0.985, loss: 0.045 | Time: 1.05s
[Epoch 40] Train acc: 0.989, loss: 0.037 | Test acc: 0.983, loss: 0.062 | Time: 1.03s
Total training time: 65.56s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed0_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.941, loss: 0.209 | Test acc: 0.941, loss: 0.213 | Time: 2.68s
[Epoch 2] Train acc: 0.968, loss: 0.109 | Test acc: 0.964, loss: 0.119 | Time: 1.00s
[Epoch 3] Train acc: 0.967, loss: 0.103 | Test acc: 0.960, loss: 0.120 | Time: 1.03s
[Epoch 4] Train acc: 0.973, loss: 0.086 | Test acc: 0.965, loss: 0.105 | Time: 1.03s
[Epoch 5] Train acc: 0.982, loss: 0.058 | Test acc: 0.975, loss: 0.076 | Time: 1.03s
[Epoch 6] Train acc: 0.987, loss: 0.044 | Test acc: 0.980, loss: 0.060 | Time: 1.03s
[Epoch 7] Train acc: 0.988, loss: 0.040 | Test acc: 0.980, loss: 0.059 | Time: 1.03s
[Epoch 8] Train acc: 0.992, loss: 0.028 | Test acc: 0.983, loss: 0.047 | Time: 1.03s
[Epoch 9] Train acc: 0.989, loss: 0.035 | Test acc: 0.979, loss: 0.061 | Time: 1.04s
[Epoch 10] Train acc: 0.991, loss: 0.028 | Test acc: 0.980, loss: 0.052 | Time: 1.09s
[Epoch 11] Train acc: 0.988, loss: 0.035 | Test acc: 0.975, loss: 0.068 | Time: 1.05s
[Epoch 12] Train acc: 0.993, loss: 0.022 | Test acc: 0.983, loss: 0.048 | Time: 1.06s
[Epoch 13] Train acc: 0.993, loss: 0.021 | Test acc: 0.982, loss: 0.052 | Time: 1.06s
[Epoch 14] Train acc: 0.989, loss: 0.030 | Test acc: 0.981, loss: 0.061 | Time: 1.06s
[Epoch 15] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.043 | Time: 1.06s
[Epoch 16] Train acc: 0.992, loss: 0.022 | Test acc: 0.983, loss: 0.052 | Time: 1.06s
[Epoch 17] Train acc: 0.993, loss: 0.020 | Test acc: 0.985, loss: 0.051 | Time: 1.06s
[Epoch 18] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.040 | Time: 1.06s
[Epoch 19] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.040 | Time: 1.06s
[Epoch 20] Train acc: 0.999, loss: 0.006 | Test acc: 0.990, loss: 0.036 | Time: 1.06s
[Epoch 21] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.038 | Time: 1.06s
[Epoch 22] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.034 | Time: 1.06s
[Epoch 23] Train acc: 0.997, loss: 0.009 | Test acc: 0.987, loss: 0.041 | Time: 1.05s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.035 | Time: 1.06s
[Epoch 25] Train acc: 0.995, loss: 0.014 | Test acc: 0.987, loss: 0.049 | Time: 1.06s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.037 | Time: 1.07s
[Epoch 27] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.036 | Time: 1.07s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.036 | Time: 1.08s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.037 | Time: 1.07s
[Epoch 30] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.039 | Time: 1.07s
[Epoch 31] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.037 | Time: 1.06s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.037 | Time: 1.08s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.041 | Time: 1.07s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.034 | Time: 1.07s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.988, loss: 0.043 | Time: 1.07s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.08s
[Epoch 37] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.038 | Time: 1.12s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.08s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.036 | Time: 1.09s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.08s
Total training time: 67.90s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed0_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.973, loss: 0.084 | Test acc: 0.970, loss: 0.091 | Time: 2.98s
[Epoch 2] Train acc: 0.987, loss: 0.040 | Test acc: 0.986, loss: 0.047 | Time: 1.07s
[Epoch 3] Train acc: 0.983, loss: 0.052 | Test acc: 0.981, loss: 0.064 | Time: 1.08s
[Epoch 4] Train acc: 0.992, loss: 0.025 | Test acc: 0.988, loss: 0.035 | Time: 1.08s
[Epoch 5] Train acc: 0.989, loss: 0.032 | Test acc: 0.986, loss: 0.049 | Time: 1.08s
[Epoch 6] Train acc: 0.990, loss: 0.031 | Test acc: 0.984, loss: 0.051 | Time: 1.09s
[Epoch 7] Train acc: 0.989, loss: 0.035 | Test acc: 0.985, loss: 0.060 | Time: 1.08s
[Epoch 8] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.037 | Time: 1.09s
[Epoch 9] Train acc: 0.993, loss: 0.025 | Test acc: 0.987, loss: 0.055 | Time: 1.09s
[Epoch 10] Train acc: 0.992, loss: 0.027 | Test acc: 0.986, loss: 0.060 | Time: 1.16s
[Epoch 11] Train acc: 0.996, loss: 0.014 | Test acc: 0.990, loss: 0.036 | Time: 1.10s
[Epoch 12] Train acc: 0.986, loss: 0.048 | Test acc: 0.978, loss: 0.101 | Time: 1.09s
[Epoch 13] Train acc: 0.994, loss: 0.019 | Test acc: 0.989, loss: 0.049 | Time: 1.09s
[Epoch 14] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.040 | Time: 1.10s
[Epoch 15] Train acc: 0.995, loss: 0.014 | Test acc: 0.989, loss: 0.052 | Time: 1.20s
[Epoch 16] Train acc: 0.995, loss: 0.016 | Test acc: 0.990, loss: 0.046 | Time: 1.14s
[Epoch 17] Train acc: 0.985, loss: 0.054 | Test acc: 0.980, loss: 0.098 | Time: 1.15s
[Epoch 18] Train acc: 0.996, loss: 0.013 | Test acc: 0.990, loss: 0.049 | Time: 1.13s
[Epoch 19] Train acc: 0.997, loss: 0.010 | Test acc: 0.992, loss: 0.033 | Time: 1.17s
[Epoch 20] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.042 | Time: 1.15s
[Epoch 21] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.045 | Time: 1.14s
[Epoch 22] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.051 | Time: 1.14s
[Epoch 23] Train acc: 0.997, loss: 0.008 | Test acc: 0.991, loss: 0.043 | Time: 1.13s
[Epoch 24] Train acc: 0.999, loss: 0.002 | Test acc: 0.994, loss: 0.027 | Time: 1.14s
[Epoch 25] Train acc: 0.996, loss: 0.010 | Test acc: 0.988, loss: 0.048 | Time: 1.16s
[Epoch 26] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.033 | Time: 1.16s
[Epoch 27] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.042 | Time: 1.16s
[Epoch 28] Train acc: 0.997, loss: 0.011 | Test acc: 0.991, loss: 0.047 | Time: 1.16s
[Epoch 29] Train acc: 0.997, loss: 0.010 | Test acc: 0.992, loss: 0.048 | Time: 1.17s
[Epoch 30] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.038 | Time: 1.16s
[Epoch 31] Train acc: 0.999, loss: 0.005 | Test acc: 0.992, loss: 0.046 | Time: 1.18s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.044 | Time: 1.18s
[Epoch 33] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.055 | Time: 1.20s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.044 | Time: 1.20s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.040 | Time: 1.19s
[Epoch 36] Train acc: 0.999, loss: 0.005 | Test acc: 0.992, loss: 0.044 | Time: 1.20s
[Epoch 37] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.048 | Time: 1.20s
[Epoch 38] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.056 | Time: 1.20s
[Epoch 39] Train acc: 0.997, loss: 0.008 | Test acc: 0.992, loss: 0.052 | Time: 1.23s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.994, loss: 0.038 | Time: 1.19s
Total training time: 71.60s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed0_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.969, loss: 0.095 | Test acc: 0.967, loss: 0.102 | Time: 3.07s
[Epoch 2] Train acc: 0.988, loss: 0.037 | Test acc: 0.985, loss: 0.045 | Time: 1.07s
[Epoch 3] Train acc: 0.991, loss: 0.029 | Test acc: 0.985, loss: 0.044 | Time: 1.11s
[Epoch 4] Train acc: 0.992, loss: 0.024 | Test acc: 0.989, loss: 0.038 | Time: 1.10s
[Epoch 5] Train acc: 0.993, loss: 0.021 | Test acc: 0.989, loss: 0.042 | Time: 1.10s
[Epoch 6] Train acc: 0.991, loss: 0.031 | Test acc: 0.986, loss: 0.051 | Time: 1.10s
[Epoch 7] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.040 | Time: 1.13s
[Epoch 8] Train acc: 0.990, loss: 0.031 | Test acc: 0.980, loss: 0.068 | Time: 1.11s
[Epoch 9] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.041 | Time: 1.10s
[Epoch 10] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.050 | Time: 1.11s
[Epoch 11] Train acc: 0.996, loss: 0.011 | Test acc: 0.990, loss: 0.040 | Time: 1.10s
[Epoch 12] Train acc: 0.992, loss: 0.025 | Test acc: 0.983, loss: 0.068 | Time: 1.11s
[Epoch 13] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.053 | Time: 1.11s
[Epoch 14] Train acc: 0.992, loss: 0.029 | Test acc: 0.985, loss: 0.071 | Time: 1.10s
[Epoch 15] Train acc: 0.989, loss: 0.036 | Test acc: 0.983, loss: 0.066 | Time: 1.10s
[Epoch 16] Train acc: 0.998, loss: 0.007 | Test acc: 0.992, loss: 0.038 | Time: 1.10s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.991, loss: 0.041 | Time: 1.11s
[Epoch 18] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.043 | Time: 1.11s
[Epoch 19] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.046 | Time: 1.10s
[Epoch 20] Train acc: 0.994, loss: 0.021 | Test acc: 0.988, loss: 0.062 | Time: 1.12s
[Epoch 21] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.048 | Time: 1.11s
[Epoch 22] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.042 | Time: 1.11s
[Epoch 23] Train acc: 0.991, loss: 0.031 | Test acc: 0.986, loss: 0.067 | Time: 1.11s
[Epoch 24] Train acc: 0.996, loss: 0.016 | Test acc: 0.988, loss: 0.065 | Time: 1.11s
[Epoch 25] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.051 | Time: 1.12s
[Epoch 26] Train acc: 0.992, loss: 0.027 | Test acc: 0.986, loss: 0.061 | Time: 1.12s
[Epoch 27] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.033 | Time: 1.11s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.037 | Time: 1.19s
[Epoch 29] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.043 | Time: 1.14s
[Epoch 30] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.049 | Time: 1.18s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.034 | Time: 1.14s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.041 | Time: 1.16s
[Epoch 33] Train acc: 0.996, loss: 0.013 | Test acc: 0.990, loss: 0.051 | Time: 1.21s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.042 | Time: 1.21s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.034 | Time: 1.17s
[Epoch 36] Train acc: 0.998, loss: 0.008 | Test acc: 0.991, loss: 0.048 | Time: 1.19s
[Epoch 37] Train acc: 0.990, loss: 0.042 | Test acc: 0.983, loss: 0.092 | Time: 1.18s
[Epoch 38] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.052 | Time: 1.19s
[Epoch 39] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.065 | Time: 1.21s
[Epoch 40] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.049 | Time: 1.18s
Total training time: 71.15s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed0_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/Adam.learning_rate = 0.0003
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/FullES.recompute_samples = 100
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/GradientAccumulator.num_average = 20
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/HyperV2.param_inits = 256
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.lopt = @HyperV2()
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.num_estimators = 8
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.num_steps = 100000
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.staleness = 500
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.summary_every_n = 25
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/run_train.trainer_batch_size = 512
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__0cec4342_d600_4cc8_9833_10b0d947131e/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.971, loss: 0.087 | Test acc: 0.972, loss: 0.093 | Time: 25.63s
[Epoch 2] Train acc: 0.982, loss: 0.058 | Test acc: 0.980, loss: 0.069 | Time: 1.89s
[Epoch 3] Train acc: 0.993, loss: 0.023 | Test acc: 0.987, loss: 0.037 | Time: 1.96s
[Epoch 4] Train acc: 0.993, loss: 0.021 | Test acc: 0.986, loss: 0.041 | Time: 1.94s
[Epoch 5] Train acc: 0.992, loss: 0.024 | Test acc: 0.985, loss: 0.054 | Time: 1.95s
[Epoch 6] Train acc: 0.992, loss: 0.024 | Test acc: 0.986, loss: 0.046 | Time: 1.94s
[Epoch 7] Train acc: 0.995, loss: 0.015 | Test acc: 0.987, loss: 0.044 | Time: 1.95s
[Epoch 8] Train acc: 0.993, loss: 0.021 | Test acc: 0.984, loss: 0.053 | Time: 1.96s
[Epoch 9] Train acc: 0.994, loss: 0.016 | Test acc: 0.987, loss: 0.050 | Time: 1.96s
[Epoch 10] Train acc: 0.993, loss: 0.022 | Test acc: 0.984, loss: 0.053 | Time: 1.95s
[Epoch 11] Train acc: 0.994, loss: 0.018 | Test acc: 0.984, loss: 0.054 | Time: 2.01s
[Epoch 12] Train acc: 0.995, loss: 0.014 | Test acc: 0.988, loss: 0.050 | Time: 2.01s
[Epoch 13] Train acc: 0.993, loss: 0.023 | Test acc: 0.983, loss: 0.063 | Time: 1.96s
[Epoch 14] Train acc: 0.997, loss: 0.010 | Test acc: 0.991, loss: 0.036 | Time: 2.00s
[Epoch 15] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.042 | Time: 1.99s
[Epoch 16] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.038 | Time: 1.97s
[Epoch 17] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.048 | Time: 1.98s
[Epoch 18] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.044 | Time: 1.98s
[Epoch 19] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.040 | Time: 1.98s
[Epoch 20] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.050 | Time: 1.98s
[Epoch 21] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.042 | Time: 1.97s
[Epoch 22] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.034 | Time: 1.98s
[Epoch 23] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.037 | Time: 1.97s
[Epoch 24] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.036 | Time: 1.99s
[Epoch 25] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.040 | Time: 1.98s
[Epoch 26] Train acc: 0.998, loss: 0.004 | Test acc: 0.991, loss: 0.041 | Time: 2.07s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.043 | Time: 2.05s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.045 | Time: 2.08s
[Epoch 29] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.051 | Time: 2.06s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.040 | Time: 2.09s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.044 | Time: 2.08s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.042 | Time: 2.08s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.051 | Time: 2.07s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.041 | Time: 2.11s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.047 | Time: 2.10s
[Epoch 36] Train acc: 1.000, loss: 0.002 | Test acc: 0.993, loss: 0.041 | Time: 2.11s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.044 | Time: 2.11s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.042 | Time: 2.11s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.040 | Time: 2.12s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.040 | Time: 2.12s
Total training time: 128.51s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed1_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.411, loss: 1.837 | Test acc: 0.411, loss: 1.838 | Time: 2.58s
[Epoch 2] Train acc: 0.560, loss: 1.480 | Test acc: 0.564, loss: 1.479 | Time: 0.94s
[Epoch 3] Train acc: 0.745, loss: 1.043 | Test acc: 0.755, loss: 1.042 | Time: 0.96s
[Epoch 4] Train acc: 0.895, loss: 0.581 | Test acc: 0.901, loss: 0.577 | Time: 0.97s
[Epoch 5] Train acc: 0.932, loss: 0.339 | Test acc: 0.935, loss: 0.334 | Time: 0.97s
[Epoch 6] Train acc: 0.951, loss: 0.234 | Test acc: 0.953, loss: 0.230 | Time: 0.96s
[Epoch 7] Train acc: 0.956, loss: 0.189 | Test acc: 0.956, loss: 0.189 | Time: 0.97s
[Epoch 8] Train acc: 0.957, loss: 0.174 | Test acc: 0.958, loss: 0.175 | Time: 0.96s
[Epoch 9] Train acc: 0.960, loss: 0.153 | Test acc: 0.959, loss: 0.154 | Time: 0.97s
[Epoch 10] Train acc: 0.968, loss: 0.128 | Test acc: 0.964, loss: 0.132 | Time: 0.96s
[Epoch 11] Train acc: 0.968, loss: 0.121 | Test acc: 0.964, loss: 0.125 | Time: 0.97s
[Epoch 12] Train acc: 0.973, loss: 0.108 | Test acc: 0.968, loss: 0.114 | Time: 0.98s
[Epoch 13] Train acc: 0.975, loss: 0.100 | Test acc: 0.971, loss: 0.107 | Time: 0.97s
[Epoch 14] Train acc: 0.973, loss: 0.103 | Test acc: 0.967, loss: 0.114 | Time: 0.97s
[Epoch 15] Train acc: 0.980, loss: 0.078 | Test acc: 0.975, loss: 0.088 | Time: 0.97s
[Epoch 16] Train acc: 0.982, loss: 0.070 | Test acc: 0.978, loss: 0.079 | Time: 0.98s
[Epoch 17] Train acc: 0.982, loss: 0.069 | Test acc: 0.979, loss: 0.077 | Time: 0.96s
[Epoch 18] Train acc: 0.980, loss: 0.073 | Test acc: 0.974, loss: 0.082 | Time: 0.97s
[Epoch 19] Train acc: 0.985, loss: 0.057 | Test acc: 0.980, loss: 0.069 | Time: 0.97s
[Epoch 20] Train acc: 0.983, loss: 0.063 | Test acc: 0.981, loss: 0.074 | Time: 0.98s
[Epoch 21] Train acc: 0.981, loss: 0.069 | Test acc: 0.979, loss: 0.080 | Time: 0.98s
[Epoch 22] Train acc: 0.987, loss: 0.050 | Test acc: 0.981, loss: 0.062 | Time: 0.98s
[Epoch 23] Train acc: 0.988, loss: 0.045 | Test acc: 0.983, loss: 0.056 | Time: 0.98s
[Epoch 24] Train acc: 0.990, loss: 0.039 | Test acc: 0.985, loss: 0.052 | Time: 0.98s
[Epoch 25] Train acc: 0.989, loss: 0.041 | Test acc: 0.983, loss: 0.055 | Time: 0.99s
[Epoch 26] Train acc: 0.985, loss: 0.052 | Test acc: 0.977, loss: 0.070 | Time: 0.98s
[Epoch 27] Train acc: 0.980, loss: 0.069 | Test acc: 0.974, loss: 0.088 | Time: 0.99s
[Epoch 28] Train acc: 0.984, loss: 0.057 | Test acc: 0.978, loss: 0.073 | Time: 0.99s
[Epoch 29] Train acc: 0.989, loss: 0.040 | Test acc: 0.983, loss: 0.057 | Time: 0.99s
[Epoch 30] Train acc: 0.985, loss: 0.054 | Test acc: 0.979, loss: 0.073 | Time: 1.00s
[Epoch 31] Train acc: 0.991, loss: 0.036 | Test acc: 0.983, loss: 0.055 | Time: 1.00s
[Epoch 32] Train acc: 0.993, loss: 0.029 | Test acc: 0.986, loss: 0.045 | Time: 1.00s
[Epoch 33] Train acc: 0.993, loss: 0.030 | Test acc: 0.985, loss: 0.048 | Time: 1.00s
[Epoch 34] Train acc: 0.994, loss: 0.025 | Test acc: 0.985, loss: 0.042 | Time: 0.99s
[Epoch 35] Train acc: 0.994, loss: 0.025 | Test acc: 0.987, loss: 0.043 | Time: 1.01s
[Epoch 36] Train acc: 0.993, loss: 0.028 | Test acc: 0.985, loss: 0.045 | Time: 1.01s
[Epoch 37] Train acc: 0.993, loss: 0.028 | Test acc: 0.984, loss: 0.045 | Time: 1.02s
[Epoch 38] Train acc: 0.995, loss: 0.021 | Test acc: 0.987, loss: 0.038 | Time: 1.02s
[Epoch 39] Train acc: 0.992, loss: 0.029 | Test acc: 0.982, loss: 0.048 | Time: 1.05s
[Epoch 40] Train acc: 0.993, loss: 0.026 | Test acc: 0.984, loss: 0.048 | Time: 1.02s
Total training time: 64.53s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed1_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.921, loss: 0.258 | Test acc: 0.916, loss: 0.264 | Time: 2.64s
[Epoch 2] Train acc: 0.945, loss: 0.173 | Test acc: 0.944, loss: 0.179 | Time: 1.04s
[Epoch 3] Train acc: 0.970, loss: 0.095 | Test acc: 0.967, loss: 0.103 | Time: 1.04s
[Epoch 4] Train acc: 0.942, loss: 0.170 | Test acc: 0.942, loss: 0.177 | Time: 1.06s
[Epoch 5] Train acc: 0.953, loss: 0.138 | Test acc: 0.949, loss: 0.151 | Time: 1.06s
[Epoch 6] Train acc: 0.961, loss: 0.112 | Test acc: 0.955, loss: 0.125 | Time: 1.07s
[Epoch 7] Train acc: 0.980, loss: 0.060 | Test acc: 0.977, loss: 0.078 | Time: 1.08s
[Epoch 8] Train acc: 0.986, loss: 0.044 | Test acc: 0.980, loss: 0.061 | Time: 1.06s
[Epoch 9] Train acc: 0.990, loss: 0.032 | Test acc: 0.984, loss: 0.052 | Time: 1.07s
[Epoch 10] Train acc: 0.992, loss: 0.024 | Test acc: 0.985, loss: 0.043 | Time: 1.05s
[Epoch 11] Train acc: 0.996, loss: 0.015 | Test acc: 0.987, loss: 0.036 | Time: 1.07s
[Epoch 12] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.034 | Time: 1.15s
[Epoch 13] Train acc: 0.996, loss: 0.012 | Test acc: 0.987, loss: 0.036 | Time: 1.07s
[Epoch 14] Train acc: 0.997, loss: 0.012 | Test acc: 0.989, loss: 0.036 | Time: 1.08s
[Epoch 15] Train acc: 0.996, loss: 0.014 | Test acc: 0.986, loss: 0.041 | Time: 1.10s
[Epoch 16] Train acc: 0.996, loss: 0.012 | Test acc: 0.988, loss: 0.037 | Time: 1.10s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.038 | Time: 1.10s
[Epoch 18] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.035 | Time: 1.09s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.036 | Time: 1.09s
[Epoch 20] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.033 | Time: 1.10s
[Epoch 21] Train acc: 0.998, loss: 0.007 | Test acc: 0.987, loss: 0.037 | Time: 1.09s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.033 | Time: 1.09s
[Epoch 23] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.037 | Time: 1.09s
[Epoch 24] Train acc: 1.000, loss: 0.003 | Test acc: 0.990, loss: 0.034 | Time: 1.11s
[Epoch 25] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.038 | Time: 1.11s
[Epoch 26] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.034 | Time: 1.10s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.037 | Time: 1.11s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.032 | Time: 1.10s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.034 | Time: 1.09s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.09s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.034 | Time: 1.15s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.034 | Time: 1.10s
[Epoch 33] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.038 | Time: 1.12s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.28s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.041 | Time: 1.15s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.11s
[Epoch 37] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.044 | Time: 1.09s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.034 | Time: 1.10s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.044 | Time: 1.14s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.034 | Time: 1.12s
Total training time: 71.61s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed1_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.960, loss: 0.124 | Test acc: 0.960, loss: 0.132 | Time: 2.91s
[Epoch 2] Train acc: 0.986, loss: 0.044 | Test acc: 0.983, loss: 0.049 | Time: 1.07s
[Epoch 3] Train acc: 0.990, loss: 0.032 | Test acc: 0.986, loss: 0.044 | Time: 1.10s
[Epoch 4] Train acc: 0.985, loss: 0.044 | Test acc: 0.982, loss: 0.054 | Time: 1.10s
[Epoch 5] Train acc: 0.986, loss: 0.042 | Test acc: 0.979, loss: 0.068 | Time: 1.12s
[Epoch 6] Train acc: 0.985, loss: 0.049 | Test acc: 0.980, loss: 0.072 | Time: 1.11s
[Epoch 7] Train acc: 0.984, loss: 0.053 | Test acc: 0.977, loss: 0.091 | Time: 1.11s
[Epoch 8] Train acc: 0.993, loss: 0.022 | Test acc: 0.987, loss: 0.053 | Time: 1.11s
[Epoch 9] Train acc: 0.990, loss: 0.028 | Test acc: 0.984, loss: 0.060 | Time: 1.11s
[Epoch 10] Train acc: 0.995, loss: 0.015 | Test acc: 0.987, loss: 0.048 | Time: 1.12s
[Epoch 11] Train acc: 0.995, loss: 0.016 | Test acc: 0.989, loss: 0.047 | Time: 1.12s
[Epoch 12] Train acc: 0.991, loss: 0.028 | Test acc: 0.987, loss: 0.063 | Time: 1.11s
[Epoch 13] Train acc: 0.992, loss: 0.024 | Test acc: 0.984, loss: 0.071 | Time: 1.11s
[Epoch 14] Train acc: 0.992, loss: 0.027 | Test acc: 0.988, loss: 0.059 | Time: 1.10s
[Epoch 15] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.038 | Time: 1.11s
[Epoch 16] Train acc: 0.995, loss: 0.016 | Test acc: 0.989, loss: 0.053 | Time: 1.12s
[Epoch 17] Train acc: 0.993, loss: 0.023 | Test acc: 0.989, loss: 0.051 | Time: 1.10s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.994, loss: 0.044 | Time: 1.12s
[Epoch 19] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.050 | Time: 1.11s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.992, loss: 0.041 | Time: 1.13s
[Epoch 21] Train acc: 0.997, loss: 0.009 | Test acc: 0.993, loss: 0.039 | Time: 1.13s
[Epoch 22] Train acc: 0.998, loss: 0.007 | Test acc: 0.992, loss: 0.045 | Time: 1.12s
[Epoch 23] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.039 | Time: 1.12s
[Epoch 24] Train acc: 0.998, loss: 0.008 | Test acc: 0.992, loss: 0.051 | Time: 1.17s
[Epoch 25] Train acc: 0.996, loss: 0.012 | Test acc: 0.988, loss: 0.061 | Time: 1.13s
[Epoch 26] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.051 | Time: 1.17s
[Epoch 27] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.052 | Time: 1.15s
[Epoch 28] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.046 | Time: 1.15s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.044 | Time: 1.22s
[Epoch 30] Train acc: 0.992, loss: 0.030 | Test acc: 0.987, loss: 0.071 | Time: 1.15s
[Epoch 31] Train acc: 0.999, loss: 0.005 | Test acc: 0.993, loss: 0.039 | Time: 1.17s
[Epoch 32] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.045 | Time: 1.17s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.040 | Time: 1.20s
[Epoch 34] Train acc: 0.998, loss: 0.007 | Test acc: 0.992, loss: 0.055 | Time: 1.19s
[Epoch 35] Train acc: 0.996, loss: 0.016 | Test acc: 0.988, loss: 0.064 | Time: 1.19s
[Epoch 36] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.047 | Time: 1.23s
[Epoch 37] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.060 | Time: 1.19s
[Epoch 38] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.057 | Time: 1.19s
[Epoch 39] Train acc: 0.997, loss: 0.010 | Test acc: 0.992, loss: 0.053 | Time: 1.22s
[Epoch 40] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.045 | Time: 1.20s
Total training time: 73.33s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed1_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.972, loss: 0.085 | Test acc: 0.970, loss: 0.090 | Time: 2.96s
[Epoch 2] Train acc: 0.980, loss: 0.064 | Test acc: 0.976, loss: 0.071 | Time: 1.07s
[Epoch 3] Train acc: 0.982, loss: 0.055 | Test acc: 0.979, loss: 0.065 | Time: 1.08s
[Epoch 4] Train acc: 0.988, loss: 0.039 | Test acc: 0.983, loss: 0.054 | Time: 1.10s
[Epoch 5] Train acc: 0.986, loss: 0.043 | Test acc: 0.983, loss: 0.058 | Time: 1.10s
[Epoch 6] Train acc: 0.985, loss: 0.048 | Test acc: 0.979, loss: 0.074 | Time: 1.10s
[Epoch 7] Train acc: 0.993, loss: 0.023 | Test acc: 0.985, loss: 0.049 | Time: 1.10s
[Epoch 8] Train acc: 0.991, loss: 0.026 | Test acc: 0.985, loss: 0.053 | Time: 1.09s
[Epoch 9] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.049 | Time: 1.09s
[Epoch 10] Train acc: 0.988, loss: 0.041 | Test acc: 0.982, loss: 0.082 | Time: 1.11s
[Epoch 11] Train acc: 0.994, loss: 0.017 | Test acc: 0.989, loss: 0.045 | Time: 1.09s
[Epoch 12] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.056 | Time: 1.10s
[Epoch 13] Train acc: 0.995, loss: 0.016 | Test acc: 0.988, loss: 0.053 | Time: 1.09s
[Epoch 14] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.047 | Time: 1.08s
[Epoch 15] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.059 | Time: 1.09s
[Epoch 16] Train acc: 0.997, loss: 0.008 | Test acc: 0.991, loss: 0.041 | Time: 1.10s
[Epoch 17] Train acc: 0.993, loss: 0.024 | Test acc: 0.984, loss: 0.064 | Time: 1.10s
[Epoch 18] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.040 | Time: 1.10s
[Epoch 19] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.045 | Time: 1.10s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.043 | Time: 1.10s
[Epoch 21] Train acc: 0.994, loss: 0.024 | Test acc: 0.987, loss: 0.071 | Time: 1.10s
[Epoch 22] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.046 | Time: 1.11s
[Epoch 23] Train acc: 0.996, loss: 0.014 | Test acc: 0.989, loss: 0.054 | Time: 1.11s
[Epoch 24] Train acc: 0.995, loss: 0.017 | Test acc: 0.990, loss: 0.050 | Time: 1.11s
[Epoch 25] Train acc: 0.994, loss: 0.017 | Test acc: 0.988, loss: 0.063 | Time: 1.11s
[Epoch 26] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.065 | Time: 1.11s
[Epoch 27] Train acc: 0.993, loss: 0.028 | Test acc: 0.983, loss: 0.093 | Time: 1.12s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.046 | Time: 1.11s
[Epoch 29] Train acc: 0.997, loss: 0.008 | Test acc: 0.989, loss: 0.062 | Time: 1.11s
[Epoch 30] Train acc: 0.998, loss: 0.008 | Test acc: 0.992, loss: 0.053 | Time: 1.11s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.042 | Time: 1.12s
[Epoch 32] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.041 | Time: 1.11s
[Epoch 33] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.050 | Time: 1.14s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.043 | Time: 1.13s
[Epoch 35] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.052 | Time: 1.16s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.039 | Time: 1.17s
[Epoch 37] Train acc: 0.995, loss: 0.020 | Test acc: 0.988, loss: 0.079 | Time: 1.16s
[Epoch 38] Train acc: 0.995, loss: 0.016 | Test acc: 0.987, loss: 0.070 | Time: 1.15s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.045 | Time: 1.18s
[Epoch 40] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.075 | Time: 1.16s
Total training time: 71.04s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed1_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/Adam.learning_rate = 0.0003
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/FullES.recompute_samples = 100
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/GradientAccumulator.num_average = 20
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/HyperV2.param_inits = 256
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.lopt = @HyperV2()
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.num_estimators = 8
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.num_steps = 100000
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.staleness = 500
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.summary_every_n = 25
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/run_train.trainer_batch_size = 512
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__017d3c9f_b4fe_4a80_8e81_cf475ad9845f/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.977, loss: 0.071 | Test acc: 0.973, loss: 0.077 | Time: 26.20s
[Epoch 2] Train acc: 0.984, loss: 0.051 | Test acc: 0.981, loss: 0.055 | Time: 1.91s
[Epoch 3] Train acc: 0.989, loss: 0.035 | Test acc: 0.984, loss: 0.048 | Time: 1.97s
[Epoch 4] Train acc: 0.990, loss: 0.032 | Test acc: 0.984, loss: 0.050 | Time: 1.96s
[Epoch 5] Train acc: 0.995, loss: 0.016 | Test acc: 0.988, loss: 0.039 | Time: 1.98s
[Epoch 6] Train acc: 0.991, loss: 0.030 | Test acc: 0.983, loss: 0.059 | Time: 1.96s
[Epoch 7] Train acc: 0.992, loss: 0.024 | Test acc: 0.986, loss: 0.053 | Time: 1.98s
[Epoch 8] Train acc: 0.991, loss: 0.028 | Test acc: 0.983, loss: 0.066 | Time: 1.96s
[Epoch 9] Train acc: 0.989, loss: 0.033 | Test acc: 0.984, loss: 0.067 | Time: 1.98s
[Epoch 10] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.038 | Time: 1.97s
[Epoch 11] Train acc: 0.993, loss: 0.020 | Test acc: 0.985, loss: 0.054 | Time: 1.97s
[Epoch 12] Train acc: 0.996, loss: 0.013 | Test acc: 0.987, loss: 0.046 | Time: 1.97s
[Epoch 13] Train acc: 0.995, loss: 0.014 | Test acc: 0.988, loss: 0.049 | Time: 1.96s
[Epoch 14] Train acc: 0.993, loss: 0.021 | Test acc: 0.986, loss: 0.058 | Time: 1.98s
[Epoch 15] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.046 | Time: 1.98s
[Epoch 16] Train acc: 0.996, loss: 0.011 | Test acc: 0.991, loss: 0.036 | Time: 1.99s
[Epoch 17] Train acc: 0.996, loss: 0.010 | Test acc: 0.989, loss: 0.048 | Time: 1.98s
[Epoch 18] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.048 | Time: 1.97s
[Epoch 19] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.040 | Time: 2.02s
[Epoch 20] Train acc: 0.997, loss: 0.007 | Test acc: 0.991, loss: 0.034 | Time: 1.98s
[Epoch 21] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.038 | Time: 1.97s
[Epoch 22] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.044 | Time: 1.99s
[Epoch 23] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.051 | Time: 2.02s
[Epoch 24] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.043 | Time: 2.02s
[Epoch 25] Train acc: 0.998, loss: 0.004 | Test acc: 0.992, loss: 0.032 | Time: 2.03s
[Epoch 26] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.036 | Time: 2.03s
[Epoch 27] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.036 | Time: 2.03s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.035 | Time: 2.01s
[Epoch 29] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.047 | Time: 2.02s
[Epoch 30] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.048 | Time: 2.03s
[Epoch 31] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.036 | Time: 2.03s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.040 | Time: 2.05s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.038 | Time: 2.01s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.994, loss: 0.036 | Time: 2.04s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.043 | Time: 2.05s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.049 | Time: 2.07s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.040 | Time: 2.07s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.043 | Time: 2.06s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.039 | Time: 2.08s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.041 | Time: 2.05s
Total training time: 128.11s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed2_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.388, loss: 1.884 | Test acc: 0.391, loss: 1.884 | Time: 2.63s
[Epoch 2] Train acc: 0.563, loss: 1.519 | Test acc: 0.569, loss: 1.515 | Time: 0.96s
[Epoch 3] Train acc: 0.759, loss: 1.030 | Test acc: 0.767, loss: 1.024 | Time: 0.97s
[Epoch 4] Train acc: 0.883, loss: 0.593 | Test acc: 0.888, loss: 0.586 | Time: 0.97s
[Epoch 5] Train acc: 0.926, loss: 0.359 | Test acc: 0.929, loss: 0.352 | Time: 0.97s
[Epoch 6] Train acc: 0.948, loss: 0.244 | Test acc: 0.953, loss: 0.236 | Time: 0.96s
[Epoch 7] Train acc: 0.953, loss: 0.199 | Test acc: 0.955, loss: 0.195 | Time: 0.96s
[Epoch 8] Train acc: 0.962, loss: 0.163 | Test acc: 0.961, loss: 0.161 | Time: 0.97s
[Epoch 9] Train acc: 0.968, loss: 0.136 | Test acc: 0.968, loss: 0.136 | Time: 0.97s
[Epoch 10] Train acc: 0.972, loss: 0.119 | Test acc: 0.969, loss: 0.121 | Time: 0.97s
[Epoch 11] Train acc: 0.973, loss: 0.108 | Test acc: 0.970, loss: 0.111 | Time: 0.96s
[Epoch 12] Train acc: 0.978, loss: 0.089 | Test acc: 0.978, loss: 0.093 | Time: 0.97s
[Epoch 13] Train acc: 0.978, loss: 0.085 | Test acc: 0.977, loss: 0.089 | Time: 0.96s
[Epoch 14] Train acc: 0.978, loss: 0.085 | Test acc: 0.975, loss: 0.091 | Time: 0.96s
[Epoch 15] Train acc: 0.985, loss: 0.064 | Test acc: 0.981, loss: 0.071 | Time: 0.97s
[Epoch 16] Train acc: 0.985, loss: 0.060 | Test acc: 0.982, loss: 0.066 | Time: 0.97s
[Epoch 17] Train acc: 0.985, loss: 0.061 | Test acc: 0.982, loss: 0.068 | Time: 0.97s
[Epoch 18] Train acc: 0.979, loss: 0.074 | Test acc: 0.977, loss: 0.082 | Time: 0.97s
[Epoch 19] Train acc: 0.985, loss: 0.057 | Test acc: 0.983, loss: 0.065 | Time: 0.98s
[Epoch 20] Train acc: 0.986, loss: 0.054 | Test acc: 0.983, loss: 0.063 | Time: 0.99s
[Epoch 21] Train acc: 0.986, loss: 0.054 | Test acc: 0.983, loss: 0.063 | Time: 0.99s
[Epoch 22] Train acc: 0.991, loss: 0.039 | Test acc: 0.986, loss: 0.050 | Time: 0.97s
[Epoch 23] Train acc: 0.989, loss: 0.043 | Test acc: 0.985, loss: 0.054 | Time: 1.00s
[Epoch 24] Train acc: 0.991, loss: 0.038 | Test acc: 0.986, loss: 0.049 | Time: 0.97s
[Epoch 25] Train acc: 0.990, loss: 0.042 | Test acc: 0.984, loss: 0.055 | Time: 0.98s
[Epoch 26] Train acc: 0.990, loss: 0.043 | Test acc: 0.984, loss: 0.058 | Time: 0.98s
[Epoch 27] Train acc: 0.988, loss: 0.046 | Test acc: 0.981, loss: 0.064 | Time: 0.98s
[Epoch 28] Train acc: 0.976, loss: 0.073 | Test acc: 0.974, loss: 0.090 | Time: 0.99s
[Epoch 29] Train acc: 0.991, loss: 0.037 | Test acc: 0.984, loss: 0.052 | Time: 0.99s
[Epoch 30] Train acc: 0.993, loss: 0.030 | Test acc: 0.987, loss: 0.045 | Time: 1.00s
[Epoch 31] Train acc: 0.991, loss: 0.035 | Test acc: 0.985, loss: 0.050 | Time: 1.00s
[Epoch 32] Train acc: 0.993, loss: 0.028 | Test acc: 0.986, loss: 0.045 | Time: 1.03s
[Epoch 33] Train acc: 0.989, loss: 0.039 | Test acc: 0.983, loss: 0.056 | Time: 1.02s
[Epoch 34] Train acc: 0.993, loss: 0.027 | Test acc: 0.986, loss: 0.045 | Time: 1.01s
[Epoch 35] Train acc: 0.994, loss: 0.024 | Test acc: 0.987, loss: 0.041 | Time: 1.00s
[Epoch 36] Train acc: 0.985, loss: 0.047 | Test acc: 0.980, loss: 0.068 | Time: 1.01s
[Epoch 37] Train acc: 0.981, loss: 0.056 | Test acc: 0.974, loss: 0.079 | Time: 1.02s
[Epoch 38] Train acc: 0.996, loss: 0.020 | Test acc: 0.988, loss: 0.037 | Time: 1.03s
[Epoch 39] Train acc: 0.995, loss: 0.022 | Test acc: 0.988, loss: 0.040 | Time: 1.05s
[Epoch 40] Train acc: 0.991, loss: 0.031 | Test acc: 0.984, loss: 0.051 | Time: 1.05s
Total training time: 64.75s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed2_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.930, loss: 0.235 | Test acc: 0.932, loss: 0.230 | Time: 2.63s
[Epoch 2] Train acc: 0.960, loss: 0.129 | Test acc: 0.959, loss: 0.131 | Time: 0.99s
[Epoch 3] Train acc: 0.928, loss: 0.209 | Test acc: 0.925, loss: 0.215 | Time: 1.00s
[Epoch 4] Train acc: 0.942, loss: 0.173 | Test acc: 0.940, loss: 0.185 | Time: 1.01s
[Epoch 5] Train acc: 0.982, loss: 0.057 | Test acc: 0.980, loss: 0.067 | Time: 1.01s
[Epoch 6] Train acc: 0.978, loss: 0.067 | Test acc: 0.972, loss: 0.082 | Time: 1.02s
[Epoch 7] Train acc: 0.988, loss: 0.039 | Test acc: 0.983, loss: 0.053 | Time: 1.02s
[Epoch 8] Train acc: 0.993, loss: 0.026 | Test acc: 0.986, loss: 0.042 | Time: 1.01s
[Epoch 9] Train acc: 0.993, loss: 0.024 | Test acc: 0.984, loss: 0.044 | Time: 1.01s
[Epoch 10] Train acc: 0.994, loss: 0.021 | Test acc: 0.986, loss: 0.042 | Time: 1.01s
[Epoch 11] Train acc: 0.994, loss: 0.018 | Test acc: 0.987, loss: 0.039 | Time: 1.01s
[Epoch 12] Train acc: 0.996, loss: 0.015 | Test acc: 0.989, loss: 0.037 | Time: 1.01s
[Epoch 13] Train acc: 0.993, loss: 0.021 | Test acc: 0.986, loss: 0.044 | Time: 1.02s
[Epoch 14] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.040 | Time: 1.01s
[Epoch 15] Train acc: 0.997, loss: 0.011 | Test acc: 0.990, loss: 0.034 | Time: 1.02s
[Epoch 16] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.036 | Time: 1.02s
[Epoch 17] Train acc: 0.998, loss: 0.009 | Test acc: 0.990, loss: 0.034 | Time: 1.02s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.031 | Time: 1.02s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.032 | Time: 1.04s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.030 | Time: 1.03s
[Epoch 21] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.030 | Time: 1.05s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.029 | Time: 1.06s
[Epoch 23] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.030 | Time: 1.05s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.030 | Time: 1.29s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.029 | Time: 1.05s
[Epoch 26] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.030 | Time: 1.06s
[Epoch 27] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.028 | Time: 1.06s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.029 | Time: 1.06s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.029 | Time: 1.07s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.031 | Time: 1.06s
[Epoch 31] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.030 | Time: 1.05s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.031 | Time: 1.06s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.030 | Time: 1.07s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.030 | Time: 1.07s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.030 | Time: 1.06s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.030 | Time: 1.08s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.029 | Time: 1.31s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.07s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.030 | Time: 1.12s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.029 | Time: 1.11s
Total training time: 69.34s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed2_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.942, loss: 0.171 | Test acc: 0.940, loss: 0.177 | Time: 2.91s
[Epoch 2] Train acc: 0.988, loss: 0.039 | Test acc: 0.985, loss: 0.047 | Time: 1.06s
[Epoch 3] Train acc: 0.989, loss: 0.037 | Test acc: 0.985, loss: 0.045 | Time: 1.08s
[Epoch 4] Train acc: 0.992, loss: 0.024 | Test acc: 0.986, loss: 0.038 | Time: 1.11s
[Epoch 5] Train acc: 0.990, loss: 0.031 | Test acc: 0.985, loss: 0.051 | Time: 1.08s
[Epoch 6] Train acc: 0.989, loss: 0.033 | Test acc: 0.985, loss: 0.052 | Time: 1.10s
[Epoch 7] Train acc: 0.995, loss: 0.016 | Test acc: 0.988, loss: 0.036 | Time: 1.09s
[Epoch 8] Train acc: 0.985, loss: 0.049 | Test acc: 0.979, loss: 0.084 | Time: 1.10s
[Epoch 9] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.052 | Time: 1.10s
[Epoch 10] Train acc: 0.993, loss: 0.023 | Test acc: 0.985, loss: 0.055 | Time: 1.10s
[Epoch 11] Train acc: 0.995, loss: 0.015 | Test acc: 0.987, loss: 0.042 | Time: 1.08s
[Epoch 12] Train acc: 0.995, loss: 0.016 | Test acc: 0.987, loss: 0.048 | Time: 1.09s
[Epoch 13] Train acc: 0.994, loss: 0.019 | Test acc: 0.985, loss: 0.057 | Time: 1.09s
[Epoch 14] Train acc: 0.992, loss: 0.027 | Test acc: 0.984, loss: 0.064 | Time: 1.09s
[Epoch 15] Train acc: 0.997, loss: 0.007 | Test acc: 0.990, loss: 0.040 | Time: 1.09s
[Epoch 16] Train acc: 0.996, loss: 0.013 | Test acc: 0.990, loss: 0.043 | Time: 1.10s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.041 | Time: 1.09s
[Epoch 18] Train acc: 0.994, loss: 0.021 | Test acc: 0.986, loss: 0.065 | Time: 1.11s
[Epoch 19] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.032 | Time: 1.10s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.044 | Time: 1.10s
[Epoch 21] Train acc: 0.997, loss: 0.008 | Test acc: 0.991, loss: 0.049 | Time: 1.12s
[Epoch 22] Train acc: 0.997, loss: 0.011 | Test acc: 0.990, loss: 0.047 | Time: 1.11s
[Epoch 23] Train acc: 0.997, loss: 0.008 | Test acc: 0.991, loss: 0.042 | Time: 1.13s
[Epoch 24] Train acc: 0.997, loss: 0.011 | Test acc: 0.990, loss: 0.058 | Time: 1.15s
[Epoch 25] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.044 | Time: 1.14s
[Epoch 26] Train acc: 0.992, loss: 0.024 | Test acc: 0.987, loss: 0.065 | Time: 1.15s
[Epoch 27] Train acc: 0.993, loss: 0.024 | Test acc: 0.986, loss: 0.062 | Time: 1.15s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.050 | Time: 1.15s
[Epoch 29] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.050 | Time: 1.16s
[Epoch 30] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.054 | Time: 1.15s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.039 | Time: 1.15s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.047 | Time: 1.15s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.040 | Time: 1.16s
[Epoch 34] Train acc: 0.998, loss: 0.008 | Test acc: 0.991, loss: 0.047 | Time: 1.18s
[Epoch 35] Train acc: 0.998, loss: 0.007 | Test acc: 0.992, loss: 0.049 | Time: 1.18s
[Epoch 36] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.053 | Time: 1.16s
[Epoch 37] Train acc: 0.997, loss: 0.009 | Test acc: 0.988, loss: 0.060 | Time: 1.18s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.055 | Time: 1.43s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.994, loss: 0.043 | Time: 1.28s
[Epoch 40] Train acc: 0.997, loss: 0.012 | Test acc: 0.990, loss: 0.062 | Time: 1.20s
Total training time: 72.43s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed2_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.976, loss: 0.074 | Test acc: 0.973, loss: 0.081 | Time: 3.06s
[Epoch 2] Train acc: 0.982, loss: 0.055 | Test acc: 0.980, loss: 0.061 | Time: 1.06s
[Epoch 3] Train acc: 0.985, loss: 0.048 | Test acc: 0.980, loss: 0.058 | Time: 1.09s
[Epoch 4] Train acc: 0.985, loss: 0.048 | Test acc: 0.980, loss: 0.061 | Time: 1.09s
[Epoch 5] Train acc: 0.991, loss: 0.027 | Test acc: 0.986, loss: 0.044 | Time: 1.09s
[Epoch 6] Train acc: 0.994, loss: 0.020 | Test acc: 0.989, loss: 0.035 | Time: 1.09s
[Epoch 7] Train acc: 0.993, loss: 0.023 | Test acc: 0.988, loss: 0.039 | Time: 1.09s
[Epoch 8] Train acc: 0.990, loss: 0.033 | Test acc: 0.982, loss: 0.067 | Time: 1.10s
[Epoch 9] Train acc: 0.996, loss: 0.014 | Test acc: 0.989, loss: 0.037 | Time: 1.09s
[Epoch 10] Train acc: 0.991, loss: 0.028 | Test acc: 0.984, loss: 0.056 | Time: 1.10s
[Epoch 11] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.042 | Time: 1.09s
[Epoch 12] Train acc: 0.993, loss: 0.023 | Test acc: 0.984, loss: 0.064 | Time: 1.10s
[Epoch 13] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.039 | Time: 1.10s
[Epoch 14] Train acc: 0.997, loss: 0.009 | Test acc: 0.992, loss: 0.034 | Time: 1.10s
[Epoch 15] Train acc: 0.997, loss: 0.011 | Test acc: 0.991, loss: 0.041 | Time: 1.10s
[Epoch 16] Train acc: 0.988, loss: 0.045 | Test acc: 0.983, loss: 0.087 | Time: 1.10s
[Epoch 17] Train acc: 0.993, loss: 0.019 | Test acc: 0.989, loss: 0.045 | Time: 1.10s
[Epoch 18] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.034 | Time: 1.09s
[Epoch 19] Train acc: 0.993, loss: 0.025 | Test acc: 0.985, loss: 0.064 | Time: 1.10s
[Epoch 20] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.038 | Time: 1.10s
[Epoch 21] Train acc: 0.995, loss: 0.017 | Test acc: 0.990, loss: 0.050 | Time: 1.10s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.034 | Time: 1.11s
[Epoch 23] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.048 | Time: 1.10s
[Epoch 24] Train acc: 0.996, loss: 0.013 | Test acc: 0.991, loss: 0.052 | Time: 1.10s
[Epoch 25] Train acc: 0.996, loss: 0.011 | Test acc: 0.988, loss: 0.057 | Time: 1.10s
[Epoch 26] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.044 | Time: 1.10s
[Epoch 27] Train acc: 0.998, loss: 0.008 | Test acc: 0.991, loss: 0.046 | Time: 1.11s
[Epoch 28] Train acc: 0.998, loss: 0.007 | Test acc: 0.992, loss: 0.049 | Time: 1.11s
[Epoch 29] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.049 | Time: 1.11s
[Epoch 30] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.039 | Time: 1.11s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.031 | Time: 1.12s
[Epoch 32] Train acc: 0.994, loss: 0.022 | Test acc: 0.984, loss: 0.070 | Time: 1.11s
[Epoch 33] Train acc: 0.996, loss: 0.014 | Test acc: 0.988, loss: 0.052 | Time: 1.13s
[Epoch 34] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.044 | Time: 1.12s
[Epoch 35] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.066 | Time: 1.13s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.034 | Time: 1.35s
[Epoch 37] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.048 | Time: 1.18s
[Epoch 38] Train acc: 0.999, loss: 0.002 | Test acc: 0.994, loss: 0.037 | Time: 1.19s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.042 | Time: 1.15s
[Epoch 40] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.049 | Time: 1.15s
Total training time: 70.71s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed2_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/Adam.learning_rate = 0.0003
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/FullES.recompute_samples = 100
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/GradientAccumulator.num_average = 20
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/HyperV2.param_inits = 256
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.lopt = @HyperV2()
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.num_estimators = 8
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.num_steps = 100000
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.staleness = 500
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.summary_every_n = 25
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/run_train.trainer_batch_size = 512
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__37ab1849_4a93_405a_9f78_64f39de80178/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.965, loss: 0.113 | Test acc: 0.960, loss: 0.124 | Time: 26.36s
[Epoch 2] Train acc: 0.985, loss: 0.047 | Test acc: 0.981, loss: 0.058 | Time: 1.95s
[Epoch 3] Train acc: 0.992, loss: 0.025 | Test acc: 0.989, loss: 0.039 | Time: 2.07s
[Epoch 4] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.039 | Time: 2.06s
[Epoch 5] Train acc: 0.993, loss: 0.020 | Test acc: 0.988, loss: 0.041 | Time: 2.07s
[Epoch 6] Train acc: 0.993, loss: 0.020 | Test acc: 0.989, loss: 0.043 | Time: 2.07s
[Epoch 7] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.042 | Time: 2.08s
[Epoch 8] Train acc: 0.987, loss: 0.038 | Test acc: 0.982, loss: 0.070 | Time: 2.07s
[Epoch 9] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.043 | Time: 2.08s
[Epoch 10] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.047 | Time: 2.07s
[Epoch 11] Train acc: 0.994, loss: 0.017 | Test acc: 0.988, loss: 0.047 | Time: 2.07s
[Epoch 12] Train acc: 0.993, loss: 0.021 | Test acc: 0.986, loss: 0.058 | Time: 2.07s
[Epoch 13] Train acc: 0.996, loss: 0.014 | Test acc: 0.988, loss: 0.040 | Time: 2.04s
[Epoch 14] Train acc: 0.991, loss: 0.028 | Test acc: 0.984, loss: 0.066 | Time: 2.07s
[Epoch 15] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.038 | Time: 2.06s
[Epoch 16] Train acc: 0.995, loss: 0.014 | Test acc: 0.988, loss: 0.042 | Time: 2.07s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.041 | Time: 2.05s
[Epoch 18] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.045 | Time: 2.08s
[Epoch 19] Train acc: 0.997, loss: 0.007 | Test acc: 0.991, loss: 0.038 | Time: 2.05s
[Epoch 20] Train acc: 0.996, loss: 0.010 | Test acc: 0.990, loss: 0.043 | Time: 2.08s
[Epoch 21] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.043 | Time: 2.07s
[Epoch 22] Train acc: 0.997, loss: 0.007 | Test acc: 0.990, loss: 0.045 | Time: 2.08s
[Epoch 23] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.041 | Time: 2.08s
[Epoch 24] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.047 | Time: 2.08s
[Epoch 25] Train acc: 0.998, loss: 0.004 | Test acc: 0.991, loss: 0.043 | Time: 2.06s
[Epoch 26] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.051 | Time: 2.07s
[Epoch 27] Train acc: 0.998, loss: 0.007 | Test acc: 0.992, loss: 0.040 | Time: 2.07s
[Epoch 28] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.050 | Time: 2.07s
[Epoch 29] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.046 | Time: 2.05s
[Epoch 30] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.045 | Time: 2.06s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.044 | Time: 2.08s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.040 | Time: 2.08s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.047 | Time: 2.09s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.049 | Time: 2.09s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.044 | Time: 2.08s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.044 | Time: 2.11s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.043 | Time: 2.09s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.047 | Time: 2.10s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.044 | Time: 2.11s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.045 | Time: 2.09s
Total training time: 131.97s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed3_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.368, loss: 1.860 | Test acc: 0.361, loss: 1.863 | Time: 2.61s
[Epoch 2] Train acc: 0.552, loss: 1.519 | Test acc: 0.549, loss: 1.518 | Time: 0.95s
[Epoch 3] Train acc: 0.762, loss: 1.018 | Test acc: 0.763, loss: 1.018 | Time: 0.97s
[Epoch 4] Train acc: 0.900, loss: 0.544 | Test acc: 0.907, loss: 0.543 | Time: 0.97s
[Epoch 5] Train acc: 0.937, loss: 0.326 | Test acc: 0.937, loss: 0.324 | Time: 0.98s
[Epoch 6] Train acc: 0.958, loss: 0.213 | Test acc: 0.959, loss: 0.211 | Time: 0.97s
[Epoch 7] Train acc: 0.963, loss: 0.171 | Test acc: 0.964, loss: 0.173 | Time: 0.97s
[Epoch 8] Train acc: 0.960, loss: 0.165 | Test acc: 0.959, loss: 0.169 | Time: 0.96s
[Epoch 9] Train acc: 0.970, loss: 0.123 | Test acc: 0.969, loss: 0.125 | Time: 0.96s
[Epoch 10] Train acc: 0.974, loss: 0.111 | Test acc: 0.971, loss: 0.115 | Time: 0.97s
[Epoch 11] Train acc: 0.977, loss: 0.097 | Test acc: 0.975, loss: 0.100 | Time: 0.97s
[Epoch 12] Train acc: 0.978, loss: 0.089 | Test acc: 0.976, loss: 0.093 | Time: 0.97s
[Epoch 13] Train acc: 0.981, loss: 0.075 | Test acc: 0.980, loss: 0.081 | Time: 0.96s
[Epoch 14] Train acc: 0.979, loss: 0.082 | Test acc: 0.976, loss: 0.091 | Time: 0.97s
[Epoch 15] Train acc: 0.981, loss: 0.076 | Test acc: 0.978, loss: 0.085 | Time: 0.97s
[Epoch 16] Train acc: 0.984, loss: 0.062 | Test acc: 0.981, loss: 0.070 | Time: 0.98s
[Epoch 17] Train acc: 0.987, loss: 0.055 | Test acc: 0.983, loss: 0.065 | Time: 0.99s
[Epoch 18] Train acc: 0.986, loss: 0.056 | Test acc: 0.983, loss: 0.066 | Time: 0.97s
[Epoch 19] Train acc: 0.987, loss: 0.052 | Test acc: 0.983, loss: 0.062 | Time: 0.98s
[Epoch 20] Train acc: 0.975, loss: 0.091 | Test acc: 0.974, loss: 0.099 | Time: 0.98s
[Epoch 21] Train acc: 0.981, loss: 0.067 | Test acc: 0.978, loss: 0.079 | Time: 0.99s
[Epoch 22] Train acc: 0.984, loss: 0.056 | Test acc: 0.980, loss: 0.068 | Time: 0.98s
[Epoch 23] Train acc: 0.984, loss: 0.056 | Test acc: 0.981, loss: 0.070 | Time: 0.99s
[Epoch 24] Train acc: 0.983, loss: 0.057 | Test acc: 0.979, loss: 0.071 | Time: 0.98s
[Epoch 25] Train acc: 0.986, loss: 0.048 | Test acc: 0.981, loss: 0.063 | Time: 0.99s
[Epoch 26] Train acc: 0.986, loss: 0.050 | Test acc: 0.980, loss: 0.067 | Time: 0.99s
[Epoch 27] Train acc: 0.983, loss: 0.059 | Test acc: 0.976, loss: 0.077 | Time: 1.00s
[Epoch 28] Train acc: 0.987, loss: 0.048 | Test acc: 0.980, loss: 0.065 | Time: 1.01s
[Epoch 29] Train acc: 0.986, loss: 0.050 | Test acc: 0.980, loss: 0.066 | Time: 1.05s
[Epoch 30] Train acc: 0.991, loss: 0.036 | Test acc: 0.985, loss: 0.055 | Time: 1.00s
[Epoch 31] Train acc: 0.990, loss: 0.040 | Test acc: 0.983, loss: 0.060 | Time: 1.00s
[Epoch 32] Train acc: 0.987, loss: 0.046 | Test acc: 0.980, loss: 0.065 | Time: 1.02s
[Epoch 33] Train acc: 0.967, loss: 0.102 | Test acc: 0.958, loss: 0.124 | Time: 1.03s
[Epoch 34] Train acc: 0.993, loss: 0.028 | Test acc: 0.986, loss: 0.047 | Time: 1.02s
[Epoch 35] Train acc: 0.990, loss: 0.036 | Test acc: 0.981, loss: 0.056 | Time: 1.02s
[Epoch 36] Train acc: 0.992, loss: 0.029 | Test acc: 0.985, loss: 0.049 | Time: 1.03s
[Epoch 37] Train acc: 0.986, loss: 0.044 | Test acc: 0.978, loss: 0.068 | Time: 1.04s
[Epoch 38] Train acc: 0.995, loss: 0.021 | Test acc: 0.987, loss: 0.042 | Time: 1.04s
[Epoch 39] Train acc: 0.988, loss: 0.040 | Test acc: 0.982, loss: 0.064 | Time: 1.05s
[Epoch 40] Train acc: 0.989, loss: 0.036 | Test acc: 0.982, loss: 0.060 | Time: 1.06s
Total training time: 65.67s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed3_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.947, loss: 0.189 | Test acc: 0.948, loss: 0.187 | Time: 2.69s
[Epoch 2] Train acc: 0.951, loss: 0.157 | Test acc: 0.954, loss: 0.158 | Time: 1.00s
[Epoch 3] Train acc: 0.962, loss: 0.123 | Test acc: 0.962, loss: 0.129 | Time: 1.01s
[Epoch 4] Train acc: 0.947, loss: 0.167 | Test acc: 0.946, loss: 0.177 | Time: 1.02s
[Epoch 5] Train acc: 0.966, loss: 0.107 | Test acc: 0.964, loss: 0.121 | Time: 1.02s
[Epoch 6] Train acc: 0.978, loss: 0.066 | Test acc: 0.976, loss: 0.082 | Time: 1.03s
[Epoch 7] Train acc: 0.992, loss: 0.028 | Test acc: 0.985, loss: 0.045 | Time: 1.02s
[Epoch 8] Train acc: 0.993, loss: 0.023 | Test acc: 0.987, loss: 0.041 | Time: 1.02s
[Epoch 9] Train acc: 0.994, loss: 0.022 | Test acc: 0.986, loss: 0.044 | Time: 1.03s
[Epoch 10] Train acc: 0.995, loss: 0.017 | Test acc: 0.987, loss: 0.037 | Time: 1.03s
[Epoch 11] Train acc: 0.993, loss: 0.022 | Test acc: 0.984, loss: 0.048 | Time: 1.03s
[Epoch 12] Train acc: 0.996, loss: 0.012 | Test acc: 0.988, loss: 0.033 | Time: 1.03s
[Epoch 13] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.040 | Time: 1.03s
[Epoch 14] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.032 | Time: 1.02s
[Epoch 15] Train acc: 0.998, loss: 0.008 | Test acc: 0.989, loss: 0.034 | Time: 1.04s
[Epoch 16] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.037 | Time: 1.02s
[Epoch 17] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.034 | Time: 1.01s
[Epoch 18] Train acc: 0.998, loss: 0.008 | Test acc: 0.988, loss: 0.035 | Time: 1.02s
[Epoch 19] Train acc: 0.999, loss: 0.006 | Test acc: 0.989, loss: 0.033 | Time: 1.02s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.032 | Time: 1.03s
[Epoch 21] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.033 | Time: 1.02s
[Epoch 22] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.028 | Time: 1.05s
[Epoch 23] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.033 | Time: 1.03s
[Epoch 24] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.028 | Time: 1.03s
[Epoch 25] Train acc: 1.000, loss: 0.003 | Test acc: 0.990, loss: 0.033 | Time: 1.03s
[Epoch 26] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.028 | Time: 1.03s
[Epoch 27] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.031 | Time: 1.04s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.028 | Time: 1.19s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.030 | Time: 1.11s
[Epoch 30] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.030 | Time: 1.05s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.05s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.07s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.09s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.09s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.06s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.028 | Time: 1.10s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.12s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.028 | Time: 1.09s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.028 | Time: 1.12s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.028 | Time: 1.09s
Total training time: 69.21s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed3_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.976, loss: 0.073 | Test acc: 0.973, loss: 0.081 | Time: 2.91s
[Epoch 2] Train acc: 0.990, loss: 0.035 | Test acc: 0.986, loss: 0.043 | Time: 1.05s
[Epoch 3] Train acc: 0.989, loss: 0.035 | Test acc: 0.985, loss: 0.049 | Time: 1.06s
[Epoch 4] Train acc: 0.991, loss: 0.028 | Test acc: 0.985, loss: 0.046 | Time: 1.08s
[Epoch 5] Train acc: 0.993, loss: 0.020 | Test acc: 0.988, loss: 0.036 | Time: 1.07s
[Epoch 6] Train acc: 0.992, loss: 0.023 | Test acc: 0.985, loss: 0.050 | Time: 1.08s
[Epoch 7] Train acc: 0.992, loss: 0.025 | Test acc: 0.986, loss: 0.047 | Time: 1.07s
[Epoch 8] Train acc: 0.985, loss: 0.044 | Test acc: 0.979, loss: 0.077 | Time: 1.19s
[Epoch 9] Train acc: 0.994, loss: 0.019 | Test acc: 0.985, loss: 0.053 | Time: 1.12s
[Epoch 10] Train acc: 0.993, loss: 0.023 | Test acc: 0.986, loss: 0.056 | Time: 1.15s
[Epoch 11] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.040 | Time: 1.11s
[Epoch 12] Train acc: 0.972, loss: 0.101 | Test acc: 0.963, loss: 0.146 | Time: 1.15s
[Epoch 13] Train acc: 0.992, loss: 0.023 | Test acc: 0.984, loss: 0.066 | Time: 1.15s
[Epoch 14] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.044 | Time: 1.15s
[Epoch 15] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.046 | Time: 1.12s
[Epoch 16] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.054 | Time: 1.13s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.992, loss: 0.043 | Time: 1.14s
[Epoch 18] Train acc: 0.998, loss: 0.008 | Test acc: 0.991, loss: 0.040 | Time: 1.15s
[Epoch 19] Train acc: 0.997, loss: 0.008 | Test acc: 0.989, loss: 0.042 | Time: 1.15s
[Epoch 20] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.047 | Time: 1.14s
[Epoch 21] Train acc: 0.996, loss: 0.011 | Test acc: 0.991, loss: 0.047 | Time: 1.13s
[Epoch 22] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.037 | Time: 1.21s
[Epoch 23] Train acc: 0.987, loss: 0.046 | Test acc: 0.980, loss: 0.110 | Time: 1.15s
[Epoch 24] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.049 | Time: 1.19s
[Epoch 25] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.055 | Time: 1.16s
[Epoch 26] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.035 | Time: 1.18s
[Epoch 27] Train acc: 0.997, loss: 0.007 | Test acc: 0.992, loss: 0.041 | Time: 1.16s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.044 | Time: 1.16s
[Epoch 29] Train acc: 0.998, loss: 0.004 | Test acc: 0.992, loss: 0.043 | Time: 1.19s
[Epoch 30] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.046 | Time: 1.18s
[Epoch 31] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.048 | Time: 1.18s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.039 | Time: 1.16s
[Epoch 33] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.051 | Time: 1.21s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.040 | Time: 1.20s
[Epoch 35] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.049 | Time: 1.20s
[Epoch 36] Train acc: 1.000, loss: 0.002 | Test acc: 0.992, loss: 0.044 | Time: 1.22s
[Epoch 37] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.045 | Time: 1.22s
[Epoch 38] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.053 | Time: 1.21s
[Epoch 39] Train acc: 0.995, loss: 0.019 | Test acc: 0.986, loss: 0.075 | Time: 1.21s
[Epoch 40] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.041 | Time: 1.18s
Total training time: 72.16s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed3_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.977, loss: 0.076 | Test acc: 0.973, loss: 0.085 | Time: 3.05s
[Epoch 2] Train acc: 0.988, loss: 0.036 | Test acc: 0.985, loss: 0.046 | Time: 1.07s
[Epoch 3] Train acc: 0.972, loss: 0.086 | Test acc: 0.971, loss: 0.094 | Time: 1.09s
[Epoch 4] Train acc: 0.980, loss: 0.060 | Test acc: 0.978, loss: 0.072 | Time: 1.10s
[Epoch 5] Train acc: 0.991, loss: 0.027 | Test acc: 0.987, loss: 0.043 | Time: 1.09s
[Epoch 6] Train acc: 0.984, loss: 0.049 | Test acc: 0.977, loss: 0.072 | Time: 1.09s
[Epoch 7] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.040 | Time: 1.10s
[Epoch 8] Train acc: 0.986, loss: 0.044 | Test acc: 0.979, loss: 0.082 | Time: 1.10s
[Epoch 9] Train acc: 0.991, loss: 0.027 | Test acc: 0.985, loss: 0.063 | Time: 1.10s
[Epoch 10] Train acc: 0.993, loss: 0.022 | Test acc: 0.985, loss: 0.056 | Time: 1.10s
[Epoch 11] Train acc: 0.994, loss: 0.021 | Test acc: 0.985, loss: 0.063 | Time: 1.09s
[Epoch 12] Train acc: 0.995, loss: 0.015 | Test acc: 0.987, loss: 0.055 | Time: 1.10s
[Epoch 13] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.041 | Time: 1.09s
[Epoch 14] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.048 | Time: 1.10s
[Epoch 15] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.049 | Time: 1.10s
[Epoch 16] Train acc: 0.997, loss: 0.010 | Test acc: 0.991, loss: 0.044 | Time: 1.10s
[Epoch 17] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.043 | Time: 1.10s
[Epoch 18] Train acc: 0.995, loss: 0.015 | Test acc: 0.990, loss: 0.045 | Time: 1.10s
[Epoch 19] Train acc: 0.991, loss: 0.034 | Test acc: 0.983, loss: 0.074 | Time: 1.10s
[Epoch 20] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.034 | Time: 1.11s
[Epoch 21] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.047 | Time: 1.11s
[Epoch 22] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.042 | Time: 1.10s
[Epoch 23] Train acc: 0.998, loss: 0.007 | Test acc: 0.992, loss: 0.045 | Time: 1.11s
[Epoch 24] Train acc: 0.993, loss: 0.025 | Test acc: 0.985, loss: 0.076 | Time: 1.12s
[Epoch 25] Train acc: 0.997, loss: 0.008 | Test acc: 0.989, loss: 0.056 | Time: 1.11s
[Epoch 26] Train acc: 0.995, loss: 0.015 | Test acc: 0.987, loss: 0.062 | Time: 1.11s
[Epoch 27] Train acc: 0.994, loss: 0.021 | Test acc: 0.988, loss: 0.070 | Time: 1.11s
[Epoch 28] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.045 | Time: 1.11s
[Epoch 29] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.057 | Time: 1.11s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.046 | Time: 1.36s
[Epoch 31] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.046 | Time: 1.17s
[Epoch 32] Train acc: 0.997, loss: 0.013 | Test acc: 0.987, loss: 0.067 | Time: 1.17s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.040 | Time: 1.24s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.043 | Time: 1.22s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.043 | Time: 1.16s
[Epoch 36] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.061 | Time: 1.17s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.041 | Time: 1.18s
[Epoch 38] Train acc: 0.997, loss: 0.010 | Test acc: 0.992, loss: 0.050 | Time: 1.18s
[Epoch 39] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.055 | Time: 1.21s
[Epoch 40] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.061 | Time: 1.20s
Total training time: 72.35s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed3_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/Adam.learning_rate = 0.0003
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/FullES.recompute_samples = 100
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/GradientAccumulator.num_average = 20
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/HyperV2.param_inits = 256
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.lopt = @HyperV2()
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.num_estimators = 8
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.num_steps = 100000
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.staleness = 500
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.summary_every_n = 25
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/run_train.trainer_batch_size = 512
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__5968ba0c_72ec_4ee8_a907_dbfa4f840046/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.980, loss: 0.063 | Test acc: 0.977, loss: 0.076 | Time: 25.30s
[Epoch 2] Train acc: 0.985, loss: 0.049 | Test acc: 0.981, loss: 0.064 | Time: 1.88s
[Epoch 3] Train acc: 0.990, loss: 0.033 | Test acc: 0.985, loss: 0.052 | Time: 1.95s
[Epoch 4] Train acc: 0.992, loss: 0.024 | Test acc: 0.986, loss: 0.045 | Time: 1.92s
[Epoch 5] Train acc: 0.993, loss: 0.019 | Test acc: 0.986, loss: 0.046 | Time: 1.94s
[Epoch 6] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.045 | Time: 1.94s
[Epoch 7] Train acc: 0.993, loss: 0.020 | Test acc: 0.986, loss: 0.050 | Time: 1.91s
[Epoch 8] Train acc: 0.992, loss: 0.023 | Test acc: 0.987, loss: 0.054 | Time: 1.93s
[Epoch 9] Train acc: 0.996, loss: 0.014 | Test acc: 0.990, loss: 0.040 | Time: 1.94s
[Epoch 10] Train acc: 0.991, loss: 0.028 | Test acc: 0.986, loss: 0.055 | Time: 1.93s
[Epoch 11] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.042 | Time: 1.94s
[Epoch 12] Train acc: 0.994, loss: 0.016 | Test acc: 0.989, loss: 0.042 | Time: 1.94s
[Epoch 13] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.045 | Time: 1.92s
[Epoch 14] Train acc: 0.995, loss: 0.013 | Test acc: 0.989, loss: 0.045 | Time: 1.96s
[Epoch 15] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.048 | Time: 1.95s
[Epoch 16] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.043 | Time: 1.92s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.049 | Time: 1.94s
[Epoch 18] Train acc: 0.996, loss: 0.010 | Test acc: 0.989, loss: 0.048 | Time: 1.94s
[Epoch 19] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.043 | Time: 1.96s
[Epoch 20] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.034 | Time: 1.97s
[Epoch 21] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.049 | Time: 1.96s
[Epoch 22] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.039 | Time: 1.96s
[Epoch 23] Train acc: 0.996, loss: 0.010 | Test acc: 0.990, loss: 0.042 | Time: 1.97s
[Epoch 24] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.048 | Time: 1.97s
[Epoch 25] Train acc: 0.998, loss: 0.004 | Test acc: 0.992, loss: 0.039 | Time: 1.96s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.041 | Time: 1.96s
[Epoch 27] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.046 | Time: 1.96s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.048 | Time: 1.98s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.054 | Time: 1.97s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.049 | Time: 1.98s
[Epoch 31] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.055 | Time: 1.96s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.041 | Time: 1.97s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.035 | Time: 1.98s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.052 | Time: 1.98s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.054 | Time: 1.98s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.049 | Time: 1.99s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.051 | Time: 2.12s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.042 | Time: 2.11s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.046 | Time: 2.14s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.045 | Time: 2.14s
Total training time: 126.02s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed4_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.387, loss: 1.868 | Test acc: 0.387, loss: 1.868 | Time: 2.56s
[Epoch 2] Train acc: 0.520, loss: 1.556 | Test acc: 0.518, loss: 1.554 | Time: 0.94s
[Epoch 3] Train acc: 0.715, loss: 1.173 | Test acc: 0.722, loss: 1.171 | Time: 0.96s
[Epoch 4] Train acc: 0.850, loss: 0.704 | Test acc: 0.850, loss: 0.702 | Time: 0.97s
[Epoch 5] Train acc: 0.921, loss: 0.408 | Test acc: 0.923, loss: 0.405 | Time: 0.97s
[Epoch 6] Train acc: 0.944, loss: 0.273 | Test acc: 0.950, loss: 0.270 | Time: 0.97s
[Epoch 7] Train acc: 0.957, loss: 0.198 | Test acc: 0.960, loss: 0.199 | Time: 0.96s
[Epoch 8] Train acc: 0.926, loss: 0.260 | Test acc: 0.927, loss: 0.263 | Time: 0.97s
[Epoch 9] Train acc: 0.962, loss: 0.150 | Test acc: 0.964, loss: 0.152 | Time: 0.96s
[Epoch 10] Train acc: 0.971, loss: 0.120 | Test acc: 0.967, loss: 0.127 | Time: 0.97s
[Epoch 11] Train acc: 0.971, loss: 0.114 | Test acc: 0.966, loss: 0.124 | Time: 0.97s
[Epoch 12] Train acc: 0.975, loss: 0.099 | Test acc: 0.971, loss: 0.110 | Time: 0.96s
[Epoch 13] Train acc: 0.977, loss: 0.092 | Test acc: 0.973, loss: 0.103 | Time: 0.96s
[Epoch 14] Train acc: 0.979, loss: 0.084 | Test acc: 0.973, loss: 0.095 | Time: 0.97s
[Epoch 15] Train acc: 0.982, loss: 0.072 | Test acc: 0.976, loss: 0.086 | Time: 0.97s
[Epoch 16] Train acc: 0.984, loss: 0.063 | Test acc: 0.978, loss: 0.075 | Time: 0.96s
[Epoch 17] Train acc: 0.986, loss: 0.058 | Test acc: 0.980, loss: 0.070 | Time: 0.96s
[Epoch 18] Train acc: 0.974, loss: 0.088 | Test acc: 0.969, loss: 0.105 | Time: 0.97s
[Epoch 19] Train acc: 0.980, loss: 0.069 | Test acc: 0.975, loss: 0.083 | Time: 0.97s
[Epoch 20] Train acc: 0.972, loss: 0.093 | Test acc: 0.969, loss: 0.106 | Time: 0.97s
[Epoch 21] Train acc: 0.986, loss: 0.055 | Test acc: 0.982, loss: 0.067 | Time: 0.97s
[Epoch 22] Train acc: 0.987, loss: 0.049 | Test acc: 0.982, loss: 0.064 | Time: 0.97s
[Epoch 23] Train acc: 0.984, loss: 0.057 | Test acc: 0.979, loss: 0.071 | Time: 0.97s
[Epoch 24] Train acc: 0.989, loss: 0.043 | Test acc: 0.983, loss: 0.058 | Time: 0.97s
[Epoch 25] Train acc: 0.990, loss: 0.042 | Test acc: 0.983, loss: 0.058 | Time: 0.97s
[Epoch 26] Train acc: 0.988, loss: 0.044 | Test acc: 0.979, loss: 0.062 | Time: 0.97s
[Epoch 27] Train acc: 0.989, loss: 0.041 | Test acc: 0.982, loss: 0.060 | Time: 0.96s
[Epoch 28] Train acc: 0.987, loss: 0.047 | Test acc: 0.979, loss: 0.065 | Time: 0.98s
[Epoch 29] Train acc: 0.991, loss: 0.035 | Test acc: 0.983, loss: 0.053 | Time: 0.97s
[Epoch 30] Train acc: 0.992, loss: 0.031 | Test acc: 0.987, loss: 0.047 | Time: 0.98s
[Epoch 31] Train acc: 0.992, loss: 0.032 | Test acc: 0.985, loss: 0.050 | Time: 0.98s
[Epoch 32] Train acc: 0.993, loss: 0.029 | Test acc: 0.984, loss: 0.047 | Time: 0.97s
[Epoch 33] Train acc: 0.988, loss: 0.042 | Test acc: 0.979, loss: 0.064 | Time: 0.99s
[Epoch 34] Train acc: 0.994, loss: 0.026 | Test acc: 0.985, loss: 0.045 | Time: 1.00s
[Epoch 35] Train acc: 0.993, loss: 0.027 | Test acc: 0.985, loss: 0.047 | Time: 1.00s
[Epoch 36] Train acc: 0.985, loss: 0.048 | Test acc: 0.978, loss: 0.071 | Time: 1.00s
[Epoch 37] Train acc: 0.989, loss: 0.036 | Test acc: 0.981, loss: 0.059 | Time: 1.02s
[Epoch 38] Train acc: 0.994, loss: 0.025 | Test acc: 0.985, loss: 0.045 | Time: 1.02s
[Epoch 39] Train acc: 0.989, loss: 0.036 | Test acc: 0.981, loss: 0.059 | Time: 1.04s
[Epoch 40] Train acc: 0.991, loss: 0.031 | Test acc: 0.985, loss: 0.051 | Time: 1.02s
Total training time: 64.04s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed4_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.906, loss: 0.301 | Test acc: 0.915, loss: 0.295 | Time: 2.64s
[Epoch 2] Train acc: 0.961, loss: 0.128 | Test acc: 0.958, loss: 0.135 | Time: 1.04s
[Epoch 3] Train acc: 0.977, loss: 0.079 | Test acc: 0.972, loss: 0.087 | Time: 1.03s
[Epoch 4] Train acc: 0.978, loss: 0.072 | Test acc: 0.975, loss: 0.080 | Time: 1.05s
[Epoch 5] Train acc: 0.981, loss: 0.062 | Test acc: 0.978, loss: 0.072 | Time: 1.05s
[Epoch 6] Train acc: 0.988, loss: 0.039 | Test acc: 0.984, loss: 0.052 | Time: 1.06s
[Epoch 7] Train acc: 0.994, loss: 0.023 | Test acc: 0.988, loss: 0.036 | Time: 1.07s
[Epoch 8] Train acc: 0.994, loss: 0.021 | Test acc: 0.986, loss: 0.036 | Time: 1.05s
[Epoch 9] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.033 | Time: 1.06s
[Epoch 10] Train acc: 0.996, loss: 0.015 | Test acc: 0.987, loss: 0.034 | Time: 1.06s
[Epoch 11] Train acc: 0.996, loss: 0.014 | Test acc: 0.988, loss: 0.035 | Time: 1.08s
[Epoch 12] Train acc: 0.997, loss: 0.013 | Test acc: 0.989, loss: 0.035 | Time: 1.05s
[Epoch 13] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.038 | Time: 1.05s
[Epoch 14] Train acc: 0.995, loss: 0.016 | Test acc: 0.987, loss: 0.040 | Time: 1.06s
[Epoch 15] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.034 | Time: 1.06s
[Epoch 16] Train acc: 0.993, loss: 0.019 | Test acc: 0.986, loss: 0.045 | Time: 1.06s
[Epoch 17] Train acc: 0.998, loss: 0.008 | Test acc: 0.990, loss: 0.031 | Time: 1.07s
[Epoch 18] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.036 | Time: 1.08s
[Epoch 19] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.030 | Time: 1.10s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.034 | Time: 1.08s
[Epoch 21] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.031 | Time: 1.07s
[Epoch 22] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.033 | Time: 1.32s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.030 | Time: 1.08s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.032 | Time: 1.10s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.032 | Time: 1.09s
[Epoch 26] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.033 | Time: 1.09s
[Epoch 27] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.030 | Time: 1.08s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.033 | Time: 1.25s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.031 | Time: 1.12s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.033 | Time: 1.09s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.031 | Time: 1.08s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.032 | Time: 1.10s
[Epoch 33] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.032 | Time: 1.09s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.030 | Time: 1.07s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.032 | Time: 1.10s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.030 | Time: 1.28s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.032 | Time: 1.13s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.031 | Time: 1.16s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.031 | Time: 1.12s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.030 | Time: 1.11s
Total training time: 71.86s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed4_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.977, loss: 0.071 | Test acc: 0.977, loss: 0.072 | Time: 2.96s
[Epoch 2] Train acc: 0.986, loss: 0.047 | Test acc: 0.984, loss: 0.054 | Time: 1.06s
[Epoch 3] Train acc: 0.988, loss: 0.039 | Test acc: 0.985, loss: 0.055 | Time: 1.09s
[Epoch 4] Train acc: 0.989, loss: 0.032 | Test acc: 0.983, loss: 0.049 | Time: 1.09s
[Epoch 5] Train acc: 0.986, loss: 0.044 | Test acc: 0.981, loss: 0.062 | Time: 1.09s
[Epoch 6] Train acc: 0.991, loss: 0.026 | Test acc: 0.987, loss: 0.046 | Time: 1.11s
[Epoch 7] Train acc: 0.993, loss: 0.021 | Test acc: 0.988, loss: 0.042 | Time: 1.10s
[Epoch 8] Train acc: 0.991, loss: 0.028 | Test acc: 0.985, loss: 0.058 | Time: 1.09s
[Epoch 9] Train acc: 0.995, loss: 0.017 | Test acc: 0.989, loss: 0.040 | Time: 1.11s
[Epoch 10] Train acc: 0.993, loss: 0.020 | Test acc: 0.989, loss: 0.043 | Time: 1.10s
[Epoch 11] Train acc: 0.995, loss: 0.016 | Test acc: 0.989, loss: 0.047 | Time: 1.09s
[Epoch 12] Train acc: 0.992, loss: 0.025 | Test acc: 0.987, loss: 0.054 | Time: 1.10s
[Epoch 13] Train acc: 0.996, loss: 0.012 | Test acc: 0.991, loss: 0.037 | Time: 1.10s
[Epoch 14] Train acc: 0.991, loss: 0.029 | Test acc: 0.984, loss: 0.066 | Time: 1.09s
[Epoch 15] Train acc: 0.998, loss: 0.007 | Test acc: 0.992, loss: 0.037 | Time: 1.10s
[Epoch 16] Train acc: 0.997, loss: 0.008 | Test acc: 0.992, loss: 0.033 | Time: 1.09s
[Epoch 17] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.044 | Time: 1.10s
[Epoch 18] Train acc: 0.995, loss: 0.017 | Test acc: 0.990, loss: 0.046 | Time: 1.10s
[Epoch 19] Train acc: 0.989, loss: 0.038 | Test acc: 0.984, loss: 0.084 | Time: 1.10s
[Epoch 20] Train acc: 0.997, loss: 0.008 | Test acc: 0.991, loss: 0.043 | Time: 1.10s
[Epoch 21] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.047 | Time: 1.11s
[Epoch 22] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.041 | Time: 1.10s
[Epoch 23] Train acc: 0.992, loss: 0.026 | Test acc: 0.985, loss: 0.069 | Time: 1.12s
[Epoch 24] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.041 | Time: 1.13s
[Epoch 25] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.045 | Time: 1.14s
[Epoch 26] Train acc: 0.995, loss: 0.017 | Test acc: 0.987, loss: 0.065 | Time: 1.12s
[Epoch 27] Train acc: 0.995, loss: 0.020 | Test acc: 0.988, loss: 0.064 | Time: 1.39s
[Epoch 28] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.050 | Time: 1.17s
[Epoch 29] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.047 | Time: 1.18s
[Epoch 30] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.043 | Time: 1.16s
[Epoch 31] Train acc: 0.998, loss: 0.006 | Test acc: 0.993, loss: 0.047 | Time: 1.15s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.041 | Time: 1.14s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.994, loss: 0.035 | Time: 1.17s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.041 | Time: 1.17s
[Epoch 35] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.038 | Time: 1.17s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.038 | Time: 1.17s
[Epoch 37] Train acc: 0.995, loss: 0.017 | Test acc: 0.989, loss: 0.073 | Time: 1.18s
[Epoch 38] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.048 | Time: 1.17s
[Epoch 39] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.041 | Time: 1.18s
[Epoch 40] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.041 | Time: 1.19s
Total training time: 72.29s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed4_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.979, loss: 0.068 | Test acc: 0.979, loss: 0.071 | Time: 2.91s
[Epoch 2] Train acc: 0.987, loss: 0.043 | Test acc: 0.985, loss: 0.051 | Time: 1.06s
[Epoch 3] Train acc: 0.990, loss: 0.030 | Test acc: 0.987, loss: 0.041 | Time: 1.07s
[Epoch 4] Train acc: 0.986, loss: 0.045 | Test acc: 0.981, loss: 0.064 | Time: 1.08s
[Epoch 5] Train acc: 0.992, loss: 0.024 | Test acc: 0.987, loss: 0.042 | Time: 1.08s
[Epoch 6] Train acc: 0.990, loss: 0.032 | Test acc: 0.986, loss: 0.047 | Time: 1.08s
[Epoch 7] Train acc: 0.989, loss: 0.036 | Test acc: 0.985, loss: 0.062 | Time: 1.09s
[Epoch 8] Train acc: 0.992, loss: 0.027 | Test acc: 0.986, loss: 0.051 | Time: 1.08s
[Epoch 9] Train acc: 0.995, loss: 0.014 | Test acc: 0.990, loss: 0.037 | Time: 1.08s
[Epoch 10] Train acc: 0.989, loss: 0.040 | Test acc: 0.983, loss: 0.066 | Time: 1.31s
[Epoch 11] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.054 | Time: 1.12s
[Epoch 12] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.044 | Time: 1.15s
[Epoch 13] Train acc: 0.994, loss: 0.017 | Test acc: 0.989, loss: 0.046 | Time: 1.18s
[Epoch 14] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.041 | Time: 1.08s
[Epoch 15] Train acc: 0.992, loss: 0.024 | Test acc: 0.987, loss: 0.058 | Time: 1.09s
[Epoch 16] Train acc: 0.995, loss: 0.016 | Test acc: 0.990, loss: 0.053 | Time: 1.09s
[Epoch 17] Train acc: 0.994, loss: 0.022 | Test acc: 0.990, loss: 0.061 | Time: 1.09s
[Epoch 18] Train acc: 0.992, loss: 0.025 | Test acc: 0.988, loss: 0.048 | Time: 1.21s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.045 | Time: 1.13s
[Epoch 20] Train acc: 0.995, loss: 0.016 | Test acc: 0.989, loss: 0.049 | Time: 1.19s
[Epoch 21] Train acc: 0.994, loss: 0.017 | Test acc: 0.989, loss: 0.054 | Time: 1.13s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.038 | Time: 1.14s
[Epoch 23] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.041 | Time: 1.13s
[Epoch 24] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.039 | Time: 1.15s
[Epoch 25] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.072 | Time: 1.14s
[Epoch 26] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.047 | Time: 1.14s
[Epoch 27] Train acc: 0.998, loss: 0.004 | Test acc: 0.992, loss: 0.046 | Time: 1.14s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.046 | Time: 1.15s
[Epoch 29] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.053 | Time: 1.14s
[Epoch 30] Train acc: 0.997, loss: 0.011 | Test acc: 0.991, loss: 0.050 | Time: 1.17s
[Epoch 31] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.049 | Time: 1.14s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.045 | Time: 1.16s
[Epoch 33] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.046 | Time: 1.17s
[Epoch 34] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.062 | Time: 1.17s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.043 | Time: 1.18s
[Epoch 36] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.048 | Time: 1.20s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.038 | Time: 1.21s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.047 | Time: 1.21s
[Epoch 39] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.051 | Time: 1.23s
[Epoch 40] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.057 | Time: 1.20s
Total training time: 72.64s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed4_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/Adam.learning_rate = 0.0003
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/FullES.recompute_samples = 100
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/GradientAccumulator.num_average = 20
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/HyperV2.param_inits = 256
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.lopt = @HyperV2()
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.num_estimators = 8
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.num_steps = 100000
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.staleness = 500
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.summary_every_n = 25
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/run_train.trainer_batch_size = 512
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__5f4399db_279d_4c28_8c38_13aabe64ff9c/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.981, loss: 0.063 | Test acc: 0.978, loss: 0.069 | Time: 25.35s
[Epoch 2] Train acc: 0.985, loss: 0.049 | Test acc: 0.980, loss: 0.061 | Time: 1.88s
[Epoch 3] Train acc: 0.990, loss: 0.032 | Test acc: 0.985, loss: 0.047 | Time: 1.94s
[Epoch 4] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.035 | Time: 1.93s
[Epoch 5] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.038 | Time: 1.92s
[Epoch 6] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.045 | Time: 1.93s
[Epoch 7] Train acc: 0.994, loss: 0.016 | Test acc: 0.984, loss: 0.056 | Time: 1.92s
[Epoch 8] Train acc: 0.995, loss: 0.014 | Test acc: 0.986, loss: 0.048 | Time: 1.92s
[Epoch 9] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.039 | Time: 1.93s
[Epoch 10] Train acc: 0.994, loss: 0.017 | Test acc: 0.988, loss: 0.048 | Time: 1.91s
[Epoch 11] Train acc: 0.997, loss: 0.007 | Test acc: 0.990, loss: 0.031 | Time: 1.93s
[Epoch 12] Train acc: 0.996, loss: 0.014 | Test acc: 0.988, loss: 0.041 | Time: 1.93s
[Epoch 13] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.041 | Time: 1.92s
[Epoch 14] Train acc: 0.996, loss: 0.010 | Test acc: 0.990, loss: 0.037 | Time: 1.92s
[Epoch 15] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.036 | Time: 1.93s
[Epoch 16] Train acc: 0.997, loss: 0.008 | Test acc: 0.991, loss: 0.035 | Time: 1.94s
[Epoch 17] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.035 | Time: 1.93s
[Epoch 18] Train acc: 0.997, loss: 0.007 | Test acc: 0.991, loss: 0.039 | Time: 1.93s
[Epoch 19] Train acc: 0.997, loss: 0.007 | Test acc: 0.989, loss: 0.035 | Time: 1.93s
[Epoch 20] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.049 | Time: 1.93s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.040 | Time: 1.94s
[Epoch 22] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.037 | Time: 1.93s
[Epoch 23] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.035 | Time: 1.92s
[Epoch 24] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.037 | Time: 1.94s
[Epoch 25] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.041 | Time: 1.92s
[Epoch 26] Train acc: 0.997, loss: 0.008 | Test acc: 0.989, loss: 0.049 | Time: 1.94s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.040 | Time: 1.95s
[Epoch 28] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.039 | Time: 2.00s
[Epoch 29] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.047 | Time: 2.06s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.041 | Time: 2.06s
[Epoch 31] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.038 | Time: 2.06s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.040 | Time: 2.08s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.038 | Time: 2.07s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.056 | Time: 2.07s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.994, loss: 0.044 | Time: 2.07s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.994, loss: 0.033 | Time: 2.06s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.994, loss: 0.038 | Time: 2.07s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.036 | Time: 2.09s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.037 | Time: 2.11s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.035 | Time: 2.13s
Total training time: 126.26s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed5_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.371, loss: 1.884 | Test acc: 0.375, loss: 1.884 | Time: 2.54s
[Epoch 2] Train acc: 0.532, loss: 1.539 | Test acc: 0.533, loss: 1.537 | Time: 0.95s
[Epoch 3] Train acc: 0.720, loss: 1.105 | Test acc: 0.720, loss: 1.106 | Time: 0.96s
[Epoch 4] Train acc: 0.864, loss: 0.632 | Test acc: 0.861, loss: 0.635 | Time: 0.96s
[Epoch 5] Train acc: 0.930, loss: 0.359 | Test acc: 0.931, loss: 0.359 | Time: 0.96s
[Epoch 6] Train acc: 0.949, loss: 0.242 | Test acc: 0.950, loss: 0.242 | Time: 0.96s
[Epoch 7] Train acc: 0.953, loss: 0.199 | Test acc: 0.954, loss: 0.201 | Time: 0.96s
[Epoch 8] Train acc: 0.942, loss: 0.213 | Test acc: 0.944, loss: 0.213 | Time: 0.96s
[Epoch 9] Train acc: 0.962, loss: 0.148 | Test acc: 0.962, loss: 0.150 | Time: 0.96s
[Epoch 10] Train acc: 0.968, loss: 0.126 | Test acc: 0.968, loss: 0.131 | Time: 0.96s
[Epoch 11] Train acc: 0.969, loss: 0.119 | Test acc: 0.967, loss: 0.125 | Time: 0.97s
[Epoch 12] Train acc: 0.971, loss: 0.109 | Test acc: 0.966, loss: 0.116 | Time: 0.96s
[Epoch 13] Train acc: 0.977, loss: 0.089 | Test acc: 0.973, loss: 0.097 | Time: 0.96s
[Epoch 14] Train acc: 0.973, loss: 0.097 | Test acc: 0.969, loss: 0.106 | Time: 0.97s
[Epoch 15] Train acc: 0.983, loss: 0.067 | Test acc: 0.979, loss: 0.076 | Time: 0.96s
[Epoch 16] Train acc: 0.985, loss: 0.060 | Test acc: 0.981, loss: 0.069 | Time: 0.97s
[Epoch 17] Train acc: 0.986, loss: 0.059 | Test acc: 0.981, loss: 0.069 | Time: 0.95s
[Epoch 18] Train acc: 0.985, loss: 0.058 | Test acc: 0.980, loss: 0.068 | Time: 0.97s
[Epoch 19] Train acc: 0.986, loss: 0.056 | Test acc: 0.981, loss: 0.068 | Time: 0.96s
[Epoch 20] Train acc: 0.986, loss: 0.054 | Test acc: 0.982, loss: 0.066 | Time: 0.97s
[Epoch 21] Train acc: 0.982, loss: 0.065 | Test acc: 0.976, loss: 0.079 | Time: 0.96s
[Epoch 22] Train acc: 0.978, loss: 0.072 | Test acc: 0.972, loss: 0.088 | Time: 0.97s
[Epoch 23] Train acc: 0.986, loss: 0.053 | Test acc: 0.979, loss: 0.068 | Time: 0.97s
[Epoch 24] Train acc: 0.988, loss: 0.046 | Test acc: 0.982, loss: 0.061 | Time: 0.95s
[Epoch 25] Train acc: 0.986, loss: 0.052 | Test acc: 0.978, loss: 0.069 | Time: 0.96s
[Epoch 26] Train acc: 0.981, loss: 0.067 | Test acc: 0.974, loss: 0.085 | Time: 0.96s
[Epoch 27] Train acc: 0.970, loss: 0.093 | Test acc: 0.964, loss: 0.112 | Time: 0.97s
[Epoch 28] Train acc: 0.971, loss: 0.093 | Test acc: 0.967, loss: 0.113 | Time: 0.97s
[Epoch 29] Train acc: 0.992, loss: 0.033 | Test acc: 0.984, loss: 0.049 | Time: 0.96s
[Epoch 30] Train acc: 0.993, loss: 0.030 | Test acc: 0.987, loss: 0.046 | Time: 0.98s
[Epoch 31] Train acc: 0.993, loss: 0.029 | Test acc: 0.986, loss: 0.045 | Time: 0.99s
[Epoch 32] Train acc: 0.994, loss: 0.027 | Test acc: 0.986, loss: 0.043 | Time: 0.97s
[Epoch 33] Train acc: 0.985, loss: 0.051 | Test acc: 0.977, loss: 0.071 | Time: 0.98s
[Epoch 34] Train acc: 0.995, loss: 0.024 | Test acc: 0.987, loss: 0.042 | Time: 0.98s
[Epoch 35] Train acc: 0.995, loss: 0.024 | Test acc: 0.988, loss: 0.041 | Time: 0.99s
[Epoch 36] Train acc: 0.993, loss: 0.027 | Test acc: 0.986, loss: 0.045 | Time: 0.98s
[Epoch 37] Train acc: 0.994, loss: 0.025 | Test acc: 0.987, loss: 0.044 | Time: 1.00s
[Epoch 38] Train acc: 0.995, loss: 0.022 | Test acc: 0.987, loss: 0.041 | Time: 1.01s
[Epoch 39] Train acc: 0.993, loss: 0.027 | Test acc: 0.985, loss: 0.048 | Time: 1.02s
[Epoch 40] Train acc: 0.992, loss: 0.028 | Test acc: 0.986, loss: 0.050 | Time: 1.03s
Total training time: 63.76s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed5_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.900, loss: 0.311 | Test acc: 0.899, loss: 0.318 | Time: 2.68s
[Epoch 2] Train acc: 0.947, loss: 0.170 | Test acc: 0.946, loss: 0.176 | Time: 0.99s
[Epoch 3] Train acc: 0.968, loss: 0.105 | Test acc: 0.967, loss: 0.109 | Time: 1.00s
[Epoch 4] Train acc: 0.972, loss: 0.089 | Test acc: 0.970, loss: 0.095 | Time: 1.01s
[Epoch 5] Train acc: 0.985, loss: 0.049 | Test acc: 0.982, loss: 0.057 | Time: 1.01s
[Epoch 6] Train acc: 0.987, loss: 0.041 | Test acc: 0.986, loss: 0.049 | Time: 1.00s
[Epoch 7] Train acc: 0.992, loss: 0.027 | Test acc: 0.988, loss: 0.040 | Time: 1.01s
[Epoch 8] Train acc: 0.990, loss: 0.032 | Test acc: 0.986, loss: 0.047 | Time: 1.01s
[Epoch 9] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.037 | Time: 1.04s
[Epoch 10] Train acc: 0.990, loss: 0.034 | Test acc: 0.983, loss: 0.055 | Time: 1.02s
[Epoch 11] Train acc: 0.993, loss: 0.022 | Test acc: 0.984, loss: 0.050 | Time: 1.01s
[Epoch 12] Train acc: 0.984, loss: 0.048 | Test acc: 0.976, loss: 0.075 | Time: 1.03s
[Epoch 13] Train acc: 0.993, loss: 0.022 | Test acc: 0.982, loss: 0.056 | Time: 1.02s
[Epoch 14] Train acc: 0.986, loss: 0.042 | Test acc: 0.979, loss: 0.068 | Time: 1.02s
[Epoch 15] Train acc: 0.996, loss: 0.013 | Test acc: 0.986, loss: 0.046 | Time: 1.02s
[Epoch 16] Train acc: 0.993, loss: 0.021 | Test acc: 0.984, loss: 0.049 | Time: 1.03s
[Epoch 17] Train acc: 0.994, loss: 0.018 | Test acc: 0.984, loss: 0.058 | Time: 1.02s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.040 | Time: 1.24s
[Epoch 19] Train acc: 0.992, loss: 0.023 | Test acc: 0.981, loss: 0.065 | Time: 1.03s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.038 | Time: 1.05s
[Epoch 21] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.046 | Time: 1.02s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.037 | Time: 1.02s
[Epoch 23] Train acc: 0.997, loss: 0.010 | Test acc: 0.986, loss: 0.045 | Time: 1.02s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.037 | Time: 1.02s
[Epoch 25] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.043 | Time: 1.02s
[Epoch 26] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.035 | Time: 1.03s
[Epoch 27] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.034 | Time: 1.12s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.033 | Time: 1.06s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.034 | Time: 1.06s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.034 | Time: 1.05s
[Epoch 31] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.034 | Time: 1.06s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.035 | Time: 1.05s
[Epoch 33] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.035 | Time: 1.05s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.04s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.034 | Time: 1.06s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.06s
[Epoch 37] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.035 | Time: 1.07s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.034 | Time: 1.13s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.036 | Time: 1.12s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.034 | Time: 1.11s
Total training time: 68.01s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed5_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.963, loss: 0.118 | Test acc: 0.961, loss: 0.121 | Time: 3.06s
[Epoch 2] Train acc: 0.982, loss: 0.057 | Test acc: 0.980, loss: 0.060 | Time: 1.06s
[Epoch 3] Train acc: 0.991, loss: 0.029 | Test acc: 0.989, loss: 0.036 | Time: 1.09s
[Epoch 4] Train acc: 0.991, loss: 0.027 | Test acc: 0.989, loss: 0.034 | Time: 1.09s
[Epoch 5] Train acc: 0.991, loss: 0.028 | Test acc: 0.985, loss: 0.045 | Time: 1.09s
[Epoch 6] Train acc: 0.988, loss: 0.038 | Test acc: 0.984, loss: 0.052 | Time: 1.08s
[Epoch 7] Train acc: 0.994, loss: 0.019 | Test acc: 0.989, loss: 0.037 | Time: 1.10s
[Epoch 8] Train acc: 0.989, loss: 0.036 | Test acc: 0.982, loss: 0.067 | Time: 1.10s
[Epoch 9] Train acc: 0.996, loss: 0.011 | Test acc: 0.991, loss: 0.036 | Time: 1.09s
[Epoch 10] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.045 | Time: 1.09s
[Epoch 11] Train acc: 0.993, loss: 0.024 | Test acc: 0.984, loss: 0.054 | Time: 1.09s
[Epoch 12] Train acc: 0.993, loss: 0.023 | Test acc: 0.986, loss: 0.059 | Time: 1.10s
[Epoch 13] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.038 | Time: 1.08s
[Epoch 14] Train acc: 0.994, loss: 0.018 | Test acc: 0.989, loss: 0.054 | Time: 1.09s
[Epoch 15] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.043 | Time: 1.30s
[Epoch 16] Train acc: 0.991, loss: 0.032 | Test acc: 0.985, loss: 0.067 | Time: 1.31s
[Epoch 17] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.041 | Time: 1.12s
[Epoch 18] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.041 | Time: 1.11s
[Epoch 19] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.051 | Time: 1.09s
[Epoch 20] Train acc: 0.995, loss: 0.014 | Test acc: 0.990, loss: 0.048 | Time: 1.18s
[Epoch 21] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.040 | Time: 1.10s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.037 | Time: 1.10s
[Epoch 23] Train acc: 0.996, loss: 0.012 | Test acc: 0.988, loss: 0.050 | Time: 1.12s
[Epoch 24] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.036 | Time: 1.11s
[Epoch 25] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.042 | Time: 1.12s
[Epoch 26] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.049 | Time: 1.12s
[Epoch 27] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.032 | Time: 1.10s
[Epoch 28] Train acc: 0.995, loss: 0.018 | Test acc: 0.988, loss: 0.053 | Time: 1.11s
[Epoch 29] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.035 | Time: 1.11s
[Epoch 30] Train acc: 0.998, loss: 0.008 | Test acc: 0.990, loss: 0.053 | Time: 1.12s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.042 | Time: 1.12s
[Epoch 32] Train acc: 0.999, loss: 0.005 | Test acc: 0.992, loss: 0.039 | Time: 1.12s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.045 | Time: 1.14s
[Epoch 34] Train acc: 0.999, loss: 0.005 | Test acc: 0.993, loss: 0.036 | Time: 1.23s
[Epoch 35] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.047 | Time: 1.26s
[Epoch 36] Train acc: 0.997, loss: 0.009 | Test acc: 0.992, loss: 0.036 | Time: 1.27s
[Epoch 37] Train acc: 0.996, loss: 0.015 | Test acc: 0.988, loss: 0.058 | Time: 1.14s
[Epoch 38] Train acc: 0.997, loss: 0.009 | Test acc: 0.992, loss: 0.040 | Time: 1.15s
[Epoch 39] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.051 | Time: 1.18s
[Epoch 40] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.035 | Time: 1.17s
Total training time: 72.08s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed5_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.976, loss: 0.079 | Test acc: 0.972, loss: 0.086 | Time: 3.04s
[Epoch 2] Train acc: 0.983, loss: 0.052 | Test acc: 0.980, loss: 0.056 | Time: 1.06s
[Epoch 3] Train acc: 0.991, loss: 0.029 | Test acc: 0.988, loss: 0.036 | Time: 1.07s
[Epoch 4] Train acc: 0.990, loss: 0.032 | Test acc: 0.983, loss: 0.048 | Time: 1.08s
[Epoch 5] Train acc: 0.992, loss: 0.027 | Test acc: 0.987, loss: 0.039 | Time: 1.08s
[Epoch 6] Train acc: 0.994, loss: 0.020 | Test acc: 0.988, loss: 0.038 | Time: 1.08s
[Epoch 7] Train acc: 0.992, loss: 0.025 | Test acc: 0.987, loss: 0.042 | Time: 1.26s
[Epoch 8] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.044 | Time: 1.14s
[Epoch 9] Train acc: 0.995, loss: 0.016 | Test acc: 0.987, loss: 0.044 | Time: 1.09s
[Epoch 10] Train acc: 0.992, loss: 0.027 | Test acc: 0.986, loss: 0.051 | Time: 1.08s
[Epoch 11] Train acc: 0.995, loss: 0.013 | Test acc: 0.989, loss: 0.037 | Time: 1.25s
[Epoch 12] Train acc: 0.981, loss: 0.066 | Test acc: 0.970, loss: 0.126 | Time: 1.16s
[Epoch 13] Train acc: 0.996, loss: 0.012 | Test acc: 0.991, loss: 0.033 | Time: 1.19s
[Epoch 14] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.039 | Time: 1.18s
[Epoch 15] Train acc: 0.994, loss: 0.023 | Test acc: 0.988, loss: 0.051 | Time: 1.19s
[Epoch 16] Train acc: 0.994, loss: 0.018 | Test acc: 0.990, loss: 0.052 | Time: 1.17s
[Epoch 17] Train acc: 0.995, loss: 0.018 | Test acc: 0.987, loss: 0.046 | Time: 1.19s
[Epoch 18] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.041 | Time: 1.18s
[Epoch 19] Train acc: 0.991, loss: 0.031 | Test acc: 0.986, loss: 0.069 | Time: 1.19s
[Epoch 20] Train acc: 0.996, loss: 0.014 | Test acc: 0.990, loss: 0.042 | Time: 1.18s
[Epoch 21] Train acc: 0.994, loss: 0.022 | Test acc: 0.986, loss: 0.074 | Time: 1.18s
[Epoch 22] Train acc: 0.996, loss: 0.011 | Test acc: 0.991, loss: 0.042 | Time: 1.17s
[Epoch 23] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.032 | Time: 1.20s
[Epoch 24] Train acc: 0.999, loss: 0.002 | Test acc: 0.994, loss: 0.029 | Time: 1.25s
[Epoch 25] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.044 | Time: 1.30s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.034 | Time: 1.30s
[Epoch 27] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.054 | Time: 1.29s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.044 | Time: 1.18s
[Epoch 29] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.052 | Time: 1.18s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.034 | Time: 1.19s
[Epoch 31] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.045 | Time: 1.19s
[Epoch 32] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.034 | Time: 1.19s
[Epoch 33] Train acc: 0.995, loss: 0.020 | Test acc: 0.986, loss: 0.073 | Time: 1.20s
[Epoch 34] Train acc: 0.996, loss: 0.016 | Test acc: 0.989, loss: 0.058 | Time: 1.20s
[Epoch 35] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.037 | Time: 1.21s
[Epoch 36] Train acc: 0.997, loss: 0.011 | Test acc: 0.991, loss: 0.050 | Time: 1.21s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.033 | Time: 1.21s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.046 | Time: 1.19s
[Epoch 39] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.047 | Time: 1.24s
[Epoch 40] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.041 | Time: 1.20s
Total training time: 75.72s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed5_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/Adam.learning_rate = 0.0003
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/FullES.recompute_samples = 100
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/GradientAccumulator.num_average = 20
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/HyperV2.param_inits = 256
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.lopt = @HyperV2()
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.num_estimators = 8
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.num_steps = 100000
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.staleness = 500
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.summary_every_n = 25
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/run_train.trainer_batch_size = 512
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__d0f31c19_19d1_46dd_ad6a_66bd86e191b3/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.976, loss: 0.080 | Test acc: 0.973, loss: 0.085 | Time: 25.58s
[Epoch 2] Train acc: 0.986, loss: 0.046 | Test acc: 0.982, loss: 0.061 | Time: 1.89s
[Epoch 3] Train acc: 0.992, loss: 0.025 | Test acc: 0.987, loss: 0.042 | Time: 1.96s
[Epoch 4] Train acc: 0.993, loss: 0.020 | Test acc: 0.987, loss: 0.041 | Time: 1.95s
[Epoch 5] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.041 | Time: 1.96s
[Epoch 6] Train acc: 0.994, loss: 0.017 | Test acc: 0.988, loss: 0.041 | Time: 1.96s
[Epoch 7] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.037 | Time: 1.96s
[Epoch 8] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.047 | Time: 1.94s
[Epoch 9] Train acc: 0.993, loss: 0.020 | Test acc: 0.988, loss: 0.049 | Time: 1.96s
[Epoch 10] Train acc: 0.995, loss: 0.017 | Test acc: 0.989, loss: 0.046 | Time: 1.95s
[Epoch 11] Train acc: 0.995, loss: 0.013 | Test acc: 0.990, loss: 0.040 | Time: 1.95s
[Epoch 12] Train acc: 0.994, loss: 0.018 | Test acc: 0.987, loss: 0.060 | Time: 1.95s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.041 | Time: 1.92s
[Epoch 14] Train acc: 0.994, loss: 0.017 | Test acc: 0.988, loss: 0.047 | Time: 1.95s
[Epoch 15] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.040 | Time: 1.95s
[Epoch 16] Train acc: 0.993, loss: 0.022 | Test acc: 0.986, loss: 0.062 | Time: 1.96s
[Epoch 17] Train acc: 0.996, loss: 0.011 | Test acc: 0.990, loss: 0.046 | Time: 1.96s
[Epoch 18] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.056 | Time: 1.96s
[Epoch 19] Train acc: 0.997, loss: 0.008 | Test acc: 0.988, loss: 0.053 | Time: 1.96s
[Epoch 20] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.053 | Time: 1.96s
[Epoch 21] Train acc: 0.997, loss: 0.008 | Test acc: 0.989, loss: 0.046 | Time: 1.93s
[Epoch 22] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.056 | Time: 1.94s
[Epoch 23] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.052 | Time: 2.07s
[Epoch 24] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.051 | Time: 2.02s
[Epoch 25] Train acc: 0.997, loss: 0.008 | Test acc: 0.988, loss: 0.047 | Time: 2.05s
[Epoch 26] Train acc: 0.997, loss: 0.008 | Test acc: 0.989, loss: 0.058 | Time: 2.05s
[Epoch 27] Train acc: 0.998, loss: 0.008 | Test acc: 0.990, loss: 0.060 | Time: 2.06s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.055 | Time: 2.04s
[Epoch 29] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.045 | Time: 2.06s
[Epoch 30] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.063 | Time: 2.05s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.051 | Time: 2.06s
[Epoch 32] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.063 | Time: 2.06s
[Epoch 33] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.060 | Time: 2.09s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.050 | Time: 2.07s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.054 | Time: 2.12s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.057 | Time: 2.10s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.058 | Time: 2.12s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.992, loss: 0.053 | Time: 2.12s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.055 | Time: 2.15s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.055 | Time: 2.12s
Total training time: 128.15s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed6_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.384, loss: 1.874 | Test acc: 0.378, loss: 1.875 | Time: 2.55s
[Epoch 2] Train acc: 0.534, loss: 1.545 | Test acc: 0.525, loss: 1.543 | Time: 0.95s
[Epoch 3] Train acc: 0.722, loss: 1.112 | Test acc: 0.726, loss: 1.109 | Time: 0.97s
[Epoch 4] Train acc: 0.878, loss: 0.638 | Test acc: 0.878, loss: 0.634 | Time: 0.96s
[Epoch 5] Train acc: 0.924, loss: 0.366 | Test acc: 0.926, loss: 0.362 | Time: 0.97s
[Epoch 6] Train acc: 0.949, loss: 0.241 | Test acc: 0.951, loss: 0.238 | Time: 0.98s
[Epoch 7] Train acc: 0.953, loss: 0.197 | Test acc: 0.953, loss: 0.198 | Time: 0.97s
[Epoch 8] Train acc: 0.954, loss: 0.178 | Test acc: 0.951, loss: 0.177 | Time: 0.97s
[Epoch 9] Train acc: 0.961, loss: 0.149 | Test acc: 0.961, loss: 0.146 | Time: 0.97s
[Epoch 10] Train acc: 0.970, loss: 0.118 | Test acc: 0.970, loss: 0.117 | Time: 0.98s
[Epoch 11] Train acc: 0.974, loss: 0.104 | Test acc: 0.974, loss: 0.104 | Time: 0.97s
[Epoch 12] Train acc: 0.976, loss: 0.094 | Test acc: 0.976, loss: 0.097 | Time: 1.00s
[Epoch 13] Train acc: 0.980, loss: 0.082 | Test acc: 0.979, loss: 0.086 | Time: 0.97s
[Epoch 14] Train acc: 0.980, loss: 0.081 | Test acc: 0.976, loss: 0.088 | Time: 0.96s
[Epoch 15] Train acc: 0.981, loss: 0.076 | Test acc: 0.978, loss: 0.083 | Time: 0.96s
[Epoch 16] Train acc: 0.981, loss: 0.073 | Test acc: 0.976, loss: 0.084 | Time: 0.97s
[Epoch 17] Train acc: 0.985, loss: 0.063 | Test acc: 0.979, loss: 0.074 | Time: 0.98s
[Epoch 18] Train acc: 0.984, loss: 0.064 | Test acc: 0.978, loss: 0.075 | Time: 0.98s
[Epoch 19] Train acc: 0.985, loss: 0.059 | Test acc: 0.982, loss: 0.068 | Time: 0.98s
[Epoch 20] Train acc: 0.979, loss: 0.076 | Test acc: 0.976, loss: 0.087 | Time: 0.98s
[Epoch 21] Train acc: 0.983, loss: 0.063 | Test acc: 0.980, loss: 0.073 | Time: 0.98s
[Epoch 22] Train acc: 0.989, loss: 0.042 | Test acc: 0.984, loss: 0.052 | Time: 0.98s
[Epoch 23] Train acc: 0.989, loss: 0.045 | Test acc: 0.983, loss: 0.057 | Time: 0.98s
[Epoch 24] Train acc: 0.989, loss: 0.042 | Test acc: 0.985, loss: 0.053 | Time: 0.98s
[Epoch 25] Train acc: 0.986, loss: 0.049 | Test acc: 0.982, loss: 0.061 | Time: 0.99s
[Epoch 26] Train acc: 0.985, loss: 0.053 | Test acc: 0.980, loss: 0.066 | Time: 0.98s
[Epoch 27] Train acc: 0.973, loss: 0.090 | Test acc: 0.967, loss: 0.101 | Time: 0.99s
[Epoch 28] Train acc: 0.970, loss: 0.094 | Test acc: 0.966, loss: 0.106 | Time: 0.99s
[Epoch 29] Train acc: 0.991, loss: 0.036 | Test acc: 0.986, loss: 0.048 | Time: 0.99s
[Epoch 30] Train acc: 0.994, loss: 0.027 | Test acc: 0.987, loss: 0.042 | Time: 0.99s
[Epoch 31] Train acc: 0.994, loss: 0.029 | Test acc: 0.986, loss: 0.046 | Time: 0.99s
[Epoch 32] Train acc: 0.993, loss: 0.028 | Test acc: 0.986, loss: 0.047 | Time: 1.00s
[Epoch 33] Train acc: 0.990, loss: 0.038 | Test acc: 0.983, loss: 0.058 | Time: 1.00s
[Epoch 34] Train acc: 0.993, loss: 0.028 | Test acc: 0.986, loss: 0.046 | Time: 1.02s
[Epoch 35] Train acc: 0.994, loss: 0.024 | Test acc: 0.988, loss: 0.042 | Time: 1.02s
[Epoch 36] Train acc: 0.994, loss: 0.026 | Test acc: 0.985, loss: 0.043 | Time: 1.02s
[Epoch 37] Train acc: 0.995, loss: 0.020 | Test acc: 0.988, loss: 0.039 | Time: 1.02s
[Epoch 38] Train acc: 0.996, loss: 0.020 | Test acc: 0.987, loss: 0.039 | Time: 1.02s
[Epoch 39] Train acc: 0.993, loss: 0.026 | Test acc: 0.985, loss: 0.049 | Time: 1.06s
[Epoch 40] Train acc: 0.991, loss: 0.031 | Test acc: 0.984, loss: 0.054 | Time: 1.05s
Total training time: 65.17s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed6_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.946, loss: 0.192 | Test acc: 0.946, loss: 0.192 | Time: 2.66s
[Epoch 2] Train acc: 0.966, loss: 0.114 | Test acc: 0.965, loss: 0.114 | Time: 0.98s
[Epoch 3] Train acc: 0.976, loss: 0.080 | Test acc: 0.973, loss: 0.087 | Time: 1.01s
[Epoch 4] Train acc: 0.979, loss: 0.067 | Test acc: 0.974, loss: 0.081 | Time: 1.06s
[Epoch 5] Train acc: 0.983, loss: 0.052 | Test acc: 0.978, loss: 0.069 | Time: 1.12s
[Epoch 6] Train acc: 0.983, loss: 0.053 | Test acc: 0.976, loss: 0.074 | Time: 1.11s
[Epoch 7] Train acc: 0.988, loss: 0.036 | Test acc: 0.980, loss: 0.057 | Time: 1.01s
[Epoch 8] Train acc: 0.993, loss: 0.024 | Test acc: 0.986, loss: 0.045 | Time: 1.01s
[Epoch 9] Train acc: 0.995, loss: 0.018 | Test acc: 0.987, loss: 0.041 | Time: 1.01s
[Epoch 10] Train acc: 0.996, loss: 0.014 | Test acc: 0.988, loss: 0.035 | Time: 1.01s
[Epoch 11] Train acc: 0.997, loss: 0.012 | Test acc: 0.988, loss: 0.036 | Time: 1.05s
[Epoch 12] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.034 | Time: 1.03s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.034 | Time: 1.02s
[Epoch 14] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.037 | Time: 1.02s
[Epoch 15] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.036 | Time: 1.03s
[Epoch 16] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.037 | Time: 1.02s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.036 | Time: 1.02s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.037 | Time: 1.02s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.036 | Time: 1.02s
[Epoch 20] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.035 | Time: 1.03s
[Epoch 21] Train acc: 0.999, loss: 0.006 | Test acc: 0.989, loss: 0.036 | Time: 1.10s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.036 | Time: 1.13s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.034 | Time: 1.11s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.037 | Time: 1.09s
[Epoch 25] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.035 | Time: 1.11s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.036 | Time: 1.15s
[Epoch 27] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.034 | Time: 1.12s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.033 | Time: 1.05s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.034 | Time: 1.05s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.032 | Time: 1.07s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.034 | Time: 1.06s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.031 | Time: 1.05s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.034 | Time: 1.06s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.030 | Time: 1.06s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.033 | Time: 1.07s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.08s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.09s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.08s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.08s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.029 | Time: 1.23s
Total training time: 69.42s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed6_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.977, loss: 0.075 | Test acc: 0.976, loss: 0.080 | Time: 3.00s
[Epoch 2] Train acc: 0.985, loss: 0.050 | Test acc: 0.982, loss: 0.057 | Time: 1.06s
[Epoch 3] Train acc: 0.989, loss: 0.034 | Test acc: 0.983, loss: 0.045 | Time: 1.10s
[Epoch 4] Train acc: 0.991, loss: 0.027 | Test acc: 0.988, loss: 0.038 | Time: 1.11s
[Epoch 5] Train acc: 0.991, loss: 0.028 | Test acc: 0.987, loss: 0.042 | Time: 1.10s
[Epoch 6] Train acc: 0.991, loss: 0.026 | Test acc: 0.986, loss: 0.043 | Time: 1.10s
[Epoch 7] Train acc: 0.991, loss: 0.028 | Test acc: 0.983, loss: 0.054 | Time: 1.10s
[Epoch 8] Train acc: 0.992, loss: 0.024 | Test acc: 0.985, loss: 0.052 | Time: 1.09s
[Epoch 9] Train acc: 0.990, loss: 0.032 | Test acc: 0.986, loss: 0.055 | Time: 1.10s
[Epoch 10] Train acc: 0.993, loss: 0.022 | Test acc: 0.988, loss: 0.047 | Time: 1.10s
[Epoch 11] Train acc: 0.993, loss: 0.019 | Test acc: 0.987, loss: 0.044 | Time: 1.10s
[Epoch 12] Train acc: 0.994, loss: 0.020 | Test acc: 0.989, loss: 0.046 | Time: 1.11s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.037 | Time: 1.10s
[Epoch 14] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.034 | Time: 1.10s
[Epoch 15] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.040 | Time: 1.10s
[Epoch 16] Train acc: 0.997, loss: 0.007 | Test acc: 0.992, loss: 0.035 | Time: 1.10s
[Epoch 17] Train acc: 0.997, loss: 0.008 | Test acc: 0.992, loss: 0.031 | Time: 1.11s
[Epoch 18] Train acc: 0.999, loss: 0.005 | Test acc: 0.993, loss: 0.029 | Time: 1.12s
[Epoch 19] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.047 | Time: 1.11s
[Epoch 20] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.039 | Time: 1.12s
[Epoch 21] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.044 | Time: 1.10s
[Epoch 22] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.049 | Time: 1.10s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.041 | Time: 1.15s
[Epoch 24] Train acc: 0.993, loss: 0.024 | Test acc: 0.985, loss: 0.067 | Time: 1.11s
[Epoch 25] Train acc: 0.994, loss: 0.018 | Test acc: 0.986, loss: 0.063 | Time: 1.20s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.039 | Time: 1.21s
[Epoch 27] Train acc: 0.991, loss: 0.032 | Test acc: 0.983, loss: 0.078 | Time: 1.11s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.035 | Time: 1.11s
[Epoch 29] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.039 | Time: 1.11s
[Epoch 30] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.036 | Time: 1.10s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.035 | Time: 1.11s
[Epoch 32] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.043 | Time: 1.11s
[Epoch 33] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.045 | Time: 1.13s
[Epoch 34] Train acc: 0.997, loss: 0.012 | Test acc: 0.989, loss: 0.056 | Time: 1.21s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.041 | Time: 1.13s
[Epoch 36] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.037 | Time: 1.34s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.036 | Time: 1.32s
[Epoch 38] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.052 | Time: 1.22s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.047 | Time: 1.26s
[Epoch 40] Train acc: 0.997, loss: 0.009 | Test acc: 0.992, loss: 0.049 | Time: 1.25s
Total training time: 72.12s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed6_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.978, loss: 0.071 | Test acc: 0.976, loss: 0.074 | Time: 2.94s
[Epoch 2] Train acc: 0.982, loss: 0.056 | Test acc: 0.978, loss: 0.063 | Time: 1.06s
[Epoch 3] Train acc: 0.985, loss: 0.048 | Test acc: 0.979, loss: 0.065 | Time: 1.07s
[Epoch 4] Train acc: 0.985, loss: 0.043 | Test acc: 0.981, loss: 0.055 | Time: 1.08s
[Epoch 5] Train acc: 0.992, loss: 0.024 | Test acc: 0.987, loss: 0.043 | Time: 1.10s
[Epoch 6] Train acc: 0.991, loss: 0.028 | Test acc: 0.986, loss: 0.043 | Time: 1.09s
[Epoch 7] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.039 | Time: 1.09s
[Epoch 8] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.044 | Time: 1.08s
[Epoch 9] Train acc: 0.995, loss: 0.016 | Test acc: 0.987, loss: 0.041 | Time: 1.08s
[Epoch 10] Train acc: 0.995, loss: 0.016 | Test acc: 0.989, loss: 0.044 | Time: 1.08s
[Epoch 11] Train acc: 0.997, loss: 0.010 | Test acc: 0.993, loss: 0.027 | Time: 1.09s
[Epoch 12] Train acc: 0.993, loss: 0.024 | Test acc: 0.986, loss: 0.058 | Time: 1.08s
[Epoch 13] Train acc: 0.997, loss: 0.011 | Test acc: 0.990, loss: 0.039 | Time: 1.08s
[Epoch 14] Train acc: 0.990, loss: 0.032 | Test acc: 0.983, loss: 0.077 | Time: 1.08s
[Epoch 15] Train acc: 0.993, loss: 0.022 | Test acc: 0.988, loss: 0.045 | Time: 1.11s
[Epoch 16] Train acc: 0.991, loss: 0.031 | Test acc: 0.986, loss: 0.066 | Time: 1.14s
[Epoch 17] Train acc: 0.996, loss: 0.011 | Test acc: 0.990, loss: 0.038 | Time: 1.13s
[Epoch 18] Train acc: 0.997, loss: 0.010 | Test acc: 0.991, loss: 0.045 | Time: 1.15s
[Epoch 19] Train acc: 0.995, loss: 0.017 | Test acc: 0.990, loss: 0.045 | Time: 1.14s
[Epoch 20] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.029 | Time: 1.14s
[Epoch 21] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.034 | Time: 1.14s
[Epoch 22] Train acc: 0.994, loss: 0.020 | Test acc: 0.990, loss: 0.048 | Time: 1.14s
[Epoch 23] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.042 | Time: 1.13s
[Epoch 24] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.033 | Time: 1.14s
[Epoch 25] Train acc: 0.995, loss: 0.014 | Test acc: 0.990, loss: 0.053 | Time: 1.15s
[Epoch 26] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.048 | Time: 1.14s
[Epoch 27] Train acc: 0.997, loss: 0.008 | Test acc: 0.992, loss: 0.038 | Time: 1.15s
[Epoch 28] Train acc: 0.993, loss: 0.026 | Test acc: 0.988, loss: 0.060 | Time: 1.15s
[Epoch 29] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.043 | Time: 1.14s
[Epoch 30] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.054 | Time: 1.14s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.993, loss: 0.035 | Time: 1.14s
[Epoch 32] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.036 | Time: 1.38s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.039 | Time: 1.18s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.041 | Time: 1.14s
[Epoch 35] Train acc: 0.997, loss: 0.011 | Test acc: 0.990, loss: 0.053 | Time: 1.16s
[Epoch 36] Train acc: 0.999, loss: 0.004 | Test acc: 0.994, loss: 0.036 | Time: 1.15s
[Epoch 37] Train acc: 0.997, loss: 0.013 | Test acc: 0.989, loss: 0.056 | Time: 1.20s
[Epoch 38] Train acc: 0.997, loss: 0.008 | Test acc: 0.991, loss: 0.047 | Time: 1.16s
[Epoch 39] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.039 | Time: 1.19s
[Epoch 40] Train acc: 0.998, loss: 0.008 | Test acc: 0.992, loss: 0.057 | Time: 1.17s
Total training time: 71.69s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed6_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/Adam.learning_rate = 0.0003
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/FullES.recompute_samples = 100
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/GradientAccumulator.num_average = 20
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/HyperV2.param_inits = 256
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.lopt = @HyperV2()
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.num_estimators = 8
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.num_steps = 100000
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.staleness = 500
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.summary_every_n = 25
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/run_train.trainer_batch_size = 512
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__c12977fc_3f20_40aa_a7b8_bfd5066cb535/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.980, loss: 0.066 | Test acc: 0.976, loss: 0.074 | Time: 25.43s
[Epoch 2] Train acc: 0.987, loss: 0.042 | Test acc: 0.983, loss: 0.054 | Time: 1.87s
[Epoch 3] Train acc: 0.992, loss: 0.027 | Test acc: 0.987, loss: 0.043 | Time: 1.94s
[Epoch 4] Train acc: 0.992, loss: 0.025 | Test acc: 0.988, loss: 0.044 | Time: 1.92s
[Epoch 5] Train acc: 0.993, loss: 0.019 | Test acc: 0.987, loss: 0.045 | Time: 1.94s
[Epoch 6] Train acc: 0.994, loss: 0.018 | Test acc: 0.989, loss: 0.041 | Time: 1.94s
[Epoch 7] Train acc: 0.995, loss: 0.014 | Test acc: 0.988, loss: 0.044 | Time: 1.93s
[Epoch 8] Train acc: 0.993, loss: 0.023 | Test acc: 0.985, loss: 0.058 | Time: 1.93s
[Epoch 9] Train acc: 0.996, loss: 0.012 | Test acc: 0.988, loss: 0.042 | Time: 1.94s
[Epoch 10] Train acc: 0.995, loss: 0.016 | Test acc: 0.990, loss: 0.035 | Time: 1.94s
[Epoch 11] Train acc: 0.995, loss: 0.014 | Test acc: 0.989, loss: 0.037 | Time: 1.93s
[Epoch 12] Train acc: 0.994, loss: 0.018 | Test acc: 0.987, loss: 0.046 | Time: 1.94s
[Epoch 13] Train acc: 0.996, loss: 0.012 | Test acc: 0.991, loss: 0.041 | Time: 1.93s
[Epoch 14] Train acc: 0.995, loss: 0.014 | Test acc: 0.988, loss: 0.049 | Time: 1.93s
[Epoch 15] Train acc: 0.995, loss: 0.014 | Test acc: 0.990, loss: 0.041 | Time: 1.92s
[Epoch 16] Train acc: 0.995, loss: 0.014 | Test acc: 0.991, loss: 0.037 | Time: 1.95s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.039 | Time: 1.94s
[Epoch 18] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.049 | Time: 1.95s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.038 | Time: 1.94s
[Epoch 20] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.045 | Time: 1.95s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.033 | Time: 1.94s
[Epoch 22] Train acc: 0.998, loss: 0.006 | Test acc: 0.993, loss: 0.032 | Time: 1.95s
[Epoch 23] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.049 | Time: 1.93s
[Epoch 24] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.036 | Time: 1.95s
[Epoch 25] Train acc: 0.997, loss: 0.007 | Test acc: 0.992, loss: 0.037 | Time: 1.96s
[Epoch 26] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.036 | Time: 1.97s
[Epoch 27] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.043 | Time: 1.98s
[Epoch 28] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.034 | Time: 1.96s
[Epoch 29] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.048 | Time: 1.96s
[Epoch 30] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.032 | Time: 2.04s
[Epoch 31] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.041 | Time: 2.07s
[Epoch 32] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.041 | Time: 2.07s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.037 | Time: 2.09s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.042 | Time: 2.09s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.994, loss: 0.038 | Time: 2.07s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.032 | Time: 2.08s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.035 | Time: 2.08s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.032 | Time: 2.09s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.995, loss: 0.028 | Time: 2.08s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.995, loss: 0.029 | Time: 2.10s
Total training time: 126.49s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed7_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.380, loss: 1.874 | Test acc: 0.381, loss: 1.872 | Time: 2.57s
[Epoch 2] Train acc: 0.524, loss: 1.550 | Test acc: 0.528, loss: 1.544 | Time: 0.94s
[Epoch 3] Train acc: 0.733, loss: 1.112 | Test acc: 0.735, loss: 1.108 | Time: 0.96s
[Epoch 4] Train acc: 0.868, loss: 0.641 | Test acc: 0.870, loss: 0.638 | Time: 0.97s
[Epoch 5] Train acc: 0.924, loss: 0.376 | Test acc: 0.929, loss: 0.373 | Time: 0.96s
[Epoch 6] Train acc: 0.942, loss: 0.268 | Test acc: 0.946, loss: 0.261 | Time: 0.96s
[Epoch 7] Train acc: 0.948, loss: 0.216 | Test acc: 0.945, loss: 0.217 | Time: 0.97s
[Epoch 8] Train acc: 0.939, loss: 0.219 | Test acc: 0.939, loss: 0.222 | Time: 0.97s
[Epoch 9] Train acc: 0.961, loss: 0.150 | Test acc: 0.963, loss: 0.146 | Time: 0.97s
[Epoch 10] Train acc: 0.966, loss: 0.134 | Test acc: 0.962, loss: 0.136 | Time: 0.97s
[Epoch 11] Train acc: 0.970, loss: 0.116 | Test acc: 0.969, loss: 0.117 | Time: 0.97s
[Epoch 12] Train acc: 0.976, loss: 0.097 | Test acc: 0.974, loss: 0.101 | Time: 0.97s
[Epoch 13] Train acc: 0.977, loss: 0.089 | Test acc: 0.975, loss: 0.093 | Time: 0.96s
[Epoch 14] Train acc: 0.980, loss: 0.081 | Test acc: 0.974, loss: 0.089 | Time: 0.97s
[Epoch 15] Train acc: 0.983, loss: 0.070 | Test acc: 0.978, loss: 0.077 | Time: 0.97s
[Epoch 16] Train acc: 0.985, loss: 0.064 | Test acc: 0.980, loss: 0.071 | Time: 0.97s
[Epoch 17] Train acc: 0.985, loss: 0.062 | Test acc: 0.980, loss: 0.072 | Time: 0.97s
[Epoch 18] Train acc: 0.978, loss: 0.080 | Test acc: 0.971, loss: 0.095 | Time: 0.98s
[Epoch 19] Train acc: 0.984, loss: 0.062 | Test acc: 0.979, loss: 0.074 | Time: 0.97s
[Epoch 20] Train acc: 0.985, loss: 0.060 | Test acc: 0.982, loss: 0.071 | Time: 0.98s
[Epoch 21] Train acc: 0.982, loss: 0.067 | Test acc: 0.979, loss: 0.075 | Time: 0.98s
[Epoch 22] Train acc: 0.987, loss: 0.050 | Test acc: 0.982, loss: 0.062 | Time: 0.97s
[Epoch 23] Train acc: 0.987, loss: 0.051 | Test acc: 0.982, loss: 0.062 | Time: 0.97s
[Epoch 24] Train acc: 0.989, loss: 0.045 | Test acc: 0.983, loss: 0.058 | Time: 0.97s
[Epoch 25] Train acc: 0.988, loss: 0.046 | Test acc: 0.983, loss: 0.060 | Time: 0.97s
[Epoch 26] Train acc: 0.988, loss: 0.047 | Test acc: 0.980, loss: 0.063 | Time: 0.98s
[Epoch 27] Train acc: 0.982, loss: 0.061 | Test acc: 0.976, loss: 0.077 | Time: 0.98s
[Epoch 28] Train acc: 0.986, loss: 0.049 | Test acc: 0.979, loss: 0.064 | Time: 0.98s
[Epoch 29] Train acc: 0.990, loss: 0.038 | Test acc: 0.984, loss: 0.054 | Time: 0.97s
[Epoch 30] Train acc: 0.989, loss: 0.041 | Test acc: 0.983, loss: 0.056 | Time: 0.97s
[Epoch 31] Train acc: 0.991, loss: 0.034 | Test acc: 0.986, loss: 0.049 | Time: 0.97s
[Epoch 32] Train acc: 0.992, loss: 0.031 | Test acc: 0.987, loss: 0.045 | Time: 0.98s
[Epoch 33] Train acc: 0.986, loss: 0.049 | Test acc: 0.980, loss: 0.069 | Time: 1.00s
[Epoch 34] Train acc: 0.990, loss: 0.036 | Test acc: 0.985, loss: 0.052 | Time: 1.00s
[Epoch 35] Train acc: 0.992, loss: 0.031 | Test acc: 0.986, loss: 0.048 | Time: 1.01s
[Epoch 36] Train acc: 0.991, loss: 0.033 | Test acc: 0.985, loss: 0.049 | Time: 1.00s
[Epoch 37] Train acc: 0.995, loss: 0.022 | Test acc: 0.986, loss: 0.041 | Time: 1.00s
[Epoch 38] Train acc: 0.995, loss: 0.022 | Test acc: 0.987, loss: 0.041 | Time: 1.00s
[Epoch 39] Train acc: 0.994, loss: 0.025 | Test acc: 0.986, loss: 0.045 | Time: 1.01s
[Epoch 40] Train acc: 0.991, loss: 0.032 | Test acc: 0.984, loss: 0.055 | Time: 1.01s
Total training time: 63.91s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed7_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.947, loss: 0.187 | Test acc: 0.950, loss: 0.187 | Time: 2.66s
[Epoch 2] Train acc: 0.949, loss: 0.163 | Test acc: 0.943, loss: 0.172 | Time: 1.03s
[Epoch 3] Train acc: 0.970, loss: 0.097 | Test acc: 0.966, loss: 0.105 | Time: 1.05s
[Epoch 4] Train acc: 0.981, loss: 0.064 | Test acc: 0.977, loss: 0.074 | Time: 1.13s
[Epoch 5] Train acc: 0.984, loss: 0.055 | Test acc: 0.980, loss: 0.064 | Time: 1.06s
[Epoch 6] Train acc: 0.990, loss: 0.033 | Test acc: 0.985, loss: 0.046 | Time: 1.08s
[Epoch 7] Train acc: 0.992, loss: 0.028 | Test acc: 0.985, loss: 0.043 | Time: 1.07s
[Epoch 8] Train acc: 0.992, loss: 0.026 | Test acc: 0.983, loss: 0.045 | Time: 1.05s
[Epoch 9] Train acc: 0.992, loss: 0.026 | Test acc: 0.984, loss: 0.048 | Time: 1.07s
[Epoch 10] Train acc: 0.986, loss: 0.043 | Test acc: 0.979, loss: 0.069 | Time: 1.09s
[Epoch 11] Train acc: 0.991, loss: 0.026 | Test acc: 0.983, loss: 0.054 | Time: 1.07s
[Epoch 12] Train acc: 0.988, loss: 0.035 | Test acc: 0.981, loss: 0.063 | Time: 1.07s
[Epoch 13] Train acc: 0.991, loss: 0.025 | Test acc: 0.982, loss: 0.056 | Time: 1.07s
[Epoch 14] Train acc: 0.992, loss: 0.025 | Test acc: 0.983, loss: 0.053 | Time: 1.10s
[Epoch 15] Train acc: 0.994, loss: 0.019 | Test acc: 0.985, loss: 0.049 | Time: 1.07s
[Epoch 16] Train acc: 0.994, loss: 0.018 | Test acc: 0.985, loss: 0.045 | Time: 1.07s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.987, loss: 0.039 | Time: 1.08s
[Epoch 18] Train acc: 0.996, loss: 0.012 | Test acc: 0.986, loss: 0.042 | Time: 1.12s
[Epoch 19] Train acc: 0.998, loss: 0.008 | Test acc: 0.987, loss: 0.040 | Time: 1.08s
[Epoch 20] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.035 | Time: 1.09s
[Epoch 21] Train acc: 0.999, loss: 0.006 | Test acc: 0.988, loss: 0.039 | Time: 1.08s
[Epoch 22] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.036 | Time: 1.09s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.035 | Time: 1.10s
[Epoch 24] Train acc: 0.999, loss: 0.005 | Test acc: 0.988, loss: 0.038 | Time: 1.10s
[Epoch 25] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.034 | Time: 1.09s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.038 | Time: 1.08s
[Epoch 27] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.034 | Time: 1.09s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.037 | Time: 1.08s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.034 | Time: 1.07s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.037 | Time: 1.08s
[Epoch 31] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.033 | Time: 1.09s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.036 | Time: 1.09s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.033 | Time: 1.10s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.034 | Time: 1.09s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.033 | Time: 1.11s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.033 | Time: 1.09s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.033 | Time: 1.16s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.032 | Time: 1.19s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.032 | Time: 1.11s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.032 | Time: 1.11s
Total training time: 71.95s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed7_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.970, loss: 0.091 | Test acc: 0.966, loss: 0.096 | Time: 2.95s
[Epoch 2] Train acc: 0.989, loss: 0.033 | Test acc: 0.988, loss: 0.038 | Time: 1.06s
[Epoch 3] Train acc: 0.992, loss: 0.024 | Test acc: 0.988, loss: 0.037 | Time: 1.08s
[Epoch 4] Train acc: 0.989, loss: 0.036 | Test acc: 0.981, loss: 0.055 | Time: 1.10s
[Epoch 5] Train acc: 0.990, loss: 0.030 | Test acc: 0.986, loss: 0.047 | Time: 1.11s
[Epoch 6] Train acc: 0.990, loss: 0.030 | Test acc: 0.983, loss: 0.059 | Time: 1.10s
[Epoch 7] Train acc: 0.992, loss: 0.024 | Test acc: 0.986, loss: 0.044 | Time: 1.10s
[Epoch 8] Train acc: 0.986, loss: 0.047 | Test acc: 0.980, loss: 0.070 | Time: 1.09s
[Epoch 9] Train acc: 0.996, loss: 0.014 | Test acc: 0.989, loss: 0.038 | Time: 1.10s
[Epoch 10] Train acc: 0.994, loss: 0.019 | Test acc: 0.987, loss: 0.044 | Time: 1.10s
[Epoch 11] Train acc: 0.997, loss: 0.010 | Test acc: 0.992, loss: 0.029 | Time: 1.10s
[Epoch 12] Train acc: 0.997, loss: 0.009 | Test acc: 0.994, loss: 0.027 | Time: 1.10s
[Epoch 13] Train acc: 0.993, loss: 0.023 | Test acc: 0.987, loss: 0.055 | Time: 1.10s
[Epoch 14] Train acc: 0.997, loss: 0.011 | Test acc: 0.991, loss: 0.034 | Time: 1.13s
[Epoch 15] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.047 | Time: 1.17s
[Epoch 16] Train acc: 0.995, loss: 0.014 | Test acc: 0.989, loss: 0.045 | Time: 1.10s
[Epoch 17] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.039 | Time: 1.12s
[Epoch 18] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.043 | Time: 1.17s
[Epoch 19] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.036 | Time: 1.10s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.042 | Time: 1.10s
[Epoch 21] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.041 | Time: 1.11s
[Epoch 22] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.048 | Time: 1.11s
[Epoch 23] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.039 | Time: 1.11s
[Epoch 24] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.051 | Time: 1.12s
[Epoch 25] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.042 | Time: 1.13s
[Epoch 26] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.047 | Time: 1.11s
[Epoch 27] Train acc: 0.993, loss: 0.024 | Test acc: 0.987, loss: 0.067 | Time: 1.21s
[Epoch 28] Train acc: 0.996, loss: 0.013 | Test acc: 0.990, loss: 0.048 | Time: 1.25s
[Epoch 29] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.049 | Time: 1.24s
[Epoch 30] Train acc: 0.997, loss: 0.009 | Test acc: 0.993, loss: 0.040 | Time: 1.24s
[Epoch 31] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.048 | Time: 1.15s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.038 | Time: 1.15s
[Epoch 33] Train acc: 0.995, loss: 0.023 | Test acc: 0.988, loss: 0.078 | Time: 1.14s
[Epoch 34] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.055 | Time: 1.13s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.037 | Time: 1.17s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.043 | Time: 1.16s
[Epoch 37] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.052 | Time: 1.16s
[Epoch 38] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.044 | Time: 1.18s
[Epoch 39] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.049 | Time: 1.19s
[Epoch 40] Train acc: 0.998, loss: 0.008 | Test acc: 0.992, loss: 0.052 | Time: 1.16s
Total training time: 71.76s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed7_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.983, loss: 0.056 | Test acc: 0.981, loss: 0.058 | Time: 2.97s
[Epoch 2] Train acc: 0.988, loss: 0.036 | Test acc: 0.986, loss: 0.045 | Time: 1.07s
[Epoch 3] Train acc: 0.990, loss: 0.033 | Test acc: 0.984, loss: 0.046 | Time: 1.09s
[Epoch 4] Train acc: 0.990, loss: 0.031 | Test acc: 0.986, loss: 0.046 | Time: 1.09s
[Epoch 5] Train acc: 0.991, loss: 0.029 | Test acc: 0.984, loss: 0.047 | Time: 1.08s
[Epoch 6] Train acc: 0.989, loss: 0.035 | Test acc: 0.982, loss: 0.057 | Time: 1.10s
[Epoch 7] Train acc: 0.994, loss: 0.017 | Test acc: 0.989, loss: 0.037 | Time: 1.10s
[Epoch 8] Train acc: 0.989, loss: 0.034 | Test acc: 0.983, loss: 0.059 | Time: 1.09s
[Epoch 9] Train acc: 0.992, loss: 0.026 | Test acc: 0.987, loss: 0.047 | Time: 1.09s
[Epoch 10] Train acc: 0.993, loss: 0.022 | Test acc: 0.988, loss: 0.053 | Time: 1.09s
[Epoch 11] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.040 | Time: 1.13s
[Epoch 12] Train acc: 0.991, loss: 0.027 | Test acc: 0.986, loss: 0.058 | Time: 1.10s
[Epoch 13] Train acc: 0.980, loss: 0.074 | Test acc: 0.973, loss: 0.103 | Time: 1.10s
[Epoch 14] Train acc: 0.993, loss: 0.022 | Test acc: 0.986, loss: 0.056 | Time: 1.10s
[Epoch 15] Train acc: 0.994, loss: 0.020 | Test acc: 0.988, loss: 0.052 | Time: 1.11s
[Epoch 16] Train acc: 0.996, loss: 0.010 | Test acc: 0.990, loss: 0.040 | Time: 1.10s
[Epoch 17] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.045 | Time: 1.11s
[Epoch 18] Train acc: 0.994, loss: 0.021 | Test acc: 0.986, loss: 0.064 | Time: 1.09s
[Epoch 19] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.043 | Time: 1.10s
[Epoch 20] Train acc: 0.996, loss: 0.014 | Test acc: 0.991, loss: 0.042 | Time: 1.12s
[Epoch 21] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.048 | Time: 1.11s
[Epoch 22] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.048 | Time: 1.11s
[Epoch 23] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.045 | Time: 1.11s
[Epoch 24] Train acc: 0.997, loss: 0.007 | Test acc: 0.989, loss: 0.043 | Time: 1.10s
[Epoch 25] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.039 | Time: 1.10s
[Epoch 26] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.049 | Time: 1.22s
[Epoch 27] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.054 | Time: 1.18s
[Epoch 28] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.040 | Time: 1.18s
[Epoch 29] Train acc: 0.996, loss: 0.014 | Test acc: 0.989, loss: 0.058 | Time: 1.17s
[Epoch 30] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.034 | Time: 1.18s
[Epoch 31] Train acc: 0.992, loss: 0.035 | Test acc: 0.986, loss: 0.086 | Time: 1.17s
[Epoch 32] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.049 | Time: 1.19s
[Epoch 33] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.066 | Time: 1.20s
[Epoch 34] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.072 | Time: 1.21s
[Epoch 35] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.048 | Time: 1.21s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.039 | Time: 1.19s
[Epoch 37] Train acc: 0.998, loss: 0.004 | Test acc: 0.990, loss: 0.049 | Time: 1.19s
[Epoch 38] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.039 | Time: 1.20s
[Epoch 39] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.049 | Time: 1.23s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.041 | Time: 1.20s
Total training time: 71.25s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed7_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/Adam.learning_rate = 0.0003
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/FullES.recompute_samples = 100
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/GradientAccumulator.num_average = 20
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/HyperV2.param_inits = 256
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.lopt = @HyperV2()
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.num_estimators = 8
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.num_steps = 100000
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.staleness = 500
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.summary_every_n = 25
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/run_train.trainer_batch_size = 512
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__9fd302ae_cbd6_4f29_9c27_a0b292707c28/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.979, loss: 0.067 | Test acc: 0.976, loss: 0.076 | Time: 25.39s
[Epoch 2] Train acc: 0.989, loss: 0.037 | Test acc: 0.984, loss: 0.049 | Time: 1.91s
[Epoch 3] Train acc: 0.993, loss: 0.023 | Test acc: 0.986, loss: 0.039 | Time: 1.94s
[Epoch 4] Train acc: 0.988, loss: 0.037 | Test acc: 0.981, loss: 0.060 | Time: 1.92s
[Epoch 5] Train acc: 0.995, loss: 0.016 | Test acc: 0.988, loss: 0.039 | Time: 1.95s
[Epoch 6] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.041 | Time: 1.92s
[Epoch 7] Train acc: 0.992, loss: 0.026 | Test acc: 0.984, loss: 0.061 | Time: 1.92s
[Epoch 8] Train acc: 0.994, loss: 0.017 | Test acc: 0.986, loss: 0.053 | Time: 1.94s
[Epoch 9] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.047 | Time: 1.94s
[Epoch 10] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.043 | Time: 1.94s
[Epoch 11] Train acc: 0.996, loss: 0.011 | Test acc: 0.987, loss: 0.047 | Time: 1.95s
[Epoch 12] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.044 | Time: 1.93s
[Epoch 13] Train acc: 0.994, loss: 0.017 | Test acc: 0.987, loss: 0.055 | Time: 1.92s
[Epoch 14] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.055 | Time: 1.93s
[Epoch 15] Train acc: 0.996, loss: 0.011 | Test acc: 0.987, loss: 0.053 | Time: 1.92s
[Epoch 16] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.042 | Time: 1.94s
[Epoch 17] Train acc: 0.995, loss: 0.014 | Test acc: 0.986, loss: 0.061 | Time: 1.93s
[Epoch 18] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.041 | Time: 1.94s
[Epoch 19] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.044 | Time: 1.93s
[Epoch 20] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.042 | Time: 1.95s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.040 | Time: 1.95s
[Epoch 22] Train acc: 0.997, loss: 0.007 | Test acc: 0.992, loss: 0.036 | Time: 1.94s
[Epoch 23] Train acc: 0.998, loss: 0.006 | Test acc: 0.988, loss: 0.053 | Time: 1.94s
[Epoch 24] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.045 | Time: 1.95s
[Epoch 25] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.040 | Time: 1.94s
[Epoch 26] Train acc: 0.998, loss: 0.006 | Test acc: 0.989, loss: 0.056 | Time: 1.95s
[Epoch 27] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.047 | Time: 1.95s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.042 | Time: 1.95s
[Epoch 29] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.046 | Time: 1.94s
[Epoch 30] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.058 | Time: 2.00s
[Epoch 31] Train acc: 0.998, loss: 0.004 | Test acc: 0.989, loss: 0.056 | Time: 1.95s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.054 | Time: 1.97s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.047 | Time: 1.98s
[Epoch 34] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.055 | Time: 1.98s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.057 | Time: 1.96s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.051 | Time: 1.98s
[Epoch 37] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.062 | Time: 1.98s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.050 | Time: 1.99s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.049 | Time: 2.02s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.048 | Time: 2.03s
Total training time: 125.00s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed8_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.419, loss: 1.813 | Test acc: 0.415, loss: 1.815 | Time: 2.58s
[Epoch 2] Train acc: 0.588, loss: 1.467 | Test acc: 0.588, loss: 1.464 | Time: 0.93s
[Epoch 3] Train acc: 0.784, loss: 0.980 | Test acc: 0.790, loss: 0.975 | Time: 0.95s
[Epoch 4] Train acc: 0.889, loss: 0.556 | Test acc: 0.895, loss: 0.548 | Time: 0.96s
[Epoch 5] Train acc: 0.930, loss: 0.341 | Test acc: 0.933, loss: 0.332 | Time: 0.96s
[Epoch 6] Train acc: 0.949, loss: 0.238 | Test acc: 0.952, loss: 0.230 | Time: 0.96s
[Epoch 7] Train acc: 0.958, loss: 0.186 | Test acc: 0.959, loss: 0.181 | Time: 0.96s
[Epoch 8] Train acc: 0.958, loss: 0.168 | Test acc: 0.961, loss: 0.162 | Time: 0.96s
[Epoch 9] Train acc: 0.962, loss: 0.147 | Test acc: 0.966, loss: 0.142 | Time: 0.99s
[Epoch 10] Train acc: 0.966, loss: 0.132 | Test acc: 0.968, loss: 0.130 | Time: 0.97s
[Epoch 11] Train acc: 0.970, loss: 0.114 | Test acc: 0.969, loss: 0.115 | Time: 0.97s
[Epoch 12] Train acc: 0.975, loss: 0.097 | Test acc: 0.973, loss: 0.101 | Time: 0.96s
[Epoch 13] Train acc: 0.977, loss: 0.090 | Test acc: 0.974, loss: 0.095 | Time: 0.97s
[Epoch 14] Train acc: 0.974, loss: 0.096 | Test acc: 0.971, loss: 0.102 | Time: 0.96s
[Epoch 15] Train acc: 0.980, loss: 0.077 | Test acc: 0.977, loss: 0.085 | Time: 0.96s
[Epoch 16] Train acc: 0.981, loss: 0.075 | Test acc: 0.978, loss: 0.083 | Time: 0.97s
[Epoch 17] Train acc: 0.985, loss: 0.059 | Test acc: 0.981, loss: 0.067 | Time: 0.97s
[Epoch 18] Train acc: 0.981, loss: 0.070 | Test acc: 0.978, loss: 0.080 | Time: 0.97s
[Epoch 19] Train acc: 0.987, loss: 0.050 | Test acc: 0.984, loss: 0.058 | Time: 0.97s
[Epoch 20] Train acc: 0.981, loss: 0.069 | Test acc: 0.979, loss: 0.078 | Time: 0.98s
[Epoch 21] Train acc: 0.983, loss: 0.062 | Test acc: 0.980, loss: 0.071 | Time: 0.97s
[Epoch 22] Train acc: 0.989, loss: 0.045 | Test acc: 0.985, loss: 0.056 | Time: 0.97s
[Epoch 23] Train acc: 0.987, loss: 0.049 | Test acc: 0.981, loss: 0.062 | Time: 0.97s
[Epoch 24] Train acc: 0.990, loss: 0.040 | Test acc: 0.984, loss: 0.053 | Time: 0.97s
[Epoch 25] Train acc: 0.986, loss: 0.051 | Test acc: 0.978, loss: 0.068 | Time: 0.98s
[Epoch 26] Train acc: 0.977, loss: 0.072 | Test acc: 0.972, loss: 0.090 | Time: 0.98s
[Epoch 27] Train acc: 0.972, loss: 0.085 | Test acc: 0.966, loss: 0.105 | Time: 0.98s
[Epoch 28] Train acc: 0.986, loss: 0.049 | Test acc: 0.979, loss: 0.065 | Time: 0.98s
[Epoch 29] Train acc: 0.988, loss: 0.042 | Test acc: 0.982, loss: 0.057 | Time: 0.98s
[Epoch 30] Train acc: 0.991, loss: 0.036 | Test acc: 0.983, loss: 0.052 | Time: 0.97s
[Epoch 31] Train acc: 0.992, loss: 0.033 | Test acc: 0.984, loss: 0.051 | Time: 0.99s
[Epoch 32] Train acc: 0.993, loss: 0.030 | Test acc: 0.985, loss: 0.048 | Time: 1.00s
[Epoch 33] Train acc: 0.989, loss: 0.038 | Test acc: 0.982, loss: 0.058 | Time: 1.01s
[Epoch 34] Train acc: 0.995, loss: 0.023 | Test acc: 0.988, loss: 0.040 | Time: 1.01s
[Epoch 35] Train acc: 0.994, loss: 0.024 | Test acc: 0.987, loss: 0.042 | Time: 1.01s
[Epoch 36] Train acc: 0.995, loss: 0.023 | Test acc: 0.988, loss: 0.040 | Time: 1.02s
[Epoch 37] Train acc: 0.995, loss: 0.022 | Test acc: 0.989, loss: 0.040 | Time: 1.03s
[Epoch 38] Train acc: 0.995, loss: 0.020 | Test acc: 0.988, loss: 0.039 | Time: 1.03s
[Epoch 39] Train acc: 0.995, loss: 0.021 | Test acc: 0.988, loss: 0.039 | Time: 1.05s
[Epoch 40] Train acc: 0.995, loss: 0.020 | Test acc: 0.988, loss: 0.040 | Time: 1.04s
Total training time: 64.61s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed8_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.901, loss: 0.319 | Test acc: 0.901, loss: 0.315 | Time: 2.69s
[Epoch 2] Train acc: 0.917, loss: 0.267 | Test acc: 0.914, loss: 0.266 | Time: 0.98s
[Epoch 3] Train acc: 0.954, loss: 0.142 | Test acc: 0.956, loss: 0.141 | Time: 1.01s
[Epoch 4] Train acc: 0.975, loss: 0.082 | Test acc: 0.975, loss: 0.086 | Time: 1.02s
[Epoch 5] Train acc: 0.973, loss: 0.083 | Test acc: 0.973, loss: 0.087 | Time: 1.01s
[Epoch 6] Train acc: 0.982, loss: 0.055 | Test acc: 0.979, loss: 0.066 | Time: 1.01s
[Epoch 7] Train acc: 0.984, loss: 0.051 | Test acc: 0.978, loss: 0.066 | Time: 1.02s
[Epoch 8] Train acc: 0.990, loss: 0.034 | Test acc: 0.981, loss: 0.051 | Time: 1.01s
[Epoch 9] Train acc: 0.990, loss: 0.031 | Test acc: 0.981, loss: 0.055 | Time: 1.04s
[Epoch 10] Train acc: 0.992, loss: 0.026 | Test acc: 0.982, loss: 0.050 | Time: 1.01s
[Epoch 11] Train acc: 0.994, loss: 0.020 | Test acc: 0.985, loss: 0.045 | Time: 1.01s
[Epoch 12] Train acc: 0.993, loss: 0.021 | Test acc: 0.985, loss: 0.046 | Time: 1.01s
[Epoch 13] Train acc: 0.997, loss: 0.012 | Test acc: 0.989, loss: 0.036 | Time: 1.02s
[Epoch 14] Train acc: 0.994, loss: 0.017 | Test acc: 0.986, loss: 0.042 | Time: 1.02s
[Epoch 15] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.033 | Time: 1.21s
[Epoch 16] Train acc: 0.996, loss: 0.011 | Test acc: 0.988, loss: 0.036 | Time: 1.07s
[Epoch 17] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.034 | Time: 1.11s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.032 | Time: 1.12s
[Epoch 19] Train acc: 0.998, loss: 0.008 | Test acc: 0.989, loss: 0.034 | Time: 1.09s
[Epoch 20] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.032 | Time: 1.10s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.032 | Time: 1.12s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.031 | Time: 1.02s
[Epoch 23] Train acc: 0.999, loss: 0.005 | Test acc: 0.990, loss: 0.032 | Time: 1.02s
[Epoch 24] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.034 | Time: 1.02s
[Epoch 25] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.031 | Time: 1.19s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.033 | Time: 1.07s
[Epoch 27] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.030 | Time: 1.03s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.033 | Time: 1.07s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.033 | Time: 1.10s
[Epoch 30] Train acc: 0.999, loss: 0.003 | Test acc: 0.989, loss: 0.035 | Time: 1.15s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.990, loss: 0.035 | Time: 1.05s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.035 | Time: 1.06s
[Epoch 33] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.035 | Time: 1.10s
[Epoch 34] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.033 | Time: 1.08s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.990, loss: 0.032 | Time: 1.07s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.030 | Time: 1.08s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.031 | Time: 1.09s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.029 | Time: 1.09s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.030 | Time: 1.10s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.028 | Time: 1.09s
Total training time: 69.27s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed8_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.976, loss: 0.076 | Test acc: 0.974, loss: 0.078 | Time: 2.95s
[Epoch 2] Train acc: 0.983, loss: 0.053 | Test acc: 0.979, loss: 0.061 | Time: 1.05s
[Epoch 3] Train acc: 0.987, loss: 0.040 | Test acc: 0.986, loss: 0.046 | Time: 1.07s
[Epoch 4] Train acc: 0.982, loss: 0.060 | Test acc: 0.981, loss: 0.069 | Time: 1.06s
[Epoch 5] Train acc: 0.988, loss: 0.036 | Test acc: 0.983, loss: 0.051 | Time: 1.07s
[Epoch 6] Train acc: 0.995, loss: 0.016 | Test acc: 0.991, loss: 0.032 | Time: 1.07s
[Epoch 7] Train acc: 0.992, loss: 0.025 | Test acc: 0.986, loss: 0.046 | Time: 1.08s
[Epoch 8] Train acc: 0.993, loss: 0.022 | Test acc: 0.988, loss: 0.047 | Time: 1.18s
[Epoch 9] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.039 | Time: 1.12s
[Epoch 10] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.038 | Time: 1.17s
[Epoch 11] Train acc: 0.994, loss: 0.019 | Test acc: 0.989, loss: 0.042 | Time: 1.19s
[Epoch 12] Train acc: 0.994, loss: 0.021 | Test acc: 0.988, loss: 0.057 | Time: 1.21s
[Epoch 13] Train acc: 0.997, loss: 0.010 | Test acc: 0.991, loss: 0.035 | Time: 1.24s
[Epoch 14] Train acc: 0.989, loss: 0.032 | Test acc: 0.983, loss: 0.072 | Time: 1.14s
[Epoch 15] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.043 | Time: 1.13s
[Epoch 16] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.049 | Time: 1.13s
[Epoch 17] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.038 | Time: 1.14s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.050 | Time: 1.18s
[Epoch 19] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.038 | Time: 1.13s
[Epoch 20] Train acc: 0.996, loss: 0.014 | Test acc: 0.989, loss: 0.052 | Time: 1.14s
[Epoch 21] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.049 | Time: 1.13s
[Epoch 22] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.040 | Time: 1.14s
[Epoch 23] Train acc: 0.996, loss: 0.013 | Test acc: 0.986, loss: 0.063 | Time: 1.13s
[Epoch 24] Train acc: 0.999, loss: 0.005 | Test acc: 0.991, loss: 0.050 | Time: 1.15s
[Epoch 25] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.045 | Time: 1.13s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.994, loss: 0.032 | Time: 1.15s
[Epoch 27] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.038 | Time: 1.16s
[Epoch 28] Train acc: 0.996, loss: 0.014 | Test acc: 0.989, loss: 0.049 | Time: 1.17s
[Epoch 29] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.043 | Time: 1.16s
[Epoch 30] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.042 | Time: 1.40s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.043 | Time: 1.27s
[Epoch 32] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.049 | Time: 1.18s
[Epoch 33] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.053 | Time: 1.16s
[Epoch 34] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.044 | Time: 1.19s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.039 | Time: 1.17s
[Epoch 36] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.064 | Time: 1.20s
[Epoch 37] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.042 | Time: 1.19s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.043 | Time: 1.18s
[Epoch 39] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.050 | Time: 1.22s
[Epoch 40] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.062 | Time: 1.21s
Total training time: 73.61s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed8_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.977, loss: 0.072 | Test acc: 0.975, loss: 0.077 | Time: 2.99s
[Epoch 2] Train acc: 0.985, loss: 0.048 | Test acc: 0.980, loss: 0.059 | Time: 1.10s
[Epoch 3] Train acc: 0.989, loss: 0.034 | Test acc: 0.987, loss: 0.045 | Time: 1.13s
[Epoch 4] Train acc: 0.989, loss: 0.036 | Test acc: 0.985, loss: 0.054 | Time: 1.13s
[Epoch 5] Train acc: 0.989, loss: 0.032 | Test acc: 0.987, loss: 0.047 | Time: 1.14s
[Epoch 6] Train acc: 0.991, loss: 0.028 | Test acc: 0.985, loss: 0.049 | Time: 1.13s
[Epoch 7] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.040 | Time: 1.15s
[Epoch 8] Train acc: 0.994, loss: 0.019 | Test acc: 0.987, loss: 0.048 | Time: 1.14s
[Epoch 9] Train acc: 0.992, loss: 0.023 | Test acc: 0.988, loss: 0.049 | Time: 1.15s
[Epoch 10] Train acc: 0.989, loss: 0.034 | Test acc: 0.982, loss: 0.070 | Time: 1.19s
[Epoch 11] Train acc: 0.994, loss: 0.020 | Test acc: 0.988, loss: 0.049 | Time: 1.17s
[Epoch 12] Train acc: 0.995, loss: 0.015 | Test acc: 0.989, loss: 0.041 | Time: 1.17s
[Epoch 13] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.033 | Time: 1.15s
[Epoch 14] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.045 | Time: 1.17s
[Epoch 15] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.049 | Time: 1.15s
[Epoch 16] Train acc: 0.993, loss: 0.019 | Test acc: 0.985, loss: 0.056 | Time: 1.16s
[Epoch 17] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.048 | Time: 1.16s
[Epoch 18] Train acc: 0.992, loss: 0.024 | Test acc: 0.987, loss: 0.049 | Time: 1.16s
[Epoch 19] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.039 | Time: 1.15s
[Epoch 20] Train acc: 0.998, loss: 0.008 | Test acc: 0.990, loss: 0.055 | Time: 1.40s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.042 | Time: 1.16s
[Epoch 22] Train acc: 0.992, loss: 0.025 | Test acc: 0.986, loss: 0.062 | Time: 1.17s
[Epoch 23] Train acc: 0.998, loss: 0.004 | Test acc: 0.992, loss: 0.032 | Time: 1.17s
[Epoch 24] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.043 | Time: 1.16s
[Epoch 25] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.051 | Time: 1.16s
[Epoch 26] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.038 | Time: 1.17s
[Epoch 27] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.050 | Time: 1.18s
[Epoch 28] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.056 | Time: 1.17s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.034 | Time: 1.15s
[Epoch 30] Train acc: 0.995, loss: 0.021 | Test acc: 0.988, loss: 0.061 | Time: 1.16s
[Epoch 31] Train acc: 0.994, loss: 0.022 | Test acc: 0.985, loss: 0.070 | Time: 1.16s
[Epoch 32] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.055 | Time: 1.17s
[Epoch 33] Train acc: 0.996, loss: 0.015 | Test acc: 0.988, loss: 0.068 | Time: 1.18s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.040 | Time: 1.19s
[Epoch 35] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.049 | Time: 1.19s
[Epoch 36] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.044 | Time: 1.18s
[Epoch 37] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.036 | Time: 1.18s
[Epoch 38] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.059 | Time: 1.18s
[Epoch 39] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.051 | Time: 1.19s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.039 | Time: 1.17s
Total training time: 75.04s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed8_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/Adam.learning_rate = 0.0003
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/FullES.recompute_samples = 100
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/GradientAccumulator.num_average = 20
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/HyperV2.param_inits = 256
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.lopt = @HyperV2()
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.num_estimators = 8
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.num_steps = 100000
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.staleness = 500
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.summary_every_n = 25
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/run_train.trainer_batch_size = 512
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__82bdb48c_c43b_429a_adb4_e10630dfc120/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.967, loss: 0.105 | Test acc: 0.968, loss: 0.111 | Time: 26.23s
[Epoch 2] Train acc: 0.982, loss: 0.058 | Test acc: 0.981, loss: 0.067 | Time: 1.93s
[Epoch 3] Train acc: 0.991, loss: 0.028 | Test acc: 0.985, loss: 0.043 | Time: 2.00s
[Epoch 4] Train acc: 0.993, loss: 0.022 | Test acc: 0.987, loss: 0.039 | Time: 1.98s
[Epoch 5] Train acc: 0.994, loss: 0.017 | Test acc: 0.987, loss: 0.042 | Time: 2.00s
[Epoch 6] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.043 | Time: 2.02s
[Epoch 7] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.040 | Time: 2.03s
[Epoch 8] Train acc: 0.993, loss: 0.020 | Test acc: 0.988, loss: 0.042 | Time: 2.03s
[Epoch 9] Train acc: 0.994, loss: 0.017 | Test acc: 0.988, loss: 0.050 | Time: 2.03s
[Epoch 10] Train acc: 0.993, loss: 0.021 | Test acc: 0.986, loss: 0.055 | Time: 2.01s
[Epoch 11] Train acc: 0.994, loss: 0.018 | Test acc: 0.986, loss: 0.052 | Time: 2.02s
[Epoch 12] Train acc: 0.996, loss: 0.013 | Test acc: 0.990, loss: 0.042 | Time: 2.01s
[Epoch 13] Train acc: 0.993, loss: 0.020 | Test acc: 0.985, loss: 0.063 | Time: 1.97s
[Epoch 14] Train acc: 0.994, loss: 0.017 | Test acc: 0.988, loss: 0.053 | Time: 1.98s
[Epoch 15] Train acc: 0.997, loss: 0.008 | Test acc: 0.988, loss: 0.043 | Time: 2.00s
[Epoch 16] Train acc: 0.994, loss: 0.018 | Test acc: 0.987, loss: 0.053 | Time: 2.00s
[Epoch 17] Train acc: 0.996, loss: 0.010 | Test acc: 0.989, loss: 0.043 | Time: 2.02s
[Epoch 18] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.042 | Time: 2.00s
[Epoch 19] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.045 | Time: 2.01s
[Epoch 20] Train acc: 0.997, loss: 0.010 | Test acc: 0.991, loss: 0.035 | Time: 2.00s
[Epoch 21] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.040 | Time: 2.01s
[Epoch 22] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.039 | Time: 2.03s
[Epoch 23] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.040 | Time: 2.01s
[Epoch 24] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.036 | Time: 2.02s
[Epoch 25] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.034 | Time: 2.02s
[Epoch 26] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.047 | Time: 2.02s
[Epoch 27] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.050 | Time: 2.01s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.038 | Time: 2.02s
[Epoch 29] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.052 | Time: 2.01s
[Epoch 30] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.047 | Time: 2.03s
[Epoch 31] Train acc: 0.998, loss: 0.004 | Test acc: 0.991, loss: 0.046 | Time: 2.03s
[Epoch 32] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.042 | Time: 2.03s
[Epoch 33] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.043 | Time: 2.05s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.043 | Time: 2.06s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.048 | Time: 2.08s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.042 | Time: 2.07s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.040 | Time: 2.07s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.038 | Time: 2.05s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.036 | Time: 2.11s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.037 | Time: 2.10s
Total training time: 128.76s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed9_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.383, loss: 1.892 | Test acc: 0.382, loss: 1.893 | Time: 2.61s
[Epoch 2] Train acc: 0.542, loss: 1.560 | Test acc: 0.546, loss: 1.557 | Time: 0.96s
[Epoch 3] Train acc: 0.710, loss: 1.165 | Test acc: 0.712, loss: 1.163 | Time: 0.97s
[Epoch 4] Train acc: 0.879, loss: 0.675 | Test acc: 0.883, loss: 0.672 | Time: 0.97s
[Epoch 5] Train acc: 0.929, loss: 0.374 | Test acc: 0.932, loss: 0.369 | Time: 0.96s
[Epoch 6] Train acc: 0.947, loss: 0.249 | Test acc: 0.951, loss: 0.244 | Time: 0.97s
[Epoch 7] Train acc: 0.950, loss: 0.214 | Test acc: 0.951, loss: 0.213 | Time: 0.97s
[Epoch 8] Train acc: 0.954, loss: 0.187 | Test acc: 0.956, loss: 0.187 | Time: 0.96s
[Epoch 9] Train acc: 0.965, loss: 0.142 | Test acc: 0.967, loss: 0.143 | Time: 0.97s
[Epoch 10] Train acc: 0.970, loss: 0.121 | Test acc: 0.970, loss: 0.124 | Time: 0.97s
[Epoch 11] Train acc: 0.973, loss: 0.108 | Test acc: 0.971, loss: 0.112 | Time: 0.97s
[Epoch 12] Train acc: 0.978, loss: 0.089 | Test acc: 0.976, loss: 0.094 | Time: 0.97s
[Epoch 13] Train acc: 0.979, loss: 0.087 | Test acc: 0.977, loss: 0.092 | Time: 0.97s
[Epoch 14] Train acc: 0.977, loss: 0.091 | Test acc: 0.973, loss: 0.099 | Time: 0.97s
[Epoch 15] Train acc: 0.981, loss: 0.072 | Test acc: 0.977, loss: 0.081 | Time: 0.97s
[Epoch 16] Train acc: 0.981, loss: 0.071 | Test acc: 0.977, loss: 0.080 | Time: 0.97s
[Epoch 17] Train acc: 0.978, loss: 0.080 | Test acc: 0.972, loss: 0.091 | Time: 0.96s
[Epoch 18] Train acc: 0.976, loss: 0.083 | Test acc: 0.972, loss: 0.096 | Time: 0.97s
[Epoch 19] Train acc: 0.983, loss: 0.065 | Test acc: 0.977, loss: 0.077 | Time: 0.97s
[Epoch 20] Train acc: 0.985, loss: 0.057 | Test acc: 0.982, loss: 0.067 | Time: 0.98s
[Epoch 21] Train acc: 0.986, loss: 0.054 | Test acc: 0.981, loss: 0.066 | Time: 0.97s
[Epoch 22] Train acc: 0.985, loss: 0.055 | Test acc: 0.978, loss: 0.069 | Time: 0.97s
[Epoch 23] Train acc: 0.987, loss: 0.050 | Test acc: 0.982, loss: 0.064 | Time: 0.97s
[Epoch 24] Train acc: 0.986, loss: 0.051 | Test acc: 0.982, loss: 0.066 | Time: 0.98s
[Epoch 25] Train acc: 0.988, loss: 0.045 | Test acc: 0.982, loss: 0.060 | Time: 0.98s
[Epoch 26] Train acc: 0.989, loss: 0.045 | Test acc: 0.980, loss: 0.062 | Time: 0.98s
[Epoch 27] Train acc: 0.984, loss: 0.059 | Test acc: 0.978, loss: 0.075 | Time: 0.98s
[Epoch 28] Train acc: 0.989, loss: 0.043 | Test acc: 0.981, loss: 0.060 | Time: 0.98s
[Epoch 29] Train acc: 0.987, loss: 0.048 | Test acc: 0.977, loss: 0.068 | Time: 0.98s
[Epoch 30] Train acc: 0.991, loss: 0.037 | Test acc: 0.981, loss: 0.057 | Time: 0.98s
[Epoch 31] Train acc: 0.992, loss: 0.034 | Test acc: 0.981, loss: 0.057 | Time: 0.99s
[Epoch 32] Train acc: 0.991, loss: 0.035 | Test acc: 0.981, loss: 0.057 | Time: 0.99s
[Epoch 33] Train acc: 0.989, loss: 0.043 | Test acc: 0.978, loss: 0.067 | Time: 1.02s
[Epoch 34] Train acc: 0.994, loss: 0.025 | Test acc: 0.985, loss: 0.046 | Time: 1.02s
[Epoch 35] Train acc: 0.994, loss: 0.025 | Test acc: 0.986, loss: 0.046 | Time: 1.01s
[Epoch 36] Train acc: 0.993, loss: 0.028 | Test acc: 0.983, loss: 0.050 | Time: 1.01s
[Epoch 37] Train acc: 0.995, loss: 0.023 | Test acc: 0.987, loss: 0.045 | Time: 1.01s
[Epoch 38] Train acc: 0.993, loss: 0.025 | Test acc: 0.987, loss: 0.046 | Time: 1.01s
[Epoch 39] Train acc: 0.993, loss: 0.028 | Test acc: 0.986, loss: 0.050 | Time: 1.05s
[Epoch 40] Train acc: 0.994, loss: 0.023 | Test acc: 0.987, loss: 0.045 | Time: 1.03s
Total training time: 64.43s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed9_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.927, loss: 0.241 | Test acc: 0.927, loss: 0.241 | Time: 2.68s
[Epoch 2] Train acc: 0.958, loss: 0.139 | Test acc: 0.955, loss: 0.152 | Time: 0.99s
[Epoch 3] Train acc: 0.980, loss: 0.070 | Test acc: 0.976, loss: 0.079 | Time: 1.01s
[Epoch 4] Train acc: 0.986, loss: 0.050 | Test acc: 0.979, loss: 0.063 | Time: 1.03s
[Epoch 5] Train acc: 0.989, loss: 0.038 | Test acc: 0.983, loss: 0.052 | Time: 1.05s
[Epoch 6] Train acc: 0.992, loss: 0.029 | Test acc: 0.987, loss: 0.043 | Time: 1.05s
[Epoch 7] Train acc: 0.991, loss: 0.030 | Test acc: 0.984, loss: 0.048 | Time: 1.05s
[Epoch 8] Train acc: 0.994, loss: 0.022 | Test acc: 0.988, loss: 0.040 | Time: 1.05s
[Epoch 9] Train acc: 0.995, loss: 0.018 | Test acc: 0.987, loss: 0.038 | Time: 1.05s
[Epoch 10] Train acc: 0.992, loss: 0.026 | Test acc: 0.985, loss: 0.049 | Time: 1.05s
[Epoch 11] Train acc: 0.995, loss: 0.018 | Test acc: 0.987, loss: 0.040 | Time: 1.04s
[Epoch 12] Train acc: 0.990, loss: 0.030 | Test acc: 0.984, loss: 0.056 | Time: 1.05s
[Epoch 13] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.039 | Time: 1.04s
[Epoch 14] Train acc: 0.993, loss: 0.021 | Test acc: 0.987, loss: 0.047 | Time: 1.05s
[Epoch 15] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.037 | Time: 1.04s
[Epoch 16] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.038 | Time: 1.04s
[Epoch 17] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.036 | Time: 1.04s
[Epoch 18] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.034 | Time: 1.05s
[Epoch 19] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.033 | Time: 1.04s
[Epoch 20] Train acc: 0.999, loss: 0.006 | Test acc: 0.989, loss: 0.035 | Time: 1.07s
[Epoch 21] Train acc: 0.999, loss: 0.004 | Test acc: 0.989, loss: 0.035 | Time: 1.05s
[Epoch 22] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.034 | Time: 1.04s
[Epoch 23] Train acc: 1.000, loss: 0.003 | Test acc: 0.989, loss: 0.036 | Time: 1.04s
[Epoch 24] Train acc: 1.000, loss: 0.003 | Test acc: 0.988, loss: 0.036 | Time: 1.28s
[Epoch 25] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.036 | Time: 1.07s
[Epoch 26] Train acc: 1.000, loss: 0.003 | Test acc: 0.988, loss: 0.039 | Time: 1.11s
[Epoch 27] Train acc: 1.000, loss: 0.002 | Test acc: 0.988, loss: 0.037 | Time: 1.14s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.988, loss: 0.038 | Time: 1.17s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.988, loss: 0.038 | Time: 1.15s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.988, loss: 0.040 | Time: 1.17s
[Epoch 31] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.038 | Time: 1.16s
[Epoch 32] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.040 | Time: 1.19s
[Epoch 33] Train acc: 1.000, loss: 0.002 | Test acc: 0.988, loss: 0.040 | Time: 1.09s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.037 | Time: 1.09s
[Epoch 35] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.040 | Time: 1.07s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.036 | Time: 1.14s
[Epoch 37] Train acc: 1.000, loss: 0.002 | Test acc: 0.989, loss: 0.040 | Time: 1.11s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.035 | Time: 1.11s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.038 | Time: 1.10s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.989, loss: 0.035 | Time: 1.08s
Total training time: 69.42s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed9_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.973, loss: 0.084 | Test acc: 0.974, loss: 0.087 | Time: 3.04s
[Epoch 2] Train acc: 0.978, loss: 0.068 | Test acc: 0.977, loss: 0.072 | Time: 1.07s
[Epoch 3] Train acc: 0.986, loss: 0.043 | Test acc: 0.982, loss: 0.058 | Time: 1.09s
[Epoch 4] Train acc: 0.989, loss: 0.032 | Test acc: 0.986, loss: 0.052 | Time: 1.09s
[Epoch 5] Train acc: 0.990, loss: 0.031 | Test acc: 0.984, loss: 0.047 | Time: 1.09s
[Epoch 6] Train acc: 0.992, loss: 0.023 | Test acc: 0.986, loss: 0.046 | Time: 1.10s
[Epoch 7] Train acc: 0.992, loss: 0.024 | Test acc: 0.985, loss: 0.055 | Time: 1.09s
[Epoch 8] Train acc: 0.995, loss: 0.016 | Test acc: 0.987, loss: 0.044 | Time: 1.09s
[Epoch 9] Train acc: 0.988, loss: 0.036 | Test acc: 0.982, loss: 0.068 | Time: 1.10s
[Epoch 10] Train acc: 0.987, loss: 0.042 | Test acc: 0.982, loss: 0.084 | Time: 1.09s
[Epoch 11] Train acc: 0.994, loss: 0.019 | Test acc: 0.986, loss: 0.052 | Time: 1.11s
[Epoch 12] Train acc: 0.991, loss: 0.029 | Test acc: 0.982, loss: 0.069 | Time: 1.13s
[Epoch 13] Train acc: 0.997, loss: 0.011 | Test acc: 0.991, loss: 0.042 | Time: 1.13s
[Epoch 14] Train acc: 0.995, loss: 0.014 | Test acc: 0.990, loss: 0.054 | Time: 1.13s
[Epoch 15] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.037 | Time: 1.13s
[Epoch 16] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.041 | Time: 1.13s
[Epoch 17] Train acc: 0.994, loss: 0.019 | Test acc: 0.987, loss: 0.065 | Time: 1.14s
[Epoch 18] Train acc: 0.997, loss: 0.011 | Test acc: 0.990, loss: 0.048 | Time: 1.13s
[Epoch 19] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.044 | Time: 1.15s
[Epoch 20] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.043 | Time: 1.13s
[Epoch 21] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.050 | Time: 1.13s
[Epoch 22] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.048 | Time: 1.13s
[Epoch 23] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.039 | Time: 1.14s
[Epoch 24] Train acc: 0.992, loss: 0.029 | Test acc: 0.987, loss: 0.069 | Time: 1.13s
[Epoch 25] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.048 | Time: 1.13s
[Epoch 26] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.056 | Time: 1.14s
[Epoch 27] Train acc: 0.995, loss: 0.020 | Test acc: 0.987, loss: 0.068 | Time: 1.14s
[Epoch 28] Train acc: 0.997, loss: 0.010 | Test acc: 0.991, loss: 0.055 | Time: 1.14s
[Epoch 29] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.043 | Time: 1.13s
[Epoch 30] Train acc: 0.998, loss: 0.006 | Test acc: 0.992, loss: 0.044 | Time: 1.14s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.037 | Time: 1.15s
[Epoch 32] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.047 | Time: 1.14s
[Epoch 33] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.062 | Time: 1.15s
[Epoch 34] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.049 | Time: 1.40s
[Epoch 35] Train acc: 0.998, loss: 0.008 | Test acc: 0.989, loss: 0.060 | Time: 1.16s
[Epoch 36] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.050 | Time: 1.16s
[Epoch 37] Train acc: 0.992, loss: 0.035 | Test acc: 0.983, loss: 0.090 | Time: 1.16s
[Epoch 38] Train acc: 0.998, loss: 0.005 | Test acc: 0.993, loss: 0.050 | Time: 1.16s
[Epoch 39] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.053 | Time: 1.21s
[Epoch 40] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.047 | Time: 1.18s
Total training time: 72.22s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed9_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.973, loss: 0.084 | Test acc: 0.970, loss: 0.082 | Time: 2.98s
[Epoch 2] Train acc: 0.984, loss: 0.050 | Test acc: 0.978, loss: 0.057 | Time: 1.06s
[Epoch 3] Train acc: 0.987, loss: 0.040 | Test acc: 0.983, loss: 0.050 | Time: 1.09s
[Epoch 4] Train acc: 0.992, loss: 0.025 | Test acc: 0.987, loss: 0.037 | Time: 1.10s
[Epoch 5] Train acc: 0.991, loss: 0.029 | Test acc: 0.984, loss: 0.044 | Time: 1.09s
[Epoch 6] Train acc: 0.981, loss: 0.063 | Test acc: 0.973, loss: 0.092 | Time: 1.10s
[Epoch 7] Train acc: 0.995, loss: 0.014 | Test acc: 0.989, loss: 0.036 | Time: 1.10s
[Epoch 8] Train acc: 0.994, loss: 0.019 | Test acc: 0.987, loss: 0.050 | Time: 1.09s
[Epoch 9] Train acc: 0.988, loss: 0.039 | Test acc: 0.980, loss: 0.075 | Time: 1.13s
[Epoch 10] Train acc: 0.990, loss: 0.030 | Test acc: 0.985, loss: 0.064 | Time: 1.12s
[Epoch 11] Train acc: 0.990, loss: 0.033 | Test acc: 0.981, loss: 0.076 | Time: 1.10s
[Epoch 12] Train acc: 0.992, loss: 0.024 | Test acc: 0.986, loss: 0.065 | Time: 1.11s
[Epoch 13] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.037 | Time: 1.11s
[Epoch 14] Train acc: 0.991, loss: 0.027 | Test acc: 0.985, loss: 0.060 | Time: 1.12s
[Epoch 15] Train acc: 0.996, loss: 0.015 | Test acc: 0.989, loss: 0.047 | Time: 1.10s
[Epoch 16] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.045 | Time: 1.10s
[Epoch 17] Train acc: 0.997, loss: 0.008 | Test acc: 0.989, loss: 0.042 | Time: 1.11s
[Epoch 18] Train acc: 0.995, loss: 0.016 | Test acc: 0.989, loss: 0.059 | Time: 1.10s
[Epoch 19] Train acc: 0.995, loss: 0.015 | Test acc: 0.990, loss: 0.053 | Time: 1.10s
[Epoch 20] Train acc: 0.996, loss: 0.011 | Test acc: 0.988, loss: 0.053 | Time: 1.12s
[Epoch 21] Train acc: 0.992, loss: 0.026 | Test acc: 0.984, loss: 0.061 | Time: 1.11s
[Epoch 22] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.051 | Time: 1.11s
[Epoch 23] Train acc: 0.987, loss: 0.066 | Test acc: 0.981, loss: 0.102 | Time: 1.12s
[Epoch 24] Train acc: 0.998, loss: 0.008 | Test acc: 0.990, loss: 0.053 | Time: 1.11s
[Epoch 25] Train acc: 0.997, loss: 0.011 | Test acc: 0.989, loss: 0.054 | Time: 1.11s
[Epoch 26] Train acc: 0.996, loss: 0.011 | Test acc: 0.990, loss: 0.059 | Time: 1.12s
[Epoch 27] Train acc: 0.998, loss: 0.007 | Test acc: 0.990, loss: 0.052 | Time: 1.14s
[Epoch 28] Train acc: 0.996, loss: 0.019 | Test acc: 0.986, loss: 0.072 | Time: 1.12s
[Epoch 29] Train acc: 0.995, loss: 0.016 | Test acc: 0.989, loss: 0.063 | Time: 1.12s
[Epoch 30] Train acc: 0.997, loss: 0.011 | Test acc: 0.991, loss: 0.057 | Time: 1.13s
[Epoch 31] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.040 | Time: 1.15s
[Epoch 32] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.053 | Time: 1.15s
[Epoch 33] Train acc: 0.997, loss: 0.009 | Test acc: 0.989, loss: 0.051 | Time: 1.16s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.041 | Time: 1.15s
[Epoch 35] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.058 | Time: 1.16s
[Epoch 36] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.047 | Time: 1.17s
[Epoch 37] Train acc: 0.996, loss: 0.013 | Test acc: 0.991, loss: 0.065 | Time: 1.18s
[Epoch 38] Train acc: 0.997, loss: 0.007 | Test acc: 0.989, loss: 0.066 | Time: 1.17s
[Epoch 39] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.041 | Time: 1.20s
[Epoch 40] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.049 | Time: 1.18s
Total training time: 71.51s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed9_pretrained.msgpack
################### TRAINING WITH velo ###################
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/Adam.learning_rate = 0.0003
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/build_gradient_estimators.gradient_estimator_fn = @FullESOrPMAP
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/build_gradient_estimators.sample_task_family_fn = @april28_distribution_bigger
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/FullES.loss_type = 'last_recompute'
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/FullES.recompute_samples = 100
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/FullES.sign_delta_loss_scalar = 1.0
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/FullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/gradient_worker_compute.extra_metrics = False
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/GradientAccumulator.num_average = 20
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/GradientAccumulator.opt = @Adam()
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/GradientClipOptimizer.opt = @GradientAccumulator()
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/GradientLearner.init_theta_from_path =     'jul18_continue_on_bigger_2xbs_morestale_9264/params'
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/GradientLearner.meta_init = @HyperV2()
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/GradientLearner.reset_outer_iteration = True
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/GradientLearner.theta_opt = @GradientClipOptimizer()
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/HyperV2.lstm_hidden_size = 512
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/HyperV2.param_inits = 256
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/HyperV2.use_bugged_loss_features = False
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/LogUniformLengthSchedule.max_length = 200000
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/LogUniformLengthSchedule.min_length = 200
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/periodically_save_checkpoint.time_interval = 60
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/PMAPFullES.truncation_schedule = @LogUniformLengthSchedule()
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.lopt = @HyperV2()
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.num_estimators = 8
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.num_steps = 100000
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.outer_learner_fn = @GradientLearner
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.run_num_estimators_per_gradient = 1
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.staleness = 500
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.stochastic_resample_frequency = 200
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.summary_every_n = 25
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/run_train.trainer_batch_size = 512
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/VectorizedLOptTruncatedStep.num_tasks = 8
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/VectorizedLOptTruncatedStep.random_initial_iteration_offset = 0
opt_from_checkpoint__80a39aa0_9cf2_46e6_822b_4ff7156aaaae/VectorizedLOptTruncatedStep.trunc_sched = @NeverEndingTruncationSchedule()

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.983, loss: 0.059 | Test acc: 0.981, loss: 0.064 | Time: 25.44s
[Epoch 2] Train acc: 0.987, loss: 0.043 | Test acc: 0.984, loss: 0.053 | Time: 1.87s
[Epoch 3] Train acc: 0.990, loss: 0.030 | Test acc: 0.985, loss: 0.045 | Time: 1.93s
[Epoch 4] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.039 | Time: 1.92s
[Epoch 5] Train acc: 0.994, loss: 0.019 | Test acc: 0.987, loss: 0.041 | Time: 1.94s
[Epoch 6] Train acc: 0.994, loss: 0.018 | Test acc: 0.987, loss: 0.048 | Time: 1.93s
[Epoch 7] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.049 | Time: 1.93s
[Epoch 8] Train acc: 0.987, loss: 0.041 | Test acc: 0.981, loss: 0.065 | Time: 1.92s
[Epoch 9] Train acc: 0.993, loss: 0.022 | Test acc: 0.986, loss: 0.060 | Time: 1.94s
[Epoch 10] Train acc: 0.993, loss: 0.021 | Test acc: 0.985, loss: 0.059 | Time: 1.93s
[Epoch 11] Train acc: 0.993, loss: 0.020 | Test acc: 0.987, loss: 0.053 | Time: 1.93s
[Epoch 12] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.049 | Time: 1.93s
[Epoch 13] Train acc: 0.996, loss: 0.013 | Test acc: 0.988, loss: 0.045 | Time: 1.93s
[Epoch 14] Train acc: 0.996, loss: 0.011 | Test acc: 0.990, loss: 0.044 | Time: 1.91s
[Epoch 15] Train acc: 0.997, loss: 0.007 | Test acc: 0.990, loss: 0.036 | Time: 1.93s
[Epoch 16] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.049 | Time: 1.93s
[Epoch 17] Train acc: 0.995, loss: 0.015 | Test acc: 0.988, loss: 0.054 | Time: 1.93s
[Epoch 18] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.049 | Time: 1.92s
[Epoch 19] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.049 | Time: 1.93s
[Epoch 20] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.040 | Time: 1.94s
[Epoch 21] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.040 | Time: 1.95s
[Epoch 22] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.047 | Time: 1.95s
[Epoch 23] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.043 | Time: 1.95s
[Epoch 24] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.049 | Time: 1.96s
[Epoch 25] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.047 | Time: 1.94s
[Epoch 26] Train acc: 0.998, loss: 0.004 | Test acc: 0.991, loss: 0.046 | Time: 1.95s
[Epoch 27] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.042 | Time: 1.95s
[Epoch 28] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.045 | Time: 1.97s
[Epoch 29] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.044 | Time: 1.95s
[Epoch 30] Train acc: 0.998, loss: 0.006 | Test acc: 0.991, loss: 0.042 | Time: 1.97s
[Epoch 31] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.049 | Time: 1.97s
[Epoch 32] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.052 | Time: 1.98s
[Epoch 33] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.046 | Time: 2.00s
[Epoch 34] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.045 | Time: 2.00s
[Epoch 35] Train acc: 0.999, loss: 0.002 | Test acc: 0.991, loss: 0.052 | Time: 2.00s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.050 | Time: 2.02s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.993, loss: 0.049 | Time: 2.02s
[Epoch 38] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.048 | Time: 2.13s
[Epoch 39] Train acc: 1.000, loss: 0.000 | Test acc: 0.993, loss: 0.048 | Time: 2.15s
[Epoch 40] Train acc: 1.000, loss: 0.000 | Test acc: 0.994, loss: 0.048 | Time: 2.14s
Total training time: 126.09s
Checkpoint is written to results/checkpoints/mnist/velo_resnet1_mnist_seed10_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgd ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.390, loss: 1.873 | Test acc: 0.387, loss: 1.874 | Time: 2.62s
[Epoch 2] Train acc: 0.551, loss: 1.523 | Test acc: 0.554, loss: 1.522 | Time: 0.95s
[Epoch 3] Train acc: 0.741, loss: 1.062 | Test acc: 0.747, loss: 1.061 | Time: 0.96s
[Epoch 4] Train acc: 0.879, loss: 0.629 | Test acc: 0.882, loss: 0.628 | Time: 0.97s
[Epoch 5] Train acc: 0.928, loss: 0.370 | Test acc: 0.931, loss: 0.365 | Time: 0.96s
[Epoch 6] Train acc: 0.951, loss: 0.243 | Test acc: 0.952, loss: 0.240 | Time: 0.96s
[Epoch 7] Train acc: 0.958, loss: 0.187 | Test acc: 0.959, loss: 0.187 | Time: 0.97s
[Epoch 8] Train acc: 0.946, loss: 0.202 | Test acc: 0.945, loss: 0.203 | Time: 0.96s
[Epoch 9] Train acc: 0.964, loss: 0.141 | Test acc: 0.962, loss: 0.142 | Time: 0.96s
[Epoch 10] Train acc: 0.968, loss: 0.128 | Test acc: 0.964, loss: 0.131 | Time: 0.96s
[Epoch 11] Train acc: 0.967, loss: 0.123 | Test acc: 0.964, loss: 0.128 | Time: 0.96s
[Epoch 12] Train acc: 0.975, loss: 0.100 | Test acc: 0.971, loss: 0.108 | Time: 0.96s
[Epoch 13] Train acc: 0.980, loss: 0.083 | Test acc: 0.975, loss: 0.092 | Time: 0.96s
[Epoch 14] Train acc: 0.978, loss: 0.087 | Test acc: 0.974, loss: 0.098 | Time: 0.96s
[Epoch 15] Train acc: 0.983, loss: 0.069 | Test acc: 0.979, loss: 0.079 | Time: 0.96s
[Epoch 16] Train acc: 0.983, loss: 0.068 | Test acc: 0.978, loss: 0.079 | Time: 0.96s
[Epoch 17] Train acc: 0.983, loss: 0.067 | Test acc: 0.979, loss: 0.078 | Time: 0.97s
[Epoch 18] Train acc: 0.975, loss: 0.086 | Test acc: 0.971, loss: 0.099 | Time: 0.97s
[Epoch 19] Train acc: 0.983, loss: 0.061 | Test acc: 0.980, loss: 0.071 | Time: 0.96s
[Epoch 20] Train acc: 0.985, loss: 0.057 | Test acc: 0.982, loss: 0.066 | Time: 0.97s
[Epoch 21] Train acc: 0.987, loss: 0.050 | Test acc: 0.984, loss: 0.060 | Time: 0.97s
[Epoch 22] Train acc: 0.989, loss: 0.044 | Test acc: 0.983, loss: 0.056 | Time: 0.98s
[Epoch 23] Train acc: 0.988, loss: 0.045 | Test acc: 0.984, loss: 0.057 | Time: 0.97s
[Epoch 24] Train acc: 0.990, loss: 0.039 | Test acc: 0.987, loss: 0.052 | Time: 0.97s
[Epoch 25] Train acc: 0.990, loss: 0.040 | Test acc: 0.984, loss: 0.055 | Time: 0.98s
[Epoch 26] Train acc: 0.989, loss: 0.041 | Test acc: 0.984, loss: 0.057 | Time: 0.98s
[Epoch 27] Train acc: 0.988, loss: 0.045 | Test acc: 0.983, loss: 0.061 | Time: 0.97s
[Epoch 28] Train acc: 0.990, loss: 0.036 | Test acc: 0.984, loss: 0.051 | Time: 0.97s
[Epoch 29] Train acc: 0.980, loss: 0.063 | Test acc: 0.975, loss: 0.078 | Time: 0.96s
[Epoch 30] Train acc: 0.992, loss: 0.033 | Test acc: 0.985, loss: 0.049 | Time: 0.98s
[Epoch 31] Train acc: 0.990, loss: 0.036 | Test acc: 0.984, loss: 0.054 | Time: 0.98s
[Epoch 32] Train acc: 0.988, loss: 0.042 | Test acc: 0.982, loss: 0.060 | Time: 0.98s
[Epoch 33] Train acc: 0.976, loss: 0.075 | Test acc: 0.970, loss: 0.098 | Time: 0.98s
[Epoch 34] Train acc: 0.994, loss: 0.026 | Test acc: 0.987, loss: 0.043 | Time: 1.00s
[Epoch 35] Train acc: 0.995, loss: 0.023 | Test acc: 0.987, loss: 0.041 | Time: 1.00s
[Epoch 36] Train acc: 0.993, loss: 0.027 | Test acc: 0.987, loss: 0.043 | Time: 0.99s
[Epoch 37] Train acc: 0.996, loss: 0.021 | Test acc: 0.987, loss: 0.040 | Time: 1.01s
[Epoch 38] Train acc: 0.994, loss: 0.025 | Test acc: 0.987, loss: 0.044 | Time: 1.01s
[Epoch 39] Train acc: 0.995, loss: 0.022 | Test acc: 0.986, loss: 0.044 | Time: 1.03s
[Epoch 40] Train acc: 0.986, loss: 0.043 | Test acc: 0.981, loss: 0.067 | Time: 1.04s
Total training time: 64.30s
Checkpoint is written to results/checkpoints/mnist/sgd_resnet1_mnist_seed10_pretrained.msgpack
###################################################################################################

################### TRAINING WITH sgdm ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.942, loss: 0.209 | Test acc: 0.939, loss: 0.214 | Time: 2.64s
[Epoch 2] Train acc: 0.965, loss: 0.115 | Test acc: 0.965, loss: 0.114 | Time: 1.03s
[Epoch 3] Train acc: 0.966, loss: 0.107 | Test acc: 0.965, loss: 0.107 | Time: 1.06s
[Epoch 4] Train acc: 0.973, loss: 0.086 | Test acc: 0.968, loss: 0.097 | Time: 1.06s
[Epoch 5] Train acc: 0.983, loss: 0.057 | Test acc: 0.980, loss: 0.068 | Time: 1.05s
[Epoch 6] Train acc: 0.982, loss: 0.056 | Test acc: 0.975, loss: 0.075 | Time: 1.05s
[Epoch 7] Train acc: 0.984, loss: 0.048 | Test acc: 0.980, loss: 0.064 | Time: 1.06s
[Epoch 8] Train acc: 0.991, loss: 0.031 | Test acc: 0.983, loss: 0.050 | Time: 1.06s
[Epoch 9] Train acc: 0.985, loss: 0.045 | Test acc: 0.976, loss: 0.071 | Time: 1.06s
[Epoch 10] Train acc: 0.991, loss: 0.027 | Test acc: 0.984, loss: 0.048 | Time: 1.09s
[Epoch 11] Train acc: 0.985, loss: 0.043 | Test acc: 0.977, loss: 0.075 | Time: 1.06s
[Epoch 12] Train acc: 0.992, loss: 0.024 | Test acc: 0.983, loss: 0.050 | Time: 1.07s
[Epoch 13] Train acc: 0.988, loss: 0.036 | Test acc: 0.979, loss: 0.071 | Time: 1.07s
[Epoch 14] Train acc: 0.995, loss: 0.016 | Test acc: 0.985, loss: 0.042 | Time: 1.06s
[Epoch 15] Train acc: 0.995, loss: 0.015 | Test acc: 0.986, loss: 0.048 | Time: 1.31s
[Epoch 16] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.036 | Time: 1.12s
[Epoch 17] Train acc: 0.998, loss: 0.008 | Test acc: 0.989, loss: 0.036 | Time: 1.11s
[Epoch 18] Train acc: 0.999, loss: 0.006 | Test acc: 0.990, loss: 0.034 | Time: 1.07s
[Epoch 19] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.033 | Time: 1.08s
[Epoch 20] Train acc: 0.998, loss: 0.005 | Test acc: 0.989, loss: 0.035 | Time: 1.30s
[Epoch 21] Train acc: 0.998, loss: 0.007 | Test acc: 0.989, loss: 0.035 | Time: 1.08s
[Epoch 22] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.035 | Time: 1.12s
[Epoch 23] Train acc: 0.999, loss: 0.005 | Test acc: 0.989, loss: 0.034 | Time: 1.07s
[Epoch 24] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.033 | Time: 1.06s
[Epoch 25] Train acc: 1.000, loss: 0.003 | Test acc: 0.991, loss: 0.032 | Time: 1.06s
[Epoch 26] Train acc: 0.999, loss: 0.003 | Test acc: 0.990, loss: 0.037 | Time: 1.09s
[Epoch 27] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.032 | Time: 1.12s
[Epoch 28] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.033 | Time: 1.18s
[Epoch 29] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.033 | Time: 1.16s
[Epoch 30] Train acc: 1.000, loss: 0.002 | Test acc: 0.991, loss: 0.032 | Time: 1.12s
[Epoch 31] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.033 | Time: 1.08s
[Epoch 32] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.031 | Time: 1.09s
[Epoch 33] Train acc: 1.000, loss: 0.001 | Test acc: 0.990, loss: 0.034 | Time: 1.09s
[Epoch 34] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.031 | Time: 1.09s
[Epoch 35] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.034 | Time: 1.08s
[Epoch 36] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.031 | Time: 1.09s
[Epoch 37] Train acc: 1.000, loss: 0.001 | Test acc: 0.991, loss: 0.034 | Time: 1.09s
[Epoch 38] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.031 | Time: 1.10s
[Epoch 39] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.034 | Time: 1.11s
[Epoch 40] Train acc: 1.000, loss: 0.001 | Test acc: 0.992, loss: 0.031 | Time: 1.08s
Total training time: 72.00s
Checkpoint is written to results/checkpoints/mnist/sgdm_resnet1_mnist_seed10_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adam ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.962, loss: 0.115 | Test acc: 0.960, loss: 0.122 | Time: 3.04s
[Epoch 2] Train acc: 0.988, loss: 0.040 | Test acc: 0.984, loss: 0.050 | Time: 1.07s
[Epoch 3] Train acc: 0.987, loss: 0.043 | Test acc: 0.983, loss: 0.055 | Time: 1.07s
[Epoch 4] Train acc: 0.985, loss: 0.046 | Test acc: 0.981, loss: 0.058 | Time: 1.09s
[Epoch 5] Train acc: 0.991, loss: 0.026 | Test acc: 0.985, loss: 0.043 | Time: 1.08s
[Epoch 6] Train acc: 0.981, loss: 0.064 | Test acc: 0.977, loss: 0.085 | Time: 1.13s
[Epoch 7] Train acc: 0.991, loss: 0.027 | Test acc: 0.987, loss: 0.045 | Time: 1.10s
[Epoch 8] Train acc: 0.988, loss: 0.040 | Test acc: 0.981, loss: 0.073 | Time: 1.09s
[Epoch 9] Train acc: 0.990, loss: 0.031 | Test acc: 0.983, loss: 0.059 | Time: 1.10s
[Epoch 10] Train acc: 0.987, loss: 0.042 | Test acc: 0.981, loss: 0.083 | Time: 1.10s
[Epoch 11] Train acc: 0.983, loss: 0.064 | Test acc: 0.979, loss: 0.100 | Time: 1.10s
[Epoch 12] Train acc: 0.986, loss: 0.049 | Test acc: 0.978, loss: 0.092 | Time: 1.09s
[Epoch 13] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.044 | Time: 1.08s
[Epoch 14] Train acc: 0.995, loss: 0.016 | Test acc: 0.987, loss: 0.051 | Time: 1.10s
[Epoch 15] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.034 | Time: 1.10s
[Epoch 16] Train acc: 0.994, loss: 0.018 | Test acc: 0.989, loss: 0.050 | Time: 1.10s
[Epoch 17] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.036 | Time: 1.22s
[Epoch 18] Train acc: 0.997, loss: 0.010 | Test acc: 0.992, loss: 0.045 | Time: 1.13s
[Epoch 19] Train acc: 0.997, loss: 0.009 | Test acc: 0.990, loss: 0.045 | Time: 1.15s
[Epoch 20] Train acc: 0.996, loss: 0.014 | Test acc: 0.990, loss: 0.044 | Time: 1.15s
[Epoch 21] Train acc: 0.996, loss: 0.011 | Test acc: 0.988, loss: 0.052 | Time: 1.14s
[Epoch 22] Train acc: 0.994, loss: 0.019 | Test acc: 0.986, loss: 0.062 | Time: 1.15s
[Epoch 23] Train acc: 0.998, loss: 0.007 | Test acc: 0.988, loss: 0.053 | Time: 1.15s
[Epoch 24] Train acc: 0.994, loss: 0.018 | Test acc: 0.988, loss: 0.058 | Time: 1.38s
[Epoch 25] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.062 | Time: 1.23s
[Epoch 26] Train acc: 0.997, loss: 0.008 | Test acc: 0.990, loss: 0.046 | Time: 1.17s
[Epoch 27] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.040 | Time: 1.16s
[Epoch 28] Train acc: 0.997, loss: 0.010 | Test acc: 0.990, loss: 0.056 | Time: 1.17s
[Epoch 29] Train acc: 0.997, loss: 0.010 | Test acc: 0.988, loss: 0.058 | Time: 1.16s
[Epoch 30] Train acc: 0.997, loss: 0.009 | Test acc: 0.988, loss: 0.054 | Time: 1.17s
[Epoch 31] Train acc: 0.998, loss: 0.009 | Test acc: 0.991, loss: 0.058 | Time: 1.16s
[Epoch 32] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.043 | Time: 1.17s
[Epoch 33] Train acc: 0.998, loss: 0.005 | Test acc: 0.990, loss: 0.047 | Time: 1.17s
[Epoch 34] Train acc: 0.999, loss: 0.003 | Test acc: 0.993, loss: 0.040 | Time: 1.17s
[Epoch 35] Train acc: 0.999, loss: 0.003 | Test acc: 0.991, loss: 0.039 | Time: 1.18s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.039 | Time: 1.18s
[Epoch 37] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.066 | Time: 1.20s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.992, loss: 0.035 | Time: 1.18s
[Epoch 39] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.039 | Time: 1.21s
[Epoch 40] Train acc: 0.999, loss: 0.002 | Test acc: 0.992, loss: 0.040 | Time: 1.18s
Total training time: 73.17s
Checkpoint is written to results/checkpoints/mnist/adam_resnet1_mnist_seed10_pretrained.msgpack
###################################################################################################

################### TRAINING WITH adamw ###################

number of parameters for resnet1: 77898

Training 33720 steps over 40 epochs
[Epoch 1] Train acc: 0.971, loss: 0.093 | Test acc: 0.966, loss: 0.102 | Time: 3.16s
[Epoch 2] Train acc: 0.986, loss: 0.045 | Test acc: 0.984, loss: 0.051 | Time: 1.09s
[Epoch 3] Train acc: 0.990, loss: 0.033 | Test acc: 0.988, loss: 0.042 | Time: 1.10s
[Epoch 4] Train acc: 0.985, loss: 0.047 | Test acc: 0.980, loss: 0.059 | Time: 1.10s
[Epoch 5] Train acc: 0.984, loss: 0.049 | Test acc: 0.980, loss: 0.067 | Time: 1.11s
[Epoch 6] Train acc: 0.985, loss: 0.048 | Test acc: 0.980, loss: 0.065 | Time: 1.10s
[Epoch 7] Train acc: 0.983, loss: 0.051 | Test acc: 0.974, loss: 0.086 | Time: 1.11s
[Epoch 8] Train acc: 0.993, loss: 0.021 | Test acc: 0.988, loss: 0.042 | Time: 1.11s
[Epoch 9] Train acc: 0.993, loss: 0.023 | Test acc: 0.988, loss: 0.050 | Time: 1.11s
[Epoch 10] Train acc: 0.986, loss: 0.044 | Test acc: 0.981, loss: 0.077 | Time: 1.11s
[Epoch 11] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.046 | Time: 1.11s
[Epoch 12] Train acc: 0.995, loss: 0.017 | Test acc: 0.988, loss: 0.042 | Time: 1.11s
[Epoch 13] Train acc: 0.996, loss: 0.012 | Test acc: 0.989, loss: 0.041 | Time: 1.11s
[Epoch 14] Train acc: 0.994, loss: 0.019 | Test acc: 0.988, loss: 0.052 | Time: 1.10s
[Epoch 15] Train acc: 0.996, loss: 0.012 | Test acc: 0.990, loss: 0.041 | Time: 1.11s
[Epoch 16] Train acc: 0.996, loss: 0.011 | Test acc: 0.990, loss: 0.047 | Time: 1.12s
[Epoch 17] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.032 | Time: 1.11s
[Epoch 18] Train acc: 0.992, loss: 0.025 | Test acc: 0.986, loss: 0.057 | Time: 1.11s
[Epoch 19] Train acc: 0.995, loss: 0.015 | Test acc: 0.990, loss: 0.051 | Time: 1.10s
[Epoch 20] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.043 | Time: 1.12s
[Epoch 21] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.039 | Time: 1.12s
[Epoch 22] Train acc: 0.998, loss: 0.005 | Test acc: 0.992, loss: 0.030 | Time: 1.12s
[Epoch 23] Train acc: 0.996, loss: 0.013 | Test acc: 0.989, loss: 0.047 | Time: 1.16s
[Epoch 24] Train acc: 0.995, loss: 0.015 | Test acc: 0.990, loss: 0.046 | Time: 1.12s
[Epoch 25] Train acc: 0.997, loss: 0.009 | Test acc: 0.991, loss: 0.048 | Time: 1.11s
[Epoch 26] Train acc: 0.998, loss: 0.007 | Test acc: 0.991, loss: 0.046 | Time: 1.15s
[Epoch 27] Train acc: 0.995, loss: 0.018 | Test acc: 0.989, loss: 0.057 | Time: 1.13s
[Epoch 28] Train acc: 0.999, loss: 0.003 | Test acc: 0.992, loss: 0.029 | Time: 1.16s
[Epoch 29] Train acc: 0.993, loss: 0.031 | Test acc: 0.986, loss: 0.080 | Time: 1.13s
[Epoch 30] Train acc: 0.998, loss: 0.006 | Test acc: 0.990, loss: 0.043 | Time: 1.16s
[Epoch 31] Train acc: 0.999, loss: 0.004 | Test acc: 0.991, loss: 0.040 | Time: 1.18s
[Epoch 32] Train acc: 0.998, loss: 0.005 | Test acc: 0.991, loss: 0.048 | Time: 1.17s
[Epoch 33] Train acc: 0.996, loss: 0.014 | Test acc: 0.987, loss: 0.061 | Time: 1.19s
[Epoch 34] Train acc: 1.000, loss: 0.002 | Test acc: 0.994, loss: 0.029 | Time: 1.21s
[Epoch 35] Train acc: 0.995, loss: 0.020 | Test acc: 0.988, loss: 0.062 | Time: 1.22s
[Epoch 36] Train acc: 0.999, loss: 0.002 | Test acc: 0.993, loss: 0.031 | Time: 1.21s
[Epoch 37] Train acc: 0.996, loss: 0.015 | Test acc: 0.990, loss: 0.052 | Time: 1.22s
[Epoch 38] Train acc: 0.999, loss: 0.004 | Test acc: 0.990, loss: 0.041 | Time: 1.23s
[Epoch 39] Train acc: 0.996, loss: 0.011 | Test acc: 0.989, loss: 0.051 | Time: 1.23s
[Epoch 40] Train acc: 0.997, loss: 0.010 | Test acc: 0.989, loss: 0.055 | Time: 1.19s
Total training time: 71.21s
Checkpoint is written to results/checkpoints/mnist/adamw_resnet1_mnist_seed10_pretrained.msgpack
